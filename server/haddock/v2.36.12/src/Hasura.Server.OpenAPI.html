<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- This prevents hlint errors on the &quot;pattern&quot; lens.</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NoPatternSynonyms #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html"><span class="hs-identifier">Hasura.Server.OpenAPI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.OpenAPI.html#buildOpenAPI"><span class="hs-identifier">buildOpenAPI</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.html/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Monad.Circular.html"><span class="hs-identifier">Control.Monad.Circular</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.html/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">J</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Strict.html/Data.HashMap.Strict.html"><span class="hs-identifier">Data.HashMap.Strict</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HashMap</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.HashMap.Strict.InsOrd.Extended.html/Data.HashMap.Strict.InsOrd.Extended.html"><span class="hs-identifier">Data.HashMap.Strict.InsOrd.Extended</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">InsOrdHashMap</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.HashMap.Strict.Multi.html/Data.HashMap.Strict.Multi.html"><span class="hs-identifier">Data.HashMap.Strict.Multi</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MMap</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Any</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.html/Data.OpenApi.html"><span class="hs-identifier">Data.OpenApi</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Declare.html/Data.OpenApi.Declare.html"><span class="hs-identifier">Data.OpenApi.Declare</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.NonEmpty.html/Data.Text.NonEmpty.html"><span class="hs-identifier">Data.Text.NonEmpty</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Trie.html/Data.Trie.html"><span class="hs-identifier">Data.Trie</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Trie</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Instances.html/Hasura.Base.Instances.html"><span class="hs-identifier">Hasura.Base.Instances</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html"><span class="hs-identifier">Hasura.GraphQL.Analyse</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html"><span class="hs-identifier">Hasura.GraphQL.Transport.HTTP.Protocol</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html/Hasura.Prelude.html"><span class="hs-identifier">Hasura.Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">put</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html"><span class="hs-identifier">Hasura.RQL.Types.Endpoint</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.QueryCollection.html"><span class="hs-identifier">Hasura.RQL.Types.QueryCollection</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html"><span class="hs-identifier">Hasura.RQL.Types.SchemaCache</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Table.Cache.html#FieldInfo"><span class="hs-identifier">FieldInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html"><span class="hs-identifier">Language.GraphQL.Draft.Syntax</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/http-media-0.8.1.1-3a03975090f09e0666dc26143010e7352a93c76073df688d8d989f5bf00377bb/share/doc/html/src/Network.HTTP.Media.MediaType.html/Network.HTTP.Media.MediaType.html"><span class="hs-identifier">Network.HTTP.Media.MediaType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/http-media-0.8.1.1-3a03975090f09e0666dc26143010e7352a93c76073df688d8d989f5bf00377bb/share/doc/html/src/Network.HTTP.Media.MediaType.html/Network.HTTP.Media.MediaType.html#%2F%2F"><span class="hs-operator">(//)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- API</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span id="local-6989586621687854106"><span class="annot"><a href="Hasura.Server.OpenAPI.html#buildOpenAPI"><span class="hs-identifier hs-type">buildOpenAPI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854106"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFix</span></span><span> </span><span class="annot"><a href="#local-6989586621687854106"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#SchemaCache"><span class="hs-identifier hs-type">SchemaCache</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621687854106"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#OpenApi"><span class="hs-identifier hs-type">OpenApi</span></a></span></span><span>
</span><span id="line-34"></span><span id="buildOpenAPI"><span class="annot"><span class="annottext">buildOpenAPI :: forall (m :: * -&gt; *).
(MonadError QErr m, MonadFix m) =&gt;
SchemaCache -&gt; m OpenApi
</span><a href="Hasura.Server.OpenAPI.html#buildOpenAPI"><span class="hs-identifier hs-var hs-var">buildOpenAPI</span></a></span></span><span> </span><span id="local-6989586621687854597"><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621687854597"><span class="hs-identifier hs-var">schemaCache</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621687854598"><span class="annot"><a href="#local-6989586621687854598"><span class="hs-identifier hs-var">defs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687854599"><span class="annot"><a href="#local-6989586621687854599"><span class="hs-identifier hs-var">spec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DeclareT (Definitions Schema) m OpenApi
 -&gt; Definitions Schema -&gt; m (Definitions Schema, OpenApi))
-&gt; Definitions Schema
-&gt; DeclareT (Definitions Schema) m OpenApi
-&gt; m (Definitions Schema, OpenApi)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">DeclareT (Definitions Schema) m OpenApi
-&gt; Definitions Schema -&gt; m (Definitions Schema, OpenApi)
forall d (m :: * -&gt; *) a. DeclareT d m a -&gt; d -&gt; m (d, a)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Declare.html/Data.OpenApi.Declare.html#runDeclareT"><span class="hs-identifier hs-var">runDeclareT</span></a></span><span> </span><span class="annot"><span class="annottext">Definitions Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-36"></span><span>    </span><span id="local-6989586621687854602"><span class="annot"><a href="#local-6989586621687854602"><span class="hs-identifier hs-var">endpoints</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SchemaCache
-&gt; SchemaIntrospection
-&gt; DeclareM m (InsOrdHashMap String (PathItem, Text))
forall (m :: * -&gt; *).
(MonadError QErr m, MonadFix m) =&gt;
SchemaCache
-&gt; SchemaIntrospection
-&gt; DeclareM m (InsOrdHashMap String (PathItem, Text))
</span><a href="Hasura.Server.OpenAPI.html#buildAllEndpoints"><span class="hs-identifier hs-var">buildAllEndpoints</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621687854597"><span class="hs-identifier hs-var">schemaCache</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SchemaCache -&gt; SchemaIntrospection
</span><a href="Hasura.RQL.Types.SchemaCache.html#scAdminIntrospection"><span class="hs-identifier hs-var">scAdminIntrospection</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621687854597"><span class="hs-identifier hs-var">schemaCache</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-38"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span>
</span><span id="line-39"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#paths"><span class="hs-identifier hs-type">paths</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-type">.~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fst</span></span><span> </span><span class="annot"><a href="#local-6989586621687854602"><span class="hs-identifier hs-type">endpoints</span></a></span><span>
</span><span id="line-40"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#info"><span class="hs-identifier hs-type">info</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#title"><span class="hs-identifier hs-type">title</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-type">.~</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Rest Endpoints&quot;</span></span><span>
</span><span id="line-41"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#info"><span class="hs-identifier hs-type">info</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#description"><span class="hs-identifier hs-type">description</span></a></span><span>
</span><span id="line-42"></span><span>        </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-type">?~</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;This OpenAPI specification is automatically generated by Hasura.&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">foldMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">snd</span></span><span> </span><span class="annot"><a href="#local-6989586621687854602"><span class="hs-identifier hs-type">endpoints</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621687854599"><span class="hs-identifier hs-type">spec</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#components"><span class="hs-identifier hs-type">components</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#schemas"><span class="hs-identifier hs-type">schemas</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-type">.~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854598"><span class="hs-identifier hs-type">defs</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- Endpoint</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span id="local-6989586621687854143"><span class="annot"><a href="Hasura.Server.OpenAPI.html#buildAllEndpoints"><span class="hs-identifier hs-type">buildAllEndpoints</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854143"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFix</span></span><span> </span><span class="annot"><a href="#local-6989586621687854143"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#SchemaCache"><span class="hs-identifier hs-type">SchemaCache</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#SchemaIntrospection"><span class="hs-identifier hs-type">G.SchemaIntrospection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#DeclareM"><span class="hs-identifier hs-type">DeclareM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854143"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/insert-ordered-containers-0.2.5.3-dcb71999c8104475fd299533bb40a6c15ee8a9411f3a03b68aa99a14a4143c19/share/doc/html/src/Data.HashMap.Strict.InsOrd.html/Data.HashMap.Strict.InsOrd.html#InsOrdHashMap"><span class="hs-identifier hs-type">InsOrdHashMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#PathItem"><span class="hs-identifier hs-type">PathItem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-53"></span><span id="buildAllEndpoints"><span class="annot"><span class="annottext">buildAllEndpoints :: forall (m :: * -&gt; *).
(MonadError QErr m, MonadFix m) =&gt;
SchemaCache
-&gt; SchemaIntrospection
-&gt; DeclareM m (InsOrdHashMap String (PathItem, Text))
</span><a href="Hasura.Server.OpenAPI.html#buildAllEndpoints"><span class="hs-identifier hs-var hs-var">buildAllEndpoints</span></a></span></span><span> </span><span id="local-6989586621687854651"><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621687854651"><span class="hs-identifier hs-var">schemaCache</span></a></span></span><span> </span><span id="local-6989586621687854652"><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621687854652"><span class="hs-identifier hs-var">schemaTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><span class="annottext">(InsOrdHashMap String (PathItem, Text)
 -&gt; InsOrdHashMap String (PathItem, Text)
 -&gt; InsOrdHashMap String (PathItem, Text))
-&gt; InsOrdHashMap String (PathItem, Text)
-&gt; [InsOrdHashMap String (PathItem, Text)]
-&gt; InsOrdHashMap String (PathItem, Text)
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((PathItem, Text) -&gt; (PathItem, Text) -&gt; (PathItem, Text))
-&gt; InsOrdHashMap String (PathItem, Text)
-&gt; InsOrdHashMap String (PathItem, Text)
-&gt; InsOrdHashMap String (PathItem, Text)
forall k v.
(Eq k, Hashable k) =&gt;
(v -&gt; v -&gt; v)
-&gt; InsOrdHashMap k v -&gt; InsOrdHashMap k v -&gt; InsOrdHashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/insert-ordered-containers-0.2.5.3-dcb71999c8104475fd299533bb40a6c15ee8a9411f3a03b68aa99a14a4143c19/share/doc/html/src/Data.HashMap.Strict.InsOrd.html/Data.HashMap.Strict.InsOrd.html#unionWith"><span class="hs-identifier hs-var">InsOrdHashMap.unionWith</span></a></span><span> </span><span class="annot"><span class="annottext">(PathItem, Text) -&gt; (PathItem, Text) -&gt; (PathItem, Text)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap String (PathItem, Text)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">([InsOrdHashMap String (PathItem, Text)]
 -&gt; InsOrdHashMap String (PathItem, Text))
-&gt; DeclareT
     (Definitions Schema) m [InsOrdHashMap String (PathItem, Text)]
-&gt; DeclareT
     (Definitions Schema) m (InsOrdHashMap String (PathItem, Text))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[DeclareT
   (Definitions Schema) m (InsOrdHashMap String (PathItem, Text))]
-&gt; DeclareT
     (Definitions Schema) m [InsOrdHashMap String (PathItem, Text)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-comment">-- for each path in the trie of endpoints</span><span>
</span><span id="line-56"></span><span>    </span><span id="local-6989586621687854657"><span class="annot"><a href="#local-6989586621687854657"><span class="hs-identifier hs-var">endpointMap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Trie
  (PathComponent Text)
  (MultiMap EndpointMethod (EndpointMetadata GQLQueryWithText))
-&gt; [MultiMap EndpointMethod (EndpointMetadata GQLQueryWithText)]
forall k v. Trie k v -&gt; [v]
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Trie.html/Data.Trie.html#elems"><span class="hs-identifier hs-var">Trie.elems</span></a></span><span> </span><span class="annot"><span class="annottext">(Trie
   (PathComponent Text)
   (MultiMap EndpointMethod (EndpointMetadata GQLQueryWithText))
 -&gt; [MultiMap EndpointMethod (EndpointMetadata GQLQueryWithText)])
-&gt; Trie
     (PathComponent Text)
     (MultiMap EndpointMethod (EndpointMetadata GQLQueryWithText))
-&gt; [MultiMap EndpointMethod (EndpointMetadata GQLQueryWithText)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SchemaCache
-&gt; Trie
     (PathComponent Text)
     (MultiMap EndpointMethod (EndpointMetadata GQLQueryWithText))
</span><a href="Hasura.RQL.Types.SchemaCache.html#scEndpoints"><span class="hs-identifier hs-var">scEndpoints</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621687854651"><span class="hs-identifier hs-var">schemaCache</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-comment">-- for each method at that path</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621687854660"><span class="annot"><a href="#local-6989586621687854660"><span class="hs-identifier hs-var">method</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687854661"><span class="annot"><a href="#local-6989586621687854661"><span class="hs-identifier hs-var">metadataList</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.HashMap.Strict.Multi.html/Data.HashMap.Strict.Multi.html#toList"><span class="hs-identifier hs-type">MMap.toList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854657"><span class="hs-identifier hs-type">endpointMap</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-comment">-- for each metadata associated with that method</span><span>
</span><span id="line-60"></span><span>    </span><span id="local-6989586621687854663"><span class="annot"><a href="#local-6989586621687854663"><span class="hs-identifier hs-var">metadata</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621687854661"><span class="hs-identifier hs-type">metadataList</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-comment">-- build the corresponding path item and list of messages</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#buildEndpoint"><span class="hs-identifier hs-type">buildEndpoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854652"><span class="hs-identifier hs-type">schemaTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854660"><span class="hs-identifier hs-type">method</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854663"><span class="hs-identifier hs-type">metadata</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span id="local-6989586621687854217"><span class="annot"><a href="Hasura.Server.OpenAPI.html#buildEndpoint"><span class="hs-identifier hs-type">buildEndpoint</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854217"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFix</span></span><span> </span><span class="annot"><a href="#local-6989586621687854217"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#SchemaIntrospection"><span class="hs-identifier hs-type">G.SchemaIntrospection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointMethod"><span class="hs-identifier hs-type">EndpointMethod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointMetadata"><span class="hs-identifier hs-type">EndpointMetadata</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.QueryCollection.html#GQLQueryWithText"><span class="hs-identifier hs-type">GQLQueryWithText</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#DeclareM"><span class="hs-identifier hs-type">DeclareM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854217"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/insert-ordered-containers-0.2.5.3-dcb71999c8104475fd299533bb40a6c15ee8a9411f3a03b68aa99a14a4143c19/share/doc/html/src/Data.HashMap.Strict.InsOrd.html/Data.HashMap.Strict.InsOrd.html#InsOrdHashMap"><span class="hs-identifier hs-type">InsOrdHashMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#PathItem"><span class="hs-identifier hs-type">PathItem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-70"></span><span id="buildEndpoint"><span class="annot"><span class="annottext">buildEndpoint :: forall (m :: * -&gt; *).
(MonadError QErr m, MonadFix m) =&gt;
SchemaIntrospection
-&gt; EndpointMethod
-&gt; EndpointMetadata GQLQueryWithText
-&gt; DeclareM m (InsOrdHashMap String (PathItem, Text))
</span><a href="Hasura.Server.OpenAPI.html#buildEndpoint"><span class="hs-identifier hs-var hs-var">buildEndpoint</span></a></span></span><span> </span><span id="local-6989586621687854749"><span class="annot"><span class="annottext">SchemaIntrospection
</span><a href="#local-6989586621687854749"><span class="hs-identifier hs-var">schemaTypes</span></a></span></span><span> </span><span id="local-6989586621687854750"><span class="annot"><span class="annottext">EndpointMethod
</span><a href="#local-6989586621687854750"><span class="hs-identifier hs-var">method</span></a></span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointMetadata"><span class="hs-identifier hs-type">EndpointMetadata</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687854752"><span id="local-6989586621687854753"><span id="local-6989586621687854754"><span id="local-6989586621687854755"><span id="local-6989586621687854756"><span class="annot"><span class="annottext">Maybe Text
NonEmpty EndpointMethod
EndpointUrl
EndpointName
EndpointDef GQLQueryWithText
_ceName :: EndpointName
_ceUrl :: EndpointUrl
_ceMethods :: NonEmpty EndpointMethod
_ceDefinition :: EndpointDef GQLQueryWithText
_ceComment :: Maybe Text
_ceComment :: forall query. EndpointMetadata query -&gt; Maybe Text
_ceDefinition :: forall query. EndpointMetadata query -&gt; EndpointDef query
_ceMethods :: forall query. EndpointMetadata query -&gt; NonEmpty EndpointMethod
_ceUrl :: forall query. EndpointMetadata query -&gt; EndpointUrl
_ceName :: forall query. EndpointMetadata query -&gt; EndpointName
</span><a href="#local-6989586621687854752"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- extracting endpoint info</span><span>
</span><span id="line-72"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.QueryCollection.html#GQLQueryWithText"><span class="hs-identifier hs-type">GQLQueryWithText</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687854763"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687854763"><span class="hs-identifier hs-var hs-var">queryText</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.QueryCollection.html#GQLQuery"><span class="hs-identifier hs-type">GQLQuery</span></a></span><span> </span><span id="local-6989586621687854765"><span class="annot"><span class="annottext">ExecutableDocument Name
</span><a href="#local-6989586621687854765"><span class="hs-identifier hs-var hs-var">queryDocument</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EndpointDef GQLQueryWithText -&gt; GQLQueryWithText
forall query. EndpointDef query -&gt; query
</span><a href="Hasura.RQL.Types.Endpoint.html#_edQuery"><span class="hs-identifier hs-var">_edQuery</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointDef GQLQueryWithText
</span><a href="#local-6989586621687854755"><span class="hs-identifier hs-var">_ceDefinition</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span id="local-6989586621687854767"><span class="annot"><a href="#local-6989586621687854767"><span class="hs-identifier hs-var">singleOperation</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m SingleOperation
-&gt; DeclareT (Definitions Schema) m SingleOperation
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; DeclareT (Definitions Schema) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m SingleOperation
 -&gt; DeclareT (Definitions Schema) m SingleOperation)
-&gt; m SingleOperation
-&gt; DeclareT (Definitions Schema) m SingleOperation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GQLReqParsed -&gt; m SingleOperation
forall (m :: * -&gt; *).
MonadError QErr m =&gt;
GQLReqParsed -&gt; m SingleOperation
</span><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#getSingleOperation"><span class="hs-identifier hs-var">getSingleOperation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe OperationName
-&gt; GQLExecDoc -&gt; Maybe (HashMap Name Value) -&gt; GQLReqParsed
forall a.
Maybe OperationName -&gt; a -&gt; Maybe (HashMap Name Value) -&gt; GQLReq a
</span><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLReq"><span class="hs-identifier hs-var">GQLReq</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OperationName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ExecutableDefinition Name] -&gt; GQLExecDoc
</span><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLExecDoc"><span class="hs-identifier hs-var">GQLExecDoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExecutableDocument Name -&gt; [ExecutableDefinition Name]
forall var. ExecutableDocument var -&gt; [ExecutableDefinition var]
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#getExecutableDefinitions"><span class="hs-identifier hs-var">G.getExecutableDefinitions</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutableDocument Name
</span><a href="#local-6989586621687854765"><span class="hs-identifier hs-var">queryDocument</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (HashMap Name Value)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621687854775"><span class="annot"><a href="#local-6989586621687854775"><span class="hs-identifier hs-var">analysis</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687854776"><span class="annot"><a href="#local-6989586621687854776"><span class="hs-identifier hs-var">messages</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#analyzeGraphQLQuery"><span class="hs-identifier hs-type">analyzeGraphQLQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854749"><span class="hs-identifier hs-type">schemaTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854767"><span class="hs-identifier hs-type">singleOperation</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>      </span><span class="hs-comment">-- extracting endpoint url and name</span><span>
</span><span id="line-77"></span><span>      </span><span id="local-6989586621687854778"><span class="annot"><a href="#local-6989586621687854778"><span class="hs-identifier hs-var hs-var">pathComponents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (Text -&gt; Text) -&gt; EndpointUrl -&gt; [Text]
forall a. (Text -&gt; a) -&gt; (Text -&gt; a) -&gt; EndpointUrl -&gt; [a]
</span><a href="Hasura.RQL.Types.Endpoint.html#splitPath"><span class="hs-identifier hs-var">splitPath</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="#local-6989586621687854780"><span class="hs-identifier hs-var">formatVariable</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">EndpointUrl
</span><a href="#local-6989586621687854753"><span class="hs-identifier hs-var">_ceUrl</span></a></span><span>
</span><span id="line-78"></span><span>      </span><span class="hs-comment">-- TODO: why are we doing this? we are dropping references to variables IIUC?</span><span>
</span><span id="line-79"></span><span>      </span><span id="local-6989586621687854780"><span class="annot"><a href="#local-6989586621687854780"><span class="hs-identifier hs-var hs-var">formatVariable</span></a></span></span><span> </span><span id="local-6989586621687854786"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687854786"><span class="hs-identifier hs-var">variable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687854786"><span class="hs-identifier hs-var">variable</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-80"></span><span>      </span><span id="local-6989586621687854788"><span class="annot"><a href="#local-6989586621687854788"><span class="hs-identifier hs-var hs-var">endpointURL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;/api/rest/&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.intercalate</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621687854778"><span class="hs-identifier hs-var">pathComponents</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-comment">-- building endpoint properties</span><span>
</span><span id="line-83"></span><span>      </span><span id="local-6989586621687854790"><span class="annot"><a href="#local-6989586621687854790"><span class="hs-identifier hs-var hs-var">endpointVarList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Structure -&gt; EndpointUrl -&gt; [Referenced Param]
</span><a href="Hasura.Server.OpenAPI.html#collectParams"><span class="hs-identifier hs-var">collectParams</span></a></span><span> </span><span class="annot"><span class="annottext">Structure
</span><a href="#local-6989586621687854775"><span class="hs-identifier hs-var">analysis</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointUrl
</span><a href="#local-6989586621687854753"><span class="hs-identifier hs-var">_ceUrl</span></a></span><span>
</span><span id="line-84"></span><span>      </span><span id="local-6989586621687854792"><span class="annot"><a href="#local-6989586621687854792"><span class="hs-identifier hs-var hs-var">endpointDescription</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><span class="annottext">Maybe Text -&gt; Text
forall m. Monoid m =&gt; Maybe m -&gt; m
forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><span class="hs-identifier hs-var">fold</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621687854756"><span class="hs-identifier hs-var">_ceComment</span></a></span><span>
</span><span id="line-86"></span><span>          </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;***\nThe GraphQl query for this endpoint is:\n``` graphql\n&quot;</span></span><span>
</span><span id="line-87"></span><span>          </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687854763"><span class="hs-identifier hs-var">queryText</span></a></span><span>
</span><span id="line-88"></span><span>          </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n```&quot;</span></span><span>
</span><span id="line-89"></span><span>      </span><span id="local-6989586621687854794"><span class="annot"><a href="#local-6989586621687854794"><span class="hs-identifier hs-var hs-var">endpointName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmptyText -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.NonEmpty.html/Data.Text.NonEmpty.html#unNonEmptyText"><span class="hs-identifier hs-var">unNonEmptyText</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmptyText -&gt; Text) -&gt; NonEmptyText -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EndpointName -&gt; NonEmptyText
</span><a href="Hasura.RQL.Types.Endpoint.html#unEndpointName"><span class="hs-identifier hs-var">unEndpointName</span></a></span><span> </span><span class="annot"><span class="annottext">EndpointName
</span><a href="#local-6989586621687854752"><span class="hs-identifier hs-var">_ceName</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span id="local-6989586621687854797"><span class="annot"><a href="#local-6989586621687854797"><span class="hs-identifier hs-var">reqBody</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#buildRequestBody"><span class="hs-identifier hs-type">buildRequestBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854775"><span class="hs-identifier hs-type">analysis</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621687854799"><span class="annot"><a href="#local-6989586621687854799"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#buildResponse"><span class="hs-identifier hs-type">buildResponse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854775"><span class="hs-identifier hs-type">analysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854750"><span class="hs-identifier hs-type">method</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854788"><span class="hs-identifier hs-type">endpointURL</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- building the PathItem</span><span>
</span><span id="line-94"></span><span>      </span><span id="local-6989586621687854801"><span class="annot"><a href="#local-6989586621687854801"><span class="hs-identifier hs-var hs-var">operation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-95"></span><span>        </span><span class="annot"><span class="annottext">Operation
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-96"></span><span>          </span><span class="annot"><span class="annottext">Operation -&gt; (Operation -&gt; Operation) -&gt; Operation
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text))
-&gt; Operation -&gt; Identity Operation
forall s a. HasDescription s a =&gt; Lens' s a
Lens' Operation (Maybe Text)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#description"><span class="hs-identifier hs-var">description</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Operation -&gt; Identity Operation)
-&gt; Text -&gt; Operation -&gt; Operation
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687854792"><span class="hs-identifier hs-var">endpointDescription</span></a></span><span>
</span><span id="line-97"></span><span>          </span><span class="annot"><span class="annottext">Operation -&gt; (Operation -&gt; Operation) -&gt; Operation
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text))
-&gt; Operation -&gt; Identity Operation
forall s a. HasSummary s a =&gt; Lens' s a
Lens' Operation (Maybe Text)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#summary"><span class="hs-identifier hs-var">summary</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Operation -&gt; Identity Operation)
-&gt; Text -&gt; Operation -&gt; Operation
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687854794"><span class="hs-identifier hs-var">endpointName</span></a></span><span>
</span><span id="line-98"></span><span>          </span><span class="annot"><span class="annottext">Operation -&gt; (Operation -&gt; Operation) -&gt; Operation
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">([Referenced Param] -&gt; Identity [Referenced Param])
-&gt; Operation -&gt; Identity Operation
forall s a. HasParameters s a =&gt; Lens' s a
Lens' Operation [Referenced Param]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#parameters"><span class="hs-identifier hs-var">parameters</span></a></span><span> </span><span class="annot"><span class="annottext">(([Referenced Param] -&gt; Identity [Referenced Param])
 -&gt; Operation -&gt; Identity Operation)
-&gt; [Referenced Param] -&gt; Operation -&gt; Operation
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Param -&gt; Referenced Param
forall a. a -&gt; Referenced a
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-var">Inline</span></a></span><span> </span><span class="annot"><span class="annottext">Param
</span><a href="Hasura.Server.OpenAPI.html#xHasuraAdminSecret"><span class="hs-identifier hs-var">xHasuraAdminSecret</span></a></span><span> </span><span class="annot"><span class="annottext">Referenced Param -&gt; [Referenced Param] -&gt; [Referenced Param]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Referenced Param]
</span><a href="#local-6989586621687854790"><span class="hs-identifier hs-var">endpointVarList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>          </span><span class="annot"><span class="annottext">Operation -&gt; (Operation -&gt; Operation) -&gt; Operation
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Referenced RequestBody)
 -&gt; Identity (Maybe (Referenced RequestBody)))
-&gt; Operation -&gt; Identity Operation
forall s a. HasRequestBody s a =&gt; Lens' s a
Lens' Operation (Maybe (Referenced RequestBody))
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#requestBody"><span class="hs-identifier hs-var">requestBody</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe (Referenced RequestBody)
  -&gt; Identity (Maybe (Referenced RequestBody)))
 -&gt; Operation -&gt; Identity Operation)
-&gt; Maybe (Referenced RequestBody) -&gt; Operation -&gt; Operation
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Referenced RequestBody)
</span><a href="#local-6989586621687854797"><span class="hs-identifier hs-var">reqBody</span></a></span><span>
</span><span id="line-100"></span><span>          </span><span class="annot"><span class="annottext">Operation -&gt; (Operation -&gt; Operation) -&gt; Operation
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Responses -&gt; Identity Responses)
-&gt; Operation -&gt; Identity Operation
forall s a. HasResponses s a =&gt; Lens' s a
Lens' Operation Responses
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#responses"><span class="hs-identifier hs-var">responses</span></a></span><span> </span><span class="annot"><span class="annottext">((Responses -&gt; Identity Responses)
 -&gt; Operation -&gt; Identity Operation)
-&gt; Responses -&gt; Operation -&gt; Operation
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Referenced Response)
-&gt; InsOrdHashMap HttpStatusCode (Referenced Response) -&gt; Responses
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Responses"><span class="hs-identifier hs-var">Responses</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Referenced Response)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpStatusCode
-&gt; Referenced Response
-&gt; InsOrdHashMap HttpStatusCode (Referenced Response)
forall k v. Hashable k =&gt; k -&gt; v -&gt; InsOrdHashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/insert-ordered-containers-0.2.5.3-dcb71999c8104475fd299533bb40a6c15ee8a9411f3a03b68aa99a14a4143c19/share/doc/html/src/Data.HashMap.Strict.InsOrd.html/Data.HashMap.Strict.InsOrd.html#singleton"><span class="hs-identifier hs-var">InsOrdHashMap.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode
</span><span class="hs-number">200</span></span><span> </span><span class="annot"><span class="annottext">(Referenced Response
 -&gt; InsOrdHashMap HttpStatusCode (Referenced Response))
-&gt; Referenced Response
-&gt; InsOrdHashMap HttpStatusCode (Referenced Response)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Response -&gt; Referenced Response
forall a. a -&gt; Referenced a
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-var">Inline</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621687854799"><span class="hs-identifier hs-var">response</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>      </span><span id="local-6989586621687854810"><span class="annot"><a href="#local-6989586621687854810"><span class="hs-identifier hs-var hs-var">pathItem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-102"></span><span>        </span><span class="annot"><span class="annottext">PathItem
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">PathItem -&gt; (PathItem -&gt; PathItem) -&gt; PathItem
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="#local-6989586621687854750"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-103"></span><span>          </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="Hasura.RQL.Types.Endpoint.html#GET"><span class="hs-identifier hs-var">GET</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe Operation -&gt; Identity (Maybe Operation))
-&gt; PathItem -&gt; Identity PathItem
forall s a. HasGet s a =&gt; Lens' s a
Lens' PathItem (Maybe Operation)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Operation -&gt; Identity (Maybe Operation))
 -&gt; PathItem -&gt; Identity PathItem)
-&gt; Operation -&gt; PathItem -&gt; PathItem
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">Operation
</span><a href="#local-6989586621687854801"><span class="hs-identifier hs-var">operation</span></a></span><span>
</span><span id="line-104"></span><span>          </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="Hasura.RQL.Types.Endpoint.html#PUT"><span class="hs-identifier hs-var">PUT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe Operation -&gt; Identity (Maybe Operation))
-&gt; PathItem -&gt; Identity PathItem
forall s a. HasPut s a =&gt; Lens' s a
Lens' PathItem (Maybe Operation)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Operation -&gt; Identity (Maybe Operation))
 -&gt; PathItem -&gt; Identity PathItem)
-&gt; Operation -&gt; PathItem -&gt; PathItem
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">Operation
</span><a href="#local-6989586621687854801"><span class="hs-identifier hs-var">operation</span></a></span><span>
</span><span id="line-105"></span><span>          </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="Hasura.RQL.Types.Endpoint.html#POST"><span class="hs-identifier hs-var">POST</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe Operation -&gt; Identity (Maybe Operation))
-&gt; PathItem -&gt; Identity PathItem
forall s a. HasPost s a =&gt; Lens' s a
Lens' PathItem (Maybe Operation)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#post"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Operation -&gt; Identity (Maybe Operation))
 -&gt; PathItem -&gt; Identity PathItem)
-&gt; Operation -&gt; PathItem -&gt; PathItem
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">Operation
</span><a href="#local-6989586621687854801"><span class="hs-identifier hs-var">operation</span></a></span><span>
</span><span id="line-106"></span><span>          </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="Hasura.RQL.Types.Endpoint.html#PATCH"><span class="hs-identifier hs-var">PATCH</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe Operation -&gt; Identity (Maybe Operation))
-&gt; PathItem -&gt; Identity PathItem
forall s a. HasPatch s a =&gt; Lens' s a
Lens' PathItem (Maybe Operation)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#patch"><span class="hs-identifier hs-var">patch</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Operation -&gt; Identity (Maybe Operation))
 -&gt; PathItem -&gt; Identity PathItem)
-&gt; Operation -&gt; PathItem -&gt; PathItem
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">Operation
</span><a href="#local-6989586621687854801"><span class="hs-identifier hs-var">operation</span></a></span><span>
</span><span id="line-107"></span><span>          </span><span class="annot"><span class="annottext">EndpointMethod
</span><a href="Hasura.RQL.Types.Endpoint.html#DELETE"><span class="hs-identifier hs-var">DELETE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe Operation -&gt; Identity (Maybe Operation))
-&gt; PathItem -&gt; Identity PathItem
forall s a. HasDelete s a =&gt; Lens' s a
Lens' PathItem (Maybe Operation)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#delete"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Operation -&gt; Identity (Maybe Operation))
 -&gt; PathItem -&gt; Identity PathItem)
-&gt; Operation -&gt; PathItem -&gt; PathItem
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">Operation
</span><a href="#local-6989586621687854801"><span class="hs-identifier hs-var">operation</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>      </span><span class="hs-comment">-- making summary of errors</span><span>
</span><span id="line-110"></span><span>      </span><span id="local-6989586621687854821"><span class="annot"><a href="#local-6989586621687854821"><span class="hs-identifier hs-var hs-var">formattedMessages</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-111"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621687854776"><span class="hs-identifier hs-var">messages</span></a></span><span>
</span><span id="line-112"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-113"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n\nEndpoint \&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687854794"><span class="hs-identifier hs-var">endpointName</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; [Text] -&gt; Text
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n- &#9888;&#65039; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621687854776"><span class="hs-identifier hs-var">messages</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/insert-ordered-containers-0.2.5.3-dcb71999c8104475fd299533bb40a6c15ee8a9411f3a03b68aa99a14a4143c19/share/doc/html/src/Data.HashMap.Strict.InsOrd.html/Data.HashMap.Strict.InsOrd.html#singleton"><span class="hs-identifier hs-type">InsOrdHashMap.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">T.unpack</span></span><span> </span><span class="annot"><a href="#local-6989586621687854788"><span class="hs-identifier hs-type">endpointURL</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621687854810"><span class="hs-identifier hs-type">pathItem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621687854821"><span class="hs-identifier hs-type">formattedMessages</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- Parameters</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- | Given the 'Structure' of a query, generate the corresponding parameters.</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- We expect one optional parameter per known scalar variable.</span><span>
</span><span id="line-123"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#collectParams"><span class="hs-identifier hs-type">collectParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointUrl"><span class="hs-identifier hs-type">EndpointUrl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Referenced"><span class="hs-identifier hs-type">Referenced</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-124"></span><span id="collectParams"><span class="annot"><span class="annottext">collectParams :: Structure -&gt; EndpointUrl -&gt; [Referenced Param]
</span><a href="Hasura.Server.OpenAPI.html#collectParams"><span class="hs-identifier hs-var hs-var">collectParams</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Name FieldInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687854824"><span class="annot"><span class="annottext">HashMap Name VariableInfo
</span><a href="#local-6989586621687854824"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621687854825"><span class="annot"><span class="annottext">EndpointUrl
</span><a href="#local-6989586621687854825"><span class="hs-identifier hs-var">eURL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#unName"><span class="hs-identifier hs-var">G.unName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621687854827"><span class="annot"><a href="#local-6989586621687854827"><span class="hs-identifier hs-var">varName</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#VariableInfo"><span class="hs-identifier hs-type">VariableInfo</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687854829"><span id="local-6989586621687854830"><span id="local-6989586621687854831"><span class="annot"><a href="#local-6989586621687854829"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Name, VariableInfo) -&gt; Name)
-&gt; [(Name, VariableInfo)] -&gt; [(Name, VariableInfo)]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortOn</span></span><span> </span><span class="annot"><span class="annottext">(Name, VariableInfo) -&gt; Name
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([(Name, VariableInfo)] -&gt; [(Name, VariableInfo)])
-&gt; [(Name, VariableInfo)] -&gt; [(Name, VariableInfo)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap Name VariableInfo -&gt; [(Name, VariableInfo)]
forall k v. HashMap k v -&gt; [(k, v)]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#toList"><span class="hs-identifier hs-var">HashMap.toList</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Name VariableInfo
</span><a href="#local-6989586621687854824"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621687854830"><span class="hs-identifier hs-type">_viTypeInfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-comment">-- we do not allow input objects or enums in parameters</span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#InputFieldObjectInfo"><span class="hs-identifier hs-type">InputFieldObjectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">InputObjectInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Referenced Param]
forall a. [a]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><span class="hs-identifier hs-var">empty</span></span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#InputFieldEnumInfo"><span class="hs-identifier hs-type">InputFieldEnumInfo</span></a></span><span> </span><span class="annot"><span class="annottext">EnumInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Referenced Param]
forall a. [a]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><span class="hs-identifier hs-var">empty</span></span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#InputFieldScalarInfo"><span class="hs-identifier hs-type">InputFieldScalarInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687854829"><span class="hs-identifier hs-var">_viType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-131"></span><span>      </span><span class="hs-comment">-- we do not allow arrays in parameters</span><span>
</span><span id="line-132"></span><span>      </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#TypeList"><span class="hs-identifier hs-type">G.TypeList</span></a></span><span> </span><span class="annot"><span class="annottext">Nullability
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">GType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Referenced Param]
forall a. [a]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><span class="hs-identifier hs-var">empty</span></span><span>
</span><span id="line-133"></span><span>      </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#TypeNamed"><span class="hs-identifier hs-type">G.TypeNamed</span></a></span><span> </span><span id="local-6989586621687854843"><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687854843"><span class="hs-identifier hs-var">nullability</span></a></span></span><span> </span><span id="local-6989586621687854844"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687854844"><span class="hs-identifier hs-var">typeName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe (OpenApiType, Maybe Text, Bool)
</span><a href="Hasura.Server.OpenAPI.html#getReferenceScalarInfo"><span class="hs-identifier hs-var">getReferenceScalarInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687854844"><span class="hs-identifier hs-var">typeName</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-134"></span><span>        </span><span class="hs-comment">-- we do not allow unknown scalars in parameters</span><span>
</span><span id="line-135"></span><span>        </span><span class="annot"><span class="annottext">Maybe (OpenApiType, Maybe Text, Bool)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Referenced Param]
forall a. [a]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><span class="hs-identifier hs-var">empty</span></span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687854846"><span class="annot"><span class="annottext">OpenApiType
</span><a href="#local-6989586621687854846"><span class="hs-identifier hs-var">refType</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687854847"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621687854847"><span class="hs-identifier hs-var">typePattern</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687854848"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687854848"><span class="hs-identifier hs-var">_shouldInline</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-137"></span><span>          </span><span class="hs-comment">-- TODO: there's duplication between this piece of the code and the request body</span><span>
</span><span id="line-138"></span><span>          </span><span class="hs-comment">-- do we want to ensure consistency by deduplicating?</span><span>
</span><span id="line-139"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687854849"><span class="annot"><span class="annottext">isRequired :: Bool
</span><a href="#local-6989586621687854849"><span class="hs-identifier hs-var hs-var">isRequired</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nullability -&gt; Bool
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#unNullability"><span class="hs-identifier hs-var">G.unNullability</span></a></span><span> </span><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687854843"><span class="hs-identifier hs-var">nullability</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Value Void) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Value Void)
</span><a href="#local-6989586621687854831"><span class="hs-identifier hs-var">_viDefaultValue</span></a></span><span>
</span><span id="line-140"></span><span>              </span><span id="local-6989586621687854854"><span class="annot"><span class="annottext">desc :: Maybe Text
</span><a href="#local-6989586621687854854"><span class="hs-identifier hs-var hs-var">desc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687854849"><span class="hs-identifier hs-var">isRequired</span></a></span><span>
</span><span id="line-142"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text) -&gt; Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;_\&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687854827"><span class="hs-identifier hs-var">varName</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\&quot; is required (enter it either in parameters or request body)_&quot;</span></span><span>
</span><span id="line-143"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-144"></span><span>              </span><span class="hs-comment">-- TODO: document this</span><span>
</span><span id="line-145"></span><span>              </span><span class="hs-comment">-- NOTE: URL Variable name ':' prefix is removed for `elem` lookup.</span><span>
</span><span id="line-146"></span><span>              </span><span id="local-6989586621687854855"><span class="annot"><span class="annottext">pathVars :: [Text]
</span><a href="#local-6989586621687854855"><span class="hs-identifier hs-var hs-var">pathVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; [Text] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HttpStatusCode -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">HttpStatusCode
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; [Text]) -&gt; [Text] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Text]] -&gt; [Text]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Text]] -&gt; [Text]) -&gt; [[Text]] -&gt; [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; [Text]) -&gt; (Text -&gt; [Text]) -&gt; EndpointUrl -&gt; [[Text]]
forall a. (Text -&gt; a) -&gt; (Text -&gt; a) -&gt; EndpointUrl -&gt; [a]
</span><a href="Hasura.RQL.Types.Endpoint.html#splitPath"><span class="hs-identifier hs-var">splitPath</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Text -&gt; [Text]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EndpointUrl
</span><a href="#local-6989586621687854825"><span class="hs-identifier hs-var">eURL</span></a></span><span>
</span><span id="line-147"></span><span>          </span><span class="annot"><span class="annottext">Referenced Param -&gt; [Referenced Param]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-148"></span><span>            </span><span class="annot"><span class="annottext">(Referenced Param -&gt; [Referenced Param])
-&gt; Referenced Param -&gt; [Referenced Param]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-149"></span><span>            </span><span class="hs-comment">-- We always inline the schema, since we might need to add the default value.</span><span>
</span><span id="line-150"></span><span>            </span><span class="annot"><span class="annottext">Param -&gt; Referenced Param
forall a. a -&gt; Referenced a
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-var">Inline</span></a></span><span>
</span><span id="line-151"></span><span>            </span><span class="annot"><span class="annottext">(Param -&gt; Referenced Param) -&gt; Param -&gt; Referenced Param
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Param
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-152"></span><span>            </span><span class="annot"><span class="annottext">Param -&gt; (Param -&gt; Param) -&gt; Param
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Identity Text) -&gt; Param -&gt; Identity Param
forall s a. HasName s a =&gt; Lens' s a
Lens' Param Text
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#name"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; Identity Text) -&gt; Param -&gt; Identity Param)
-&gt; Text -&gt; Param -&gt; Param
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687854827"><span class="hs-identifier hs-var">varName</span></a></span><span>
</span><span id="line-153"></span><span>            </span><span class="annot"><span class="annottext">Param -&gt; (Param -&gt; Param) -&gt; Param
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Param -&gt; Identity Param
forall s a. HasDescription s a =&gt; Lens' s a
Lens' Param (Maybe Text)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#description"><span class="hs-identifier hs-var">description</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text)) -&gt; Param -&gt; Identity Param)
-&gt; Maybe Text -&gt; Param -&gt; Param
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621687854854"><span class="hs-identifier hs-var">desc</span></a></span><span>
</span><span id="line-154"></span><span>            </span><span class="annot"><span class="annottext">Param -&gt; (Param -&gt; Param) -&gt; Param
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(ParamLocation -&gt; Identity ParamLocation)
-&gt; Param -&gt; Identity Param
forall s a. HasIn s a =&gt; Lens' s a
Lens' Param ParamLocation
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#in_"><span class="hs-identifier hs-var">in_</span></a></span><span> </span><span class="annot"><span class="annottext">((ParamLocation -&gt; Identity ParamLocation)
 -&gt; Param -&gt; Identity Param)
-&gt; ParamLocation -&gt; Param -&gt; Param
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687854827"><span class="hs-identifier hs-var">varName</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621687854855"><span class="hs-identifier hs-var">pathVars</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ParamLocation
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#ParamPath"><span class="hs-identifier hs-var">ParamPath</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ParamLocation
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#ParamQuery"><span class="hs-identifier hs-var">ParamQuery</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>            </span><span class="annot"><span class="annottext">Param -&gt; (Param -&gt; Param) -&gt; Param
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Referenced Schema) -&gt; Identity (Maybe (Referenced Schema)))
-&gt; Param -&gt; Identity Param
forall s a. HasSchema s a =&gt; Lens' s a
Lens' Param (Maybe (Referenced Schema))
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#schema"><span class="hs-identifier hs-var">schema</span></a></span><span>
</span><span id="line-156"></span><span>              </span><span class="annot"><span class="annottext">((Maybe (Referenced Schema)
  -&gt; Identity (Maybe (Referenced Schema)))
 -&gt; Param -&gt; Identity Param)
-&gt; Referenced Schema -&gt; Param -&gt; Param
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Referenced Schema
forall a. a -&gt; Referenced a
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-var">Inline</span></a></span><span>
</span><span id="line-157"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-158"></span><span>                    </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Value -&gt; Identity (Maybe Value))
-&gt; Schema -&gt; Identity Schema
forall s a. HasDefault s a =&gt; Lens' s a
Lens' Schema (Maybe Value)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#default_"><span class="hs-identifier hs-var">default_</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Value -&gt; Identity (Maybe Value))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe Value -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value Void -&gt; Value
</span><a href="Hasura.Server.OpenAPI.html#gqlToJsonValue"><span class="hs-identifier hs-var">gqlToJsonValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Value Void -&gt; Value) -&gt; Maybe (Value Void) -&gt; Maybe Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Value Void)
</span><a href="#local-6989586621687854831"><span class="hs-identifier hs-var">_viDefaultValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>                    </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
-&gt; Schema -&gt; Identity Schema
forall s a. HasType s a =&gt; Lens' s a
Lens' Schema (Maybe OpenApiType)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#type_"><span class="hs-identifier hs-var">type_</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
 -&gt; Schema -&gt; Identity Schema)
-&gt; OpenApiType -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><a href="#local-6989586621687854846"><span class="hs-identifier hs-var">refType</span></a></span><span>
</span><span id="line-160"></span><span>                    </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasPattern s a =&gt; Lens' s a
Lens' Schema (Maybe Text)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#pattern"><span class="hs-identifier hs-var">pattern</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621687854847"><span class="hs-identifier hs-var">typePattern</span></a></span><span>
</span><span id="line-161"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- Request body</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Given the 'Structure' of a query, generate the corresponding 'RequestBody'.</span><span>
</span><span id="line-167"></span><span class="hs-comment">--</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- We always expect an object that has a field per variable of the query if</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- there is at least one variable in the query; otherwise we don't expect a</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- request body.</span><span>
</span><span id="line-171"></span><span id="local-6989586621687854268"><span class="annot"><a href="Hasura.Server.OpenAPI.html#buildRequestBody"><span class="hs-identifier hs-type">buildRequestBody</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854268"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFix</span></span><span> </span><span class="annot"><a href="#local-6989586621687854268"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#DeclareM"><span class="hs-identifier hs-type">DeclareM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854268"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Referenced"><span class="hs-identifier hs-type">Referenced</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#RequestBody"><span class="hs-identifier hs-type">RequestBody</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-175"></span><span id="buildRequestBody"><span class="annot"><span class="annottext">buildRequestBody :: forall (m :: * -&gt; *).
(MonadError QErr m, MonadFix m) =&gt;
Structure -&gt; DeclareM m (Maybe (Referenced RequestBody))
</span><a href="Hasura.Server.OpenAPI.html#buildRequestBody"><span class="hs-identifier hs-var hs-var">buildRequestBody</span></a></span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687854932"><span id="local-6989586621687854933"><span class="annot"><span class="annottext">HashMap Name VariableInfo
HashMap Name FieldInfo
_stSelection :: HashMap Name FieldInfo
_stVariables :: HashMap Name VariableInfo
_stVariables :: Structure -&gt; HashMap Name VariableInfo
_stSelection :: Structure -&gt; HashMap Name FieldInfo
</span><a href="#local-6989586621687854932"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687854936"><span class="annot"><span class="annottext">vars :: [(Name, VariableInfo)]
</span><a href="#local-6989586621687854936"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashMap Name VariableInfo -&gt; [(Name, VariableInfo)]
forall k v. HashMap k v -&gt; [(k, v)]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#toList"><span class="hs-identifier hs-var">HashMap.toList</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Name VariableInfo
</span><a href="#local-6989586621687854933"><span class="hs-identifier hs-var">_stVariables</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[(Name, VariableInfo)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(Name, VariableInfo)]
</span><a href="#local-6989586621687854936"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (Referenced RequestBody)
-&gt; DeclareT (Definitions Schema) m (Maybe (Referenced RequestBody))
forall a. a -&gt; DeclareT (Definitions Schema) m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Referenced RequestBody)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-180"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621687854937"><span class="annot"><a href="#local-6989586621687854937"><span class="hs-identifier hs-var">varProperties</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Any</span></span><span> </span><span id="local-6989586621687854939"><span class="annot"><a href="#local-6989586621687854939"><span class="hs-identifier hs-var">isBodyRequired</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><span class="annottext">CircularT
  (Name, Nullability)
  (Referenced Schema)
  (DeclareT (Definitions Schema) m)
  (InsOrdHashMap Text (Referenced Schema), Any)
-&gt; DeclareT
     (Definitions Schema)
     m
     (InsOrdHashMap Text (Referenced Schema), Any)
forall k (m :: * -&gt; *) v a.
(Hashable k, MonadFix m) =&gt;
CircularT k v m a -&gt; m a
</span><a href="Control.Monad.Circular.html#runCircularT"><span class="hs-identifier hs-var">runCircularT</span></a></span><span>
</span><span id="line-182"></span><span>          </span><span class="annot"><span class="annottext">(CircularT
   (Name, Nullability)
   (Referenced Schema)
   (DeclareT (Definitions Schema) m)
   (InsOrdHashMap Text (Referenced Schema), Any)
 -&gt; DeclareT
      (Definitions Schema)
      m
      (InsOrdHashMap Text (Referenced Schema), Any))
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareT (Definitions Schema) m)
     (InsOrdHashMap Text (Referenced Schema), Any)
-&gt; DeclareT
     (Definitions Schema)
     m
     (InsOrdHashMap Text (Referenced Schema), Any)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(InsOrdHashMap Text (Referenced Schema), Any)]
-&gt; (InsOrdHashMap Text (Referenced Schema), Any)
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-183"></span><span>          </span><span class="annot"><span class="annottext">([(InsOrdHashMap Text (Referenced Schema), Any)]
 -&gt; (InsOrdHashMap Text (Referenced Schema), Any))
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareT (Definitions Schema) m)
     [(InsOrdHashMap Text (Referenced Schema), Any)]
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareT (Definitions Schema) m)
     (InsOrdHashMap Text (Referenced Schema), Any)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Name, VariableInfo)]
-&gt; ((Name, VariableInfo)
    -&gt; CircularT
         (Name, Nullability)
         (Referenced Schema)
         (DeclareT (Definitions Schema) m)
         (InsOrdHashMap Text (Referenced Schema), Any))
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareT (Definitions Schema) m)
     [(InsOrdHashMap Text (Referenced Schema), Any)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="annot"><span class="annottext">[(Name, VariableInfo)]
</span><a href="#local-6989586621687854936"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621687854942"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687854942"><span class="hs-identifier hs-var">varName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687854943"><span class="annot"><span class="annottext">VariableInfo
</span><a href="#local-6989586621687854943"><span class="hs-identifier hs-var">varInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-184"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621687854944"><span class="annot"><a href="#local-6989586621687854944"><span class="hs-identifier hs-var">resolvedVarInfo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687854945"><span class="annot"><a href="#local-6989586621687854945"><span class="hs-identifier hs-var">isVarRequired</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VariableInfo
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareT (Definitions Schema) m)
     (Referenced Schema, Bool)
forall (m :: * -&gt; *).
(MonadError QErr m, MonadFix m) =&gt;
VariableInfo
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     (Referenced Schema, Bool)
</span><a href="Hasura.Server.OpenAPI.html#buildVariableSchema"><span class="hs-identifier hs-var">buildVariableSchema</span></a></span><span> </span><span class="annot"><span class="annottext">VariableInfo
</span><a href="#local-6989586621687854943"><span class="hs-identifier hs-var">varInfo</span></a></span><span>
</span><span id="line-185"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/insert-ordered-containers-0.2.5.3-dcb71999c8104475fd299533bb40a6c15ee8a9411f3a03b68aa99a14a4143c19/share/doc/html/src/Data.HashMap.Strict.InsOrd.html/Data.HashMap.Strict.InsOrd.html#singleton"><span class="hs-identifier hs-type">InsOrdHashMap.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#unName"><span class="hs-identifier hs-var">G.unName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854942"><span class="hs-identifier hs-type">varName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687854944"><span class="hs-identifier hs-type">resolvedVarInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Any</span></span><span> </span><span class="annot"><a href="#local-6989586621687854945"><span class="hs-identifier hs-type">isVarRequired</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-187"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-type">Inline</span></a></span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#description"><span class="hs-identifier hs-type">description</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-type">?~</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Query parameters can also be provided in the request body as a JSON object&quot;</span></span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#required"><span class="hs-identifier hs-type">required</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-type">?~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854939"><span class="hs-identifier hs-type">isBodyRequired</span></a></span><span>
</span><span id="line-192"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#content"><span class="hs-identifier hs-type">content</span></a></span><span>
</span><span id="line-193"></span><span>          </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-type">.~</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/insert-ordered-containers-0.2.5.3-dcb71999c8104475fd299533bb40a6c15ee8a9411f3a03b68aa99a14a4143c19/share/doc/html/src/Data.HashMap.Strict.InsOrd.html/Data.HashMap.Strict.InsOrd.html#singleton"><span class="hs-identifier hs-type">InsOrdHashMap.singleton</span></a></span><span>
</span><span id="line-194"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;application&quot;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/http-media-0.8.1.1-3a03975090f09e0666dc26143010e7352a93c76073df688d8d989f5bf00377bb/share/doc/html/src/Network.HTTP.Media.MediaType.html/Network.HTTP.Media.MediaType.html#%2F%2F"><span class="hs-operator hs-type">//</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;json&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span>
</span><span id="line-196"></span><span>                </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#schema"><span class="hs-identifier hs-type">schema</span></a></span><span>
</span><span id="line-197"></span><span>                  </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-type">?~</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-type">Inline</span></a></span><span>
</span><span id="line-198"></span><span>                    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span>
</span><span id="line-199"></span><span>                        </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#type_"><span class="hs-identifier hs-type">type_</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-type">?~</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#OpenApiObject"><span class="hs-identifier hs-type">OpenApiObject</span></a></span><span>
</span><span id="line-200"></span><span>                        </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#properties"><span class="hs-identifier hs-type">properties</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-type">.~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854937"><span class="hs-identifier hs-type">varProperties</span></a></span><span>
</span><span id="line-201"></span><span>                    </span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | Given the information about a variable, build the corresponding schema.</span><span>
</span><span id="line-205"></span><span class="hs-comment">--</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- Returns the generated schema, and a boolean indicating whether the variable</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- is required.</span><span>
</span><span id="line-208"></span><span id="local-6989586621687854358"><span class="annot"><a href="Hasura.Server.OpenAPI.html#buildVariableSchema"><span class="hs-identifier hs-type">buildVariableSchema</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854358"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFix</span></span><span> </span><span class="annot"><a href="#local-6989586621687854358"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#VariableInfo"><span class="hs-identifier hs-type">VariableInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><a href="Control.Monad.Circular.html#CircularT"><span class="hs-identifier hs-type">CircularT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#Name"><span class="hs-identifier hs-type">G.Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#Nullability"><span class="hs-identifier hs-type">G.Nullability</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Referenced"><span class="hs-identifier hs-type">Referenced</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.OpenAPI.html#DeclareM"><span class="hs-identifier hs-type">DeclareM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854358"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Referenced"><span class="hs-identifier hs-type">Referenced</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-212"></span><span id="buildVariableSchema"><span class="annot"><span class="annottext">buildVariableSchema :: forall (m :: * -&gt; *).
(MonadError QErr m, MonadFix m) =&gt;
VariableInfo
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     (Referenced Schema, Bool)
</span><a href="Hasura.Server.OpenAPI.html#buildVariableSchema"><span class="hs-identifier hs-var hs-var">buildVariableSchema</span></a></span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#VariableInfo"><span class="hs-identifier hs-type">VariableInfo</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687854983"><span id="local-6989586621687854984"><span id="local-6989586621687854985"><span class="annot"><span class="annottext">Maybe (Value Void)
GType
InputFieldInfo
_viDefaultValue :: VariableInfo -&gt; Maybe (Value Void)
_viTypeInfo :: VariableInfo -&gt; InputFieldInfo
_viType :: VariableInfo -&gt; GType
_viType :: GType
_viTypeInfo :: InputFieldInfo
_viDefaultValue :: Maybe (Value Void)
</span><a href="Hasura.GraphQL.Analyse.html#_viDefaultValue"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-comment">-- a variable is optional if:</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-comment">--   - it has a default value</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-comment">--   - it's nullable</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-comment">--   - it's a known scalar (it will be available as a parameter)</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687854986"><span class="annot"><span class="annottext">hasDefaultValue :: Bool
</span><a href="#local-6989586621687854986"><span class="hs-identifier hs-var hs-var hs-var">hasDefaultValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Value Void) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Value Void)
</span><a href="#local-6989586621687854985"><span class="hs-identifier hs-var">_viDefaultValue</span></a></span><span>
</span><span id="line-218"></span><span>      </span><span id="local-6989586621687854987"><span class="annot"><span class="annottext">isNullable :: Bool
</span><a href="#local-6989586621687854987"><span class="hs-identifier hs-var hs-var hs-var">isNullable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GType -&gt; Bool
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#isNullable"><span class="hs-identifier hs-var">G.isNullable</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687854983"><span class="hs-identifier hs-var">_viType</span></a></span><span>
</span><span id="line-219"></span><span>      </span><span id="local-6989586621687854989"><span class="annot"><span class="annottext">isKnownScalar :: Bool
</span><a href="#local-6989586621687854989"><span class="hs-identifier hs-var hs-var hs-var">isKnownScalar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687854983"><span class="hs-identifier hs-var">_viType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#TypeNamed"><span class="hs-identifier hs-type">G.TypeNamed</span></a></span><span> </span><span class="annot"><span class="annottext">Nullability
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687854990"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687854990"><span class="hs-identifier hs-var">typeName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (OpenApiType, Maybe Text, Bool) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe (OpenApiType, Maybe Text, Bool)
</span><a href="Hasura.Server.OpenAPI.html#getReferenceScalarInfo"><span class="hs-identifier hs-var">getReferenceScalarInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687854990"><span class="hs-identifier hs-var">typeName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><span class="annottext">GType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-222"></span><span>      </span><span id="local-6989586621687854991"><span class="annot"><span class="annottext">isOptional :: Bool
</span><a href="#local-6989586621687854991"><span class="hs-identifier hs-var hs-var hs-var">isOptional</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687854986"><span class="hs-identifier hs-var">hasDefaultValue</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687854987"><span class="hs-identifier hs-var">isNullable</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687854989"><span class="hs-identifier hs-var">isKnownScalar</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621687854992"><span class="annot"><a href="#local-6989586621687854992"><span class="hs-identifier hs-var">baseSchema</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GType
-&gt; InputFieldInfo
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     (Referenced Schema)
forall (m :: * -&gt; *).
MonadFix m =&gt;
GType
-&gt; InputFieldInfo
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#buildInputFieldSchema"><span class="hs-identifier hs-var">buildInputFieldSchema</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687854983"><span class="hs-identifier hs-var">_viType</span></a></span><span> </span><span class="annot"><span class="annottext">InputFieldInfo
</span><a href="#local-6989586621687854984"><span class="hs-identifier hs-var">_viTypeInfo</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621687854994"><span class="annot"><a href="#local-6989586621687854994"><span class="hs-identifier hs-var">varSchema</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621687854985"><span class="hs-identifier hs-type">_viDefaultValue</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-comment">-- If we don't need to modify the schema by adding a default value, we leave</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-comment">-- it unchanged (which means it might be a reference rather than inlined).</span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Value Void)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Referenced Schema
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     (Referenced Schema)
forall a.
a
-&gt; CircularT (Name, Nullability) (Referenced Schema) (DeclareM m) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Referenced Schema
</span><a href="#local-6989586621687854992"><span class="hs-identifier hs-var">baseSchema</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-comment">-- If we need to modify it, then we might have to dereference it.</span><span>
</span><span id="line-230"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621687854995"><span class="annot"><span class="annottext">Value Void
</span><a href="#local-6989586621687854995"><span class="hs-identifier hs-var">defaultValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-231"></span><span>      </span><span id="local-6989586621687854996"><span class="annot"><a href="#local-6989586621687854996"><span class="hs-identifier hs-var">varSchema</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Referenced Schema
</span><a href="#local-6989586621687854992"><span class="hs-identifier hs-var">baseSchema</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-232"></span><span>        </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-type">Inline</span></a></span><span> </span><span id="local-6989586621687854997"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621687854997"><span class="hs-identifier hs-var">varSchema</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Schema
-&gt; CircularT
     (Name, Nullability) (Referenced Schema) (DeclareM m) Schema
forall a.
a
-&gt; CircularT (Name, Nullability) (Referenced Schema) (DeclareM m) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621687854997"><span class="hs-identifier hs-var">varSchema</span></a></span><span>
</span><span id="line-233"></span><span>        </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Ref"><span class="hs-identifier hs-type">Ref</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Reference"><span class="hs-identifier hs-type">Reference</span></a></span><span> </span><span id="local-6989586621687855000"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687855000"><span class="hs-identifier hs-var">refName</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-234"></span><span>          </span><span class="hs-comment">-- We introspect the declarations to retrieve the underlying</span><span>
</span><span id="line-235"></span><span>          </span><span class="hs-comment">-- schema. we know the type will have a corresponding declaration</span><span>
</span><span id="line-236"></span><span>          </span><span class="hs-comment">-- since all references are created by 'declareType'. This might</span><span>
</span><span id="line-237"></span><span>          </span><span class="hs-comment">-- result in an unnecessary component declaration if here is the only</span><span>
</span><span id="line-238"></span><span>          </span><span class="hs-comment">-- place the reference would have been used.</span><span>
</span><span id="line-239"></span><span>          </span><span id="local-6989586621687855001"><span class="annot"><a href="#local-6989586621687855001"><span class="hs-identifier hs-var">declarations</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DeclareM m (Definitions Schema)
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     (Definitions Schema)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; CircularT (Name, Nullability) (Referenced Schema) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">DeclareM m (Definitions Schema)
forall d (m :: * -&gt; *). MonadDeclare d m =&gt; m d
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Declare.html/Data.OpenApi.Declare.html#look"><span class="hs-identifier hs-var">look</span></a></span><span>
</span><span id="line-240"></span><span>          </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/insert-ordered-containers-0.2.5.3-dcb71999c8104475fd299533bb40a6c15ee8a9411f3a03b68aa99a14a4143c19/share/doc/html/src/Data.HashMap.Strict.InsOrd.html/Data.HashMap.Strict.InsOrd.html#lookup"><span class="hs-identifier hs-type">InsOrdHashMap.lookup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687855000"><span class="hs-identifier hs-type">refName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687855001"><span class="hs-identifier hs-type">declarations</span></a></span><span>
</span><span id="line-241"></span><span>            </span><span class="hs-comment">-- DeclareT doesn't have a MonadError instance, hence the need for</span><span>
</span><span id="line-242"></span><span>            </span><span class="hs-comment">-- explicit lifting.</span><span>
</span><span id="line-243"></span><span>            </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html/Hasura.Prelude.html#onNothing"><span class="hs-operator hs-type">`onNothing`</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw500"><span class="hs-identifier hs-type">throw500</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;internal error: declareType returned an invalid reference&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-type">Inline</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621687854996"><span class="hs-identifier hs-type">varSchema</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#default_"><span class="hs-identifier hs-type">default_</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-type">?~</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#gqlToJsonValue"><span class="hs-identifier hs-type">gqlToJsonValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854995"><span class="hs-identifier hs-type">defaultValue</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621687854994"><span class="hs-identifier hs-type">varSchema</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="annot"><a href="#local-6989586621687854991"><span class="hs-identifier hs-type">isOptional</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><span class="hs-comment">-- | Given the information about an input type, build the corresponding schema.</span></span><span>
</span><span id="line-249"></span><span id="local-6989586621687854371"><span class="annot"><a href="Hasura.Server.OpenAPI.html#buildInputFieldSchema"><span class="hs-identifier hs-type">buildInputFieldSchema</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadFix</span></span><span> </span><span class="annot"><a href="#local-6989586621687854371"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-251"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#GType"><span class="hs-identifier hs-type">G.GType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-252"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#InputFieldInfo"><span class="hs-identifier hs-type">InputFieldInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><a href="Control.Monad.Circular.html#CircularT"><span class="hs-identifier hs-type">CircularT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#Name"><span class="hs-identifier hs-type">G.Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#Nullability"><span class="hs-identifier hs-type">G.Nullability</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Referenced"><span class="hs-identifier hs-type">Referenced</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.OpenAPI.html#DeclareM"><span class="hs-identifier hs-type">DeclareM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854371"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Referenced"><span class="hs-identifier hs-type">Referenced</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-254"></span><span id="buildInputFieldSchema"><span class="annot"><span class="annottext">buildInputFieldSchema :: forall (m :: * -&gt; *).
MonadFix m =&gt;
GType
-&gt; InputFieldInfo
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#buildInputFieldSchema"><span class="hs-identifier hs-var hs-var">buildInputFieldSchema</span></a></span></span><span> </span><span id="local-6989586621687855051"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687855051"><span class="hs-identifier hs-var">gType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-comment">-- this input field is a scalar: we attempt to declare it</span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#InputFieldScalarInfo"><span class="hs-identifier hs-type">InputFieldScalarInfo</span></a></span><span> </span><span id="local-6989586621687855052"><span class="annot"><span class="annottext">ScalarInfo
</span><a href="#local-6989586621687855052"><span class="hs-identifier hs-var">scalarInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><span class="annottext">DeclareM m (Referenced Schema)
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     (Referenced Schema)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; CircularT (Name, Nullability) (Referenced Schema) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(DeclareM m (Referenced Schema)
 -&gt; CircularT
      (Name, Nullability)
      (Referenced Schema)
      (DeclareM m)
      (Referenced Schema))
-&gt; DeclareM m (Referenced Schema)
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     (Referenced Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GType
-&gt; (Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema))
-&gt; DeclareM m (Referenced Schema)
forall (m :: * -&gt; *).
Monad m =&gt;
GType
-&gt; (Name -&gt; Nullability -&gt; m (Referenced Schema))
-&gt; m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#applyModifiers"><span class="hs-identifier hs-var">applyModifiers</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687855051"><span class="hs-identifier hs-var">gType</span></a></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema))
 -&gt; DeclareM m (Referenced Schema))
-&gt; (Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema))
-&gt; DeclareM m (Referenced Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ScalarInfo -&gt; Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema)
forall (m :: * -&gt; *).
Monad m =&gt;
ScalarInfo -&gt; Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#buildScalarSchema"><span class="hs-identifier hs-var">buildScalarSchema</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarInfo
</span><a href="#local-6989586621687855052"><span class="hs-identifier hs-var">scalarInfo</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-comment">-- this input field is an enum: we declare it</span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#InputFieldEnumInfo"><span class="hs-identifier hs-type">InputFieldEnumInfo</span></a></span><span> </span><span id="local-6989586621687855055"><span class="annot"><span class="annottext">EnumInfo
</span><a href="#local-6989586621687855055"><span class="hs-identifier hs-var">enumInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><span class="annottext">DeclareM m (Referenced Schema)
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     (Referenced Schema)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; CircularT (Name, Nullability) (Referenced Schema) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(DeclareM m (Referenced Schema)
 -&gt; CircularT
      (Name, Nullability)
      (Referenced Schema)
      (DeclareM m)
      (Referenced Schema))
-&gt; DeclareM m (Referenced Schema)
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     (Referenced Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GType
-&gt; (Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema))
-&gt; DeclareM m (Referenced Schema)
forall (m :: * -&gt; *).
Monad m =&gt;
GType
-&gt; (Name -&gt; Nullability -&gt; m (Referenced Schema))
-&gt; m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#applyModifiers"><span class="hs-identifier hs-var">applyModifiers</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687855051"><span class="hs-identifier hs-var">gType</span></a></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema))
 -&gt; DeclareM m (Referenced Schema))
-&gt; (Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema))
-&gt; DeclareM m (Referenced Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EnumInfo -&gt; Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema)
forall (m :: * -&gt; *).
Monad m =&gt;
EnumInfo -&gt; Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#buildEnumSchema"><span class="hs-identifier hs-var">buildEnumSchema</span></a></span><span> </span><span class="annot"><span class="annottext">EnumInfo
</span><a href="#local-6989586621687855055"><span class="hs-identifier hs-var">enumInfo</span></a></span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-comment">-- this input field is an object: we declare it</span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#InputFieldObjectInfo"><span class="hs-identifier hs-type">InputFieldObjectInfo</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#InputObjectInfo"><span class="hs-identifier hs-type">InputObjectInfo</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687855058"><span id="local-6989586621687855059"><span class="annot"><span class="annottext">HashMap Name (GType, InputFieldInfo)
InputObjectTypeDefinition InputValueDefinition
_ioiTypeDefinition :: InputObjectTypeDefinition InputValueDefinition
_ioiFields :: HashMap Name (GType, InputFieldInfo)
_ioiFields :: InputObjectInfo -&gt; HashMap Name (GType, InputFieldInfo)
_ioiTypeDefinition :: InputObjectInfo -&gt; InputObjectTypeDefinition InputValueDefinition
</span><a href="#local-6989586621687855058"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><span class="annottext">GType
-&gt; (Name
    -&gt; Nullability
    -&gt; CircularT
         (Name, Nullability)
         (Referenced Schema)
         (DeclareM m)
         (Referenced Schema))
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     (Referenced Schema)
forall (m :: * -&gt; *).
Monad m =&gt;
GType
-&gt; (Name -&gt; Nullability -&gt; m (Referenced Schema))
-&gt; m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#applyModifiers"><span class="hs-identifier hs-var">applyModifiers</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687855051"><span class="hs-identifier hs-var">gType</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687855062"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855062"><span class="hs-identifier hs-var">typeName</span></a></span></span><span> </span><span id="local-6989586621687855063"><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687855063"><span class="hs-identifier hs-var">nullability</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Name, Nullability)
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     (Referenced Schema)
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     (Referenced Schema)
forall k (m :: * -&gt; *) v.
(Hashable k, MonadFix m) =&gt;
k -&gt; CircularT k v m v -&gt; CircularT k v m v
</span><a href="Control.Monad.Circular.html#withCircular"><span class="hs-identifier hs-var">withCircular</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855062"><span class="hs-identifier hs-var">typeName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687855063"><span class="hs-identifier hs-var">nullability</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-264"></span><span>      </span><span id="local-6989586621687855065"><span class="annot"><a href="#local-6989586621687855065"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="annottext">[(Name, (GType, InputFieldInfo))]
-&gt; ((Name, (GType, InputFieldInfo))
    -&gt; CircularT
         (Name, Nullability)
         (Referenced Schema)
         (DeclareM m)
         (Text, Referenced Schema))
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     [(Text, Referenced Schema)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap Name (GType, InputFieldInfo)
-&gt; [(Name, (GType, InputFieldInfo))]
forall k v. HashMap k v -&gt; [(k, v)]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#toList"><span class="hs-identifier hs-var">HashMap.toList</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Name (GType, InputFieldInfo)
</span><a href="#local-6989586621687855059"><span class="hs-identifier hs-var">_ioiFields</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621687855066"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855066"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621687855067"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687855067"><span class="hs-identifier hs-var">fieldType</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687855068"><span class="annot"><span class="annottext">InputFieldInfo
</span><a href="#local-6989586621687855068"><span class="hs-identifier hs-var">fieldTypeInfo</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-266"></span><span>          </span><span id="local-6989586621687855069"><span class="annot"><a href="#local-6989586621687855069"><span class="hs-identifier hs-var">fieldSchema</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GType
-&gt; InputFieldInfo
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     (Referenced Schema)
forall (m :: * -&gt; *).
MonadFix m =&gt;
GType
-&gt; InputFieldInfo
-&gt; CircularT
     (Name, Nullability)
     (Referenced Schema)
     (DeclareM m)
     (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#buildInputFieldSchema"><span class="hs-identifier hs-var">buildInputFieldSchema</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687855067"><span class="hs-identifier hs-var">fieldType</span></a></span><span> </span><span class="annot"><span class="annottext">InputFieldInfo
</span><a href="#local-6989586621687855068"><span class="hs-identifier hs-var">fieldTypeInfo</span></a></span><span>
</span><span id="line-267"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#unName"><span class="hs-identifier hs-var">G.unName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687855066"><span class="hs-identifier hs-type">fieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621687855069"><span class="hs-identifier hs-type">fieldSchema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687855070"><span class="annot"><a href="#local-6989586621687855070"><span class="hs-identifier hs-var hs-var">objectSchema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-269"></span><span>            </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-270"></span><span>              </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasTitle s a =&gt; Lens' s a
Lens' Schema (Maybe Text)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#title"><span class="hs-identifier hs-var">title</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#unName"><span class="hs-identifier hs-var">G.unName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855062"><span class="hs-identifier hs-var">typeName</span></a></span><span>
</span><span id="line-271"></span><span>              </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasDescription s a =&gt; Lens' s a
Lens' Schema (Maybe Text)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#description"><span class="hs-identifier hs-var">description</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">(Description -&gt; Text) -&gt; Maybe Description -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Description -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#unDescription"><span class="hs-identifier hs-var">G.unDescription</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InputObjectTypeDefinition InputValueDefinition -&gt; Maybe Description
forall inputType.
InputObjectTypeDefinition inputType -&gt; Maybe Description
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#_iotdDescription"><span class="hs-identifier hs-var">G._iotdDescription</span></a></span><span> </span><span class="annot"><span class="annottext">InputObjectTypeDefinition InputValueDefinition
</span><a href="#local-6989586621687855058"><span class="hs-identifier hs-var">_ioiTypeDefinition</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>              </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(InsOrdHashMap Text (Referenced Schema)
 -&gt; Identity (InsOrdHashMap Text (Referenced Schema)))
-&gt; Schema -&gt; Identity Schema
forall s a. HasProperties s a =&gt; Lens' s a
Lens' Schema (InsOrdHashMap Text (Referenced Schema))
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#properties"><span class="hs-identifier hs-var">properties</span></a></span><span> </span><span class="annot"><span class="annottext">((InsOrdHashMap Text (Referenced Schema)
  -&gt; Identity (InsOrdHashMap Text (Referenced Schema)))
 -&gt; Schema -&gt; Identity Schema)
-&gt; InsOrdHashMap Text (Referenced Schema) -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Referenced Schema)]
-&gt; InsOrdHashMap Text (Referenced Schema)
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; InsOrdHashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/insert-ordered-containers-0.2.5.3-dcb71999c8104475fd299533bb40a6c15ee8a9411f3a03b68aa99a14a4143c19/share/doc/html/src/Data.HashMap.Strict.InsOrd.html/Data.HashMap.Strict.InsOrd.html#fromList"><span class="hs-identifier hs-var">InsOrdHashMap.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Text, Referenced Schema)]
</span><a href="#local-6989586621687855065"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-273"></span><span>              </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
-&gt; Schema -&gt; Identity Schema
forall s a. HasType s a =&gt; Lens' s a
Lens' Schema (Maybe OpenApiType)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#type_"><span class="hs-identifier hs-var">type_</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
 -&gt; Schema -&gt; Identity Schema)
-&gt; OpenApiType -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#OpenApiObject"><span class="hs-identifier hs-var">OpenApiObject</span></a></span><span>
</span><span id="line-274"></span><span>              </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Identity (Maybe Bool)) -&gt; Schema -&gt; Identity Schema
forall s a. HasNullable s a =&gt; Lens' s a
Lens' Schema (Maybe Bool)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#nullable"><span class="hs-identifier hs-var">nullable</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Bool -&gt; Identity (Maybe Bool))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Bool -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">Nullability -&gt; Bool
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#unNullability"><span class="hs-identifier hs-var">G.unNullability</span></a></span><span> </span><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687855063"><span class="hs-identifier hs-var">nullability</span></a></span><span>
</span><span id="line-275"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#declareType"><span class="hs-identifier hs-type">declareType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687855062"><span class="hs-identifier hs-type">typeName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687855063"><span class="hs-identifier hs-type">nullability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687855070"><span class="hs-identifier hs-type">objectSchema</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- Response</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="annot"><span class="hs-comment">-- | Given the 'Structure' of a query, generate the corresponding 'Response'.</span></span><span>
</span><span id="line-281"></span><span id="local-6989586621687854270"><span class="annot"><a href="Hasura.Server.OpenAPI.html#buildResponse"><span class="hs-identifier hs-type">buildResponse</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621687854270"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Endpoint.html#EndpointMethod"><span class="hs-identifier hs-type">EndpointMethod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-285"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-286"></span><span>  </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#DeclareM"><span class="hs-identifier hs-type">DeclareM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854270"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Response"><span class="hs-identifier hs-type">Response</span></a></span></span><span>
</span><span id="line-287"></span><span id="buildResponse"><span class="annot"><span class="annottext">buildResponse :: forall (m :: * -&gt; *).
Monad m =&gt;
Structure -&gt; EndpointMethod -&gt; Text -&gt; DeclareM m Response
</span><a href="Hasura.Server.OpenAPI.html#buildResponse"><span class="hs-identifier hs-var hs-var">buildResponse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#Structure"><span class="hs-identifier hs-type">Structure</span></a></span><span> </span><span id="local-6989586621687855105"><span class="annot"><span class="annottext">HashMap Name FieldInfo
</span><a href="#local-6989586621687855105"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="annot"><span class="annottext">HashMap Name VariableInfo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621687855106"><span class="annot"><span class="annottext">EndpointMethod
</span><a href="#local-6989586621687855106"><span class="hs-identifier hs-var">endpointMethod</span></a></span></span><span> </span><span id="local-6989586621687855107"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687855107"><span class="hs-identifier hs-var">endpointURL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-288"></span><span>  </span><span id="local-6989586621687855108"><span class="annot"><a href="#local-6989586621687855108"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Name, FieldInfo)] -&gt; DeclareM m Schema
forall (m :: * -&gt; *).
Monad m =&gt;
[(Name, FieldInfo)] -&gt; DeclareM m Schema
</span><a href="Hasura.Server.OpenAPI.html#buildSelectionSchema"><span class="hs-identifier hs-var">buildSelectionSchema</span></a></span><span> </span><span class="annot"><span class="annottext">([(Name, FieldInfo)] -&gt; DeclareM m Schema)
-&gt; [(Name, FieldInfo)] -&gt; DeclareM m Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap Name FieldInfo -&gt; [(Name, FieldInfo)]
forall k v. HashMap k v -&gt; [(k, v)]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#toList"><span class="hs-identifier hs-var">HashMap.toList</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Name FieldInfo
</span><a href="#local-6989586621687855105"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-289"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-290"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span>
</span><span id="line-291"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#content"><span class="hs-identifier hs-type">content</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-type">.~</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/insert-ordered-containers-0.2.5.3-dcb71999c8104475fd299533bb40a6c15ee8a9411f3a03b68aa99a14a4143c19/share/doc/html/src/Data.HashMap.Strict.InsOrd.html/Data.HashMap.Strict.InsOrd.html#singleton"><span class="hs-identifier hs-type">InsOrdHashMap.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;application&quot;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/http-media-0.8.1.1-3a03975090f09e0666dc26143010e7352a93c76073df688d8d989f5bf00377bb/share/doc/html/src/Network.HTTP.Media.MediaType.html/Network.HTTP.Media.MediaType.html#%2F%2F"><span class="hs-operator hs-type">//</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;json&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#schema"><span class="hs-identifier hs-type">schema</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-type">?~</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-type">Inline</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687855108"><span class="hs-identifier hs-type">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#description"><span class="hs-identifier hs-type">description</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-type">.~</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Responses for &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html/Hasura.Prelude.html#tshow"><span class="hs-identifier hs-type">tshow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687855106"><span class="hs-identifier hs-type">endpointMethod</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621687855107"><span class="hs-identifier hs-type">endpointURL</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="annot"><span class="hs-comment">-- | Given a list of fields and their types, build a corresponding schema.</span></span><span>
</span><span id="line-295"></span><span id="local-6989586621687854401"><span class="annot"><a href="Hasura.Server.OpenAPI.html#buildSelectionSchema"><span class="hs-identifier hs-type">buildSelectionSchema</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621687854401"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#Name"><span class="hs-identifier hs-type">G.Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-298"></span><span>  </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#DeclareM"><span class="hs-identifier hs-type">DeclareM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854401"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span></span><span>
</span><span id="line-299"></span><span id="buildSelectionSchema"><span class="annot"><span class="annottext">buildSelectionSchema :: forall (m :: * -&gt; *).
Monad m =&gt;
[(Name, FieldInfo)] -&gt; DeclareM m Schema
</span><a href="Hasura.Server.OpenAPI.html#buildSelectionSchema"><span class="hs-identifier hs-var hs-var">buildSelectionSchema</span></a></span></span><span> </span><span id="local-6989586621687855127"><span class="annot"><span class="annottext">[(Name, FieldInfo)]
</span><a href="#local-6989586621687855127"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-300"></span><span>  </span><span id="local-6989586621687855128"><span class="annot"><a href="#local-6989586621687855128"><span class="hs-identifier hs-var">props</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Name, FieldInfo)]
-&gt; ((Name, FieldInfo)
    -&gt; DeclareT (Definitions Schema) m (Text, Referenced Schema))
-&gt; DeclareT (Definitions Schema) m [(Text, Referenced Schema)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="annot"><span class="annottext">[(Name, FieldInfo)]
</span><a href="#local-6989586621687855127"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621687855129"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855129"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687855130"><span class="annot"><span class="annottext">FieldInfo
</span><a href="#local-6989586621687855130"><span class="hs-identifier hs-var">fieldInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-301"></span><span>    </span><span id="local-6989586621687855131"><span class="annot"><a href="#local-6989586621687855131"><span class="hs-identifier hs-var">fieldSchema</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FieldInfo -&gt; DeclareM m (Referenced Schema)
forall (m :: * -&gt; *).
Monad m =&gt;
FieldInfo -&gt; DeclareM m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#buildFieldSchema"><span class="hs-identifier hs-var">buildFieldSchema</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfo
</span><a href="#local-6989586621687855130"><span class="hs-identifier hs-var">fieldInfo</span></a></span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#unName"><span class="hs-identifier hs-var">G.unName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687855129"><span class="hs-identifier hs-type">fieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621687855131"><span class="hs-identifier hs-type">fieldSchema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#properties"><span class="hs-identifier hs-type">properties</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-type">.~</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/insert-ordered-containers-0.2.5.3-dcb71999c8104475fd299533bb40a6c15ee8a9411f3a03b68aa99a14a4143c19/share/doc/html/src/Data.HashMap.Strict.InsOrd.html/Data.HashMap.Strict.InsOrd.html#fromList"><span class="hs-identifier hs-type">InsOrdHashMap.fromList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687855128"><span class="hs-identifier hs-type">props</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="annot"><span class="hs-comment">-- | Build the schema for a given output type.</span></span><span>
</span><span id="line-306"></span><span id="local-6989586621687854404"><span class="annot"><a href="Hasura.Server.OpenAPI.html#buildFieldSchema"><span class="hs-identifier hs-type">buildFieldSchema</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621687854404"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#DeclareM"><span class="hs-identifier hs-type">DeclareM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854404"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Referenced"><span class="hs-identifier hs-type">Referenced</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-310"></span><span id="buildFieldSchema"><span class="annot"><span class="annottext">buildFieldSchema :: forall (m :: * -&gt; *).
Monad m =&gt;
FieldInfo -&gt; DeclareM m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#buildFieldSchema"><span class="hs-identifier hs-var hs-var">buildFieldSchema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-comment">-- this output field is a scalar: we attempt to declare it</span><span>
</span><span id="line-312"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#FieldScalarInfo"><span class="hs-identifier hs-type">FieldScalarInfo</span></a></span><span> </span><span id="local-6989586621687855155"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687855155"><span class="hs-identifier hs-var">gType</span></a></span></span><span> </span><span id="local-6989586621687855156"><span class="annot"><span class="annottext">ScalarInfo
</span><a href="#local-6989586621687855156"><span class="hs-identifier hs-var">scalarInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GType
-&gt; (Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema))
-&gt; DeclareM m (Referenced Schema)
forall (m :: * -&gt; *).
Monad m =&gt;
GType
-&gt; (Name -&gt; Nullability -&gt; m (Referenced Schema))
-&gt; m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#applyModifiers"><span class="hs-identifier hs-var">applyModifiers</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687855155"><span class="hs-identifier hs-var">gType</span></a></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema))
 -&gt; DeclareM m (Referenced Schema))
-&gt; (Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema))
-&gt; DeclareM m (Referenced Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ScalarInfo -&gt; Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema)
forall (m :: * -&gt; *).
Monad m =&gt;
ScalarInfo -&gt; Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#buildScalarSchema"><span class="hs-identifier hs-var">buildScalarSchema</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarInfo
</span><a href="#local-6989586621687855156"><span class="hs-identifier hs-var">scalarInfo</span></a></span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-comment">-- this output field is an enum: we declare it</span><span>
</span><span id="line-314"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#FieldEnumInfo"><span class="hs-identifier hs-type">FieldEnumInfo</span></a></span><span> </span><span id="local-6989586621687855158"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687855158"><span class="hs-identifier hs-var">gType</span></a></span></span><span> </span><span id="local-6989586621687855159"><span class="annot"><span class="annottext">EnumInfo
</span><a href="#local-6989586621687855159"><span class="hs-identifier hs-var">scalarInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GType
-&gt; (Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema))
-&gt; DeclareM m (Referenced Schema)
forall (m :: * -&gt; *).
Monad m =&gt;
GType
-&gt; (Name -&gt; Nullability -&gt; m (Referenced Schema))
-&gt; m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#applyModifiers"><span class="hs-identifier hs-var">applyModifiers</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687855158"><span class="hs-identifier hs-var">gType</span></a></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema))
 -&gt; DeclareM m (Referenced Schema))
-&gt; (Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema))
-&gt; DeclareM m (Referenced Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EnumInfo -&gt; Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema)
forall (m :: * -&gt; *).
Monad m =&gt;
EnumInfo -&gt; Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#buildEnumSchema"><span class="hs-identifier hs-var">buildEnumSchema</span></a></span><span> </span><span class="annot"><span class="annottext">EnumInfo
</span><a href="#local-6989586621687855159"><span class="hs-identifier hs-var">scalarInfo</span></a></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-comment">-- this output field is an object: we inline it</span><span>
</span><span id="line-316"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#FieldObjectInfo"><span class="hs-identifier hs-type">FieldObjectInfo</span></a></span><span> </span><span id="local-6989586621687855161"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687855161"><span class="hs-identifier hs-var">gType</span></a></span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#ObjectInfo"><span class="hs-identifier hs-type">ObjectInfo</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687855163"><span id="local-6989586621687855164"><span class="annot"><span class="annottext">HashMap Name FieldInfo
ObjectTypeDefinition InputValueDefinition
_oiTypeDefinition :: ObjectTypeDefinition InputValueDefinition
_oiSelection :: HashMap Name FieldInfo
_oiSelection :: ObjectInfo -&gt; HashMap Name FieldInfo
_oiTypeDefinition :: ObjectInfo -&gt; ObjectTypeDefinition InputValueDefinition
</span><a href="#local-6989586621687855163"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GType
-&gt; (Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema))
-&gt; DeclareM m (Referenced Schema)
forall (m :: * -&gt; *).
Monad m =&gt;
GType
-&gt; (Name -&gt; Nullability -&gt; m (Referenced Schema))
-&gt; m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#applyModifiers"><span class="hs-identifier hs-var">applyModifiers</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687855161"><span class="hs-identifier hs-var">gType</span></a></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema))
 -&gt; DeclareM m (Referenced Schema))
-&gt; (Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema))
-&gt; DeclareM m (Referenced Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687855167"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855167"><span class="hs-identifier hs-var">typeName</span></a></span></span><span> </span><span id="local-6989586621687855168"><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687855168"><span class="hs-identifier hs-var">nullability</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621687855169"><span class="annot"><a href="#local-6989586621687855169"><span class="hs-identifier hs-var">objectSchema</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Name, FieldInfo)] -&gt; DeclareM m Schema
forall (m :: * -&gt; *).
Monad m =&gt;
[(Name, FieldInfo)] -&gt; DeclareM m Schema
</span><a href="Hasura.Server.OpenAPI.html#buildSelectionSchema"><span class="hs-identifier hs-var">buildSelectionSchema</span></a></span><span> </span><span class="annot"><span class="annottext">([(Name, FieldInfo)] -&gt; DeclareM m Schema)
-&gt; [(Name, FieldInfo)] -&gt; DeclareM m Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap Name FieldInfo -&gt; [(Name, FieldInfo)]
forall k v. HashMap k v -&gt; [(k, v)]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#toList"><span class="hs-identifier hs-var">HashMap.toList</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Name FieldInfo
</span><a href="#local-6989586621687855164"><span class="hs-identifier hs-var">_oiSelection</span></a></span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-319"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-type">Inline</span></a></span><span>
</span><span id="line-320"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621687855169"><span class="hs-identifier hs-type">objectSchema</span></a></span><span>
</span><span id="line-321"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#title"><span class="hs-identifier hs-type">title</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-type">?~</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#unName"><span class="hs-identifier hs-var">G.unName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687855167"><span class="hs-identifier hs-type">typeName</span></a></span><span>
</span><span id="line-322"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#description"><span class="hs-identifier hs-type">description</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-type">.~</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#unDescription"><span class="hs-identifier hs-var">G.unDescription</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#_otdDescription"><span class="hs-identifier hs-var">G._otdDescription</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687855163"><span class="hs-identifier hs-type">_oiTypeDefinition</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#type_"><span class="hs-identifier hs-type">type_</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-type">?~</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#OpenApiObject"><span class="hs-identifier hs-type">OpenApiObject</span></a></span><span>
</span><span id="line-324"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#nullable"><span class="hs-identifier hs-type">nullable</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-type">?~</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#unNullability"><span class="hs-identifier hs-var">G.unNullability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687855168"><span class="hs-identifier hs-type">nullability</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- Scalars</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">-- | Craft the OpenAPI 'Schema' for a given scalar. Any non-standard scalar will</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- instead be declared, and returned by reference.</span><span>
</span><span id="line-331"></span><span id="local-6989586621687854386"><span class="annot"><a href="Hasura.Server.OpenAPI.html#buildScalarSchema"><span class="hs-identifier hs-type">buildScalarSchema</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621687854386"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-333"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#ScalarInfo"><span class="hs-identifier hs-type">ScalarInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-334"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#Name"><span class="hs-identifier hs-type">G.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-335"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#Nullability"><span class="hs-identifier hs-type">G.Nullability</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-336"></span><span>  </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#DeclareM"><span class="hs-identifier hs-type">DeclareM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854386"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Referenced"><span class="hs-identifier hs-type">Referenced</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-337"></span><span id="buildScalarSchema"><span class="annot"><span class="annottext">buildScalarSchema :: forall (m :: * -&gt; *).
Monad m =&gt;
ScalarInfo -&gt; Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#buildScalarSchema"><span class="hs-identifier hs-var hs-var">buildScalarSchema</span></a></span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#ScalarInfo"><span class="hs-identifier hs-type">ScalarInfo</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687855192"><span class="annot"><span class="annottext">ScalarTypeDefinition
_siTypeDefinition :: ScalarTypeDefinition
_siTypeDefinition :: ScalarInfo -&gt; ScalarTypeDefinition
</span><a href="#local-6989586621687855192"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621687855194"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855194"><span class="hs-identifier hs-var">scalarName</span></a></span></span><span> </span><span id="local-6989586621687855195"><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687855195"><span class="hs-identifier hs-var">nullability</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe (OpenApiType, Maybe Text, Bool)
</span><a href="Hasura.Server.OpenAPI.html#getReferenceScalarInfo"><span class="hs-identifier hs-var">getReferenceScalarInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855194"><span class="hs-identifier hs-var">scalarName</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-comment">-- there is an existing OpenAPI scalar we can map this to: we inline if we can</span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687855196"><span class="annot"><span class="annottext">OpenApiType
</span><a href="#local-6989586621687855196"><span class="hs-identifier hs-var">refType</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687855197"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621687855197"><span class="hs-identifier hs-var">refPattern</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687855198"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687855198"><span class="hs-identifier hs-var">shouldInline</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-341"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687855199"><span class="annot"><span class="annottext">resultSchema :: Schema
</span><a href="#local-6989586621687855199"><span class="hs-identifier hs-var hs-var">resultSchema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-342"></span><span>            </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621687855200"><span class="hs-identifier hs-var">baseSchema</span></a></span><span>
</span><span id="line-343"></span><span>              </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
-&gt; Schema -&gt; Identity Schema
forall s a. HasType s a =&gt; Lens' s a
Lens' Schema (Maybe OpenApiType)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#type_"><span class="hs-identifier hs-var">type_</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
 -&gt; Schema -&gt; Identity Schema)
-&gt; OpenApiType -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><a href="#local-6989586621687855196"><span class="hs-identifier hs-var">refType</span></a></span><span>
</span><span id="line-344"></span><span>              </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasPattern s a =&gt; Lens' s a
Lens' Schema (Maybe Text)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#pattern"><span class="hs-identifier hs-var">pattern</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621687855197"><span class="hs-identifier hs-var">refPattern</span></a></span><span>
</span><span id="line-345"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687855198"><span class="hs-identifier hs-var">shouldInline</span></a></span><span>
</span><span id="line-346"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Referenced Schema -&gt; DeclareM m (Referenced Schema)
forall a. a -&gt; DeclareT (Definitions Schema) m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Referenced Schema -&gt; DeclareM m (Referenced Schema))
-&gt; Referenced Schema -&gt; DeclareM m (Referenced Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Referenced Schema
forall a. a -&gt; Referenced a
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-var">Inline</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621687855199"><span class="hs-identifier hs-var">resultSchema</span></a></span><span>
</span><span id="line-347"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Nullability -&gt; Schema -&gt; DeclareM m (Referenced Schema)
forall (m :: * -&gt; *).
Monad m =&gt;
Name -&gt; Nullability -&gt; Schema -&gt; DeclareM m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#declareType"><span class="hs-identifier hs-var">declareType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855194"><span class="hs-identifier hs-var">scalarName</span></a></span><span> </span><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687855195"><span class="hs-identifier hs-var">nullability</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621687855199"><span class="hs-identifier hs-var">resultSchema</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-comment">-- there isn't: we declare that type and return a reference to it</span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><span class="annottext">Maybe (OpenApiType, Maybe Text, Bool)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-350"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; Nullability -&gt; Schema -&gt; DeclareM m (Referenced Schema)
forall (m :: * -&gt; *).
Monad m =&gt;
Name -&gt; Nullability -&gt; Schema -&gt; DeclareM m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#declareType"><span class="hs-identifier hs-var">declareType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855194"><span class="hs-identifier hs-var">scalarName</span></a></span><span> </span><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687855195"><span class="hs-identifier hs-var">nullability</span></a></span><span>
</span><span id="line-351"></span><span>        </span><span class="annot"><span class="annottext">(Schema -&gt; DeclareM m (Referenced Schema))
-&gt; Schema -&gt; DeclareM m (Referenced Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621687855200"><span class="hs-identifier hs-var">baseSchema</span></a></span><span>
</span><span id="line-352"></span><span>        </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasDescription s a =&gt; Lens' s a
Lens' Schema (Maybe Text)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#description"><span class="hs-identifier hs-var">description</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">(Description -&gt; Text) -&gt; Maybe Description -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Description -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#unDescription"><span class="hs-identifier hs-var">G.unDescription</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScalarTypeDefinition -&gt; Maybe Description
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#_stdDescription"><span class="hs-identifier hs-var">G._stdDescription</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarTypeDefinition
</span><a href="#local-6989586621687855192"><span class="hs-identifier hs-var">_siTypeDefinition</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-354"></span><span>    </span><span id="local-6989586621687855200"><span class="annot"><span class="annottext">baseSchema :: Schema
</span><a href="#local-6989586621687855200"><span class="hs-identifier hs-var hs-var">baseSchema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-355"></span><span>      </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasTitle s a =&gt; Lens' s a
Lens' Schema (Maybe Text)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#title"><span class="hs-identifier hs-var">title</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#unName"><span class="hs-identifier hs-var">G.unName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855194"><span class="hs-identifier hs-var">scalarName</span></a></span><span>
</span><span id="line-357"></span><span>        </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Identity (Maybe Bool)) -&gt; Schema -&gt; Identity Schema
forall s a. HasNullable s a =&gt; Lens' s a
Lens' Schema (Maybe Bool)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#nullable"><span class="hs-identifier hs-var">nullable</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Bool -&gt; Identity (Maybe Bool))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Bool -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">Nullability -&gt; Bool
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#unNullability"><span class="hs-identifier hs-var">G.unNullability</span></a></span><span> </span><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687855195"><span class="hs-identifier hs-var">nullability</span></a></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="hs-comment">-- | Retrieve info associated with a given scalar, if it can be mapped to a</span><span>
</span><span id="line-360"></span><span class="hs-comment">-- built-in OpenAPI scalar. On a match, we return a tuple indiciating which</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- scalar should be used, a pattern, and a boolean indicating whether this type</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- should be inlined.</span><span>
</span><span id="line-363"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#getReferenceScalarInfo"><span class="hs-identifier hs-type">getReferenceScalarInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#Name"><span class="hs-identifier hs-type">G.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#OpenApiType"><span class="hs-identifier hs-type">OpenApiType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span id="getReferenceScalarInfo"><span class="annot"><span class="annottext">getReferenceScalarInfo :: Name -&gt; Maybe (OpenApiType, Maybe Text, Bool)
</span><a href="Hasura.Server.OpenAPI.html#getReferenceScalarInfo"><span class="hs-identifier hs-var hs-var">getReferenceScalarInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-365"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#unName"><span class="hs-identifier hs-var">G.unName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Text)
-&gt; (Text -&gt; Maybe (OpenApiType, Maybe Text, Bool))
-&gt; Name
-&gt; Maybe (OpenApiType, Maybe Text, Bool)
forall {k} (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k) (c :: k).
Category cat =&gt;
cat a b -&gt; cat b c -&gt; cat a c
</span><span class="hs-operator hs-var">&gt;&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text)
-&gt; (Text -&gt; Maybe (OpenApiType, Maybe Text, Bool))
-&gt; Text
-&gt; Maybe (OpenApiType, Maybe Text, Bool)
forall {k} (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k) (c :: k).
Category cat =&gt;
cat a b -&gt; cat b c -&gt; cat a c
</span><span class="hs-operator hs-var">&gt;&gt;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;int&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(OpenApiType, Maybe Text, Bool)
-&gt; Maybe (OpenApiType, Maybe Text, Bool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#OpenApiInteger"><span class="hs-identifier hs-var">OpenApiInteger</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;float&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(OpenApiType, Maybe Text, Bool)
-&gt; Maybe (OpenApiType, Maybe Text, Bool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#OpenApiNumber"><span class="hs-identifier hs-var">OpenApiNumber</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;double&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(OpenApiType, Maybe Text, Bool)
-&gt; Maybe (OpenApiType, Maybe Text, Bool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#OpenApiNumber"><span class="hs-identifier hs-var">OpenApiNumber</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;uuid&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(OpenApiType, Maybe Text, Bool)
-&gt; Maybe (OpenApiType, Maybe Text, Bool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#OpenApiString"><span class="hs-identifier hs-var">OpenApiString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;[a-f0-9]{8}-[a-f0-9]{4}-4[a-f0-9]{3}-[89aAbB][a-f0-9]{3}-[a-f0-9]{12}&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;bool&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(OpenApiType, Maybe Text, Bool)
-&gt; Maybe (OpenApiType, Maybe Text, Bool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#OpenApiBoolean"><span class="hs-identifier hs-var">OpenApiBoolean</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;boolean&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(OpenApiType, Maybe Text, Bool)
-&gt; Maybe (OpenApiType, Maybe Text, Bool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#OpenApiBoolean"><span class="hs-identifier hs-var">OpenApiBoolean</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;string&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(OpenApiType, Maybe Text, Bool)
-&gt; Maybe (OpenApiType, Maybe Text, Bool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#OpenApiString"><span class="hs-identifier hs-var">OpenApiString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;id&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(OpenApiType, Maybe Text, Bool)
-&gt; Maybe (OpenApiType, Maybe Text, Bool)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpenApiType
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#OpenApiString"><span class="hs-identifier hs-var">OpenApiString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (OpenApiType, Maybe Text, Bool)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- Enums</span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="annot"><span class="hs-comment">-- | Craft the OpenAPI 'Schema' for a given enum.</span></span><span>
</span><span id="line-380"></span><span id="local-6989586621687854387"><span class="annot"><a href="Hasura.Server.OpenAPI.html#buildEnumSchema"><span class="hs-identifier hs-type">buildEnumSchema</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621687854387"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-382"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#EnumInfo"><span class="hs-identifier hs-type">EnumInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-383"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#Name"><span class="hs-identifier hs-type">G.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-384"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#Nullability"><span class="hs-identifier hs-type">G.Nullability</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-385"></span><span>  </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#DeclareM"><span class="hs-identifier hs-type">DeclareM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854387"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Referenced"><span class="hs-identifier hs-type">Referenced</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-386"></span><span id="buildEnumSchema"><span class="annot"><span class="annottext">buildEnumSchema :: forall (m :: * -&gt; *).
Monad m =&gt;
EnumInfo -&gt; Name -&gt; Nullability -&gt; DeclareM m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#buildEnumSchema"><span class="hs-identifier hs-var hs-var">buildEnumSchema</span></a></span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Analyse.html#EnumInfo"><span class="hs-identifier hs-type">EnumInfo</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687855224"><span class="annot"><span class="annottext">EnumTypeDefinition
_eiTypeDefinition :: EnumTypeDefinition
_eiTypeDefinition :: EnumInfo -&gt; EnumTypeDefinition
</span><a href="#local-6989586621687855224"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621687855226"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855226"><span class="hs-identifier hs-var">enumName</span></a></span></span><span> </span><span id="local-6989586621687855227"><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687855227"><span class="hs-identifier hs-var">nullability</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-387"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; Nullability -&gt; Schema -&gt; DeclareM m (Referenced Schema)
forall (m :: * -&gt; *).
Monad m =&gt;
Name -&gt; Nullability -&gt; Schema -&gt; DeclareM m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#declareType"><span class="hs-identifier hs-var">declareType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855226"><span class="hs-identifier hs-var">enumName</span></a></span><span> </span><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687855227"><span class="hs-identifier hs-var">nullability</span></a></span><span>
</span><span id="line-388"></span><span>    </span><span class="annot"><span class="annottext">(Schema -&gt; DeclareM m (Referenced Schema))
-&gt; Schema -&gt; DeclareM m (Referenced Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-389"></span><span>    </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasTitle s a =&gt; Lens' s a
Lens' Schema (Maybe Text)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#title"><span class="hs-identifier hs-var">title</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#unName"><span class="hs-identifier hs-var">G.unName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855226"><span class="hs-identifier hs-var">enumName</span></a></span><span>
</span><span id="line-390"></span><span>    </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe [Value] -&gt; Identity (Maybe [Value]))
-&gt; Schema -&gt; Identity Schema
forall s a. HasEnum s a =&gt; Lens' s a
Lens' Schema (Maybe [Value])
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#enum_"><span class="hs-identifier hs-var">enum_</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe [Value] -&gt; Identity (Maybe [Value]))
 -&gt; Schema -&gt; Identity Schema)
-&gt; [Value] -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621687855229"><span class="hs-identifier hs-var">enumValues</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Identity (Maybe Bool)) -&gt; Schema -&gt; Identity Schema
forall s a. HasNullable s a =&gt; Lens' s a
Lens' Schema (Maybe Bool)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#nullable"><span class="hs-identifier hs-var">nullable</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Bool -&gt; Identity (Maybe Bool))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Bool -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">Nullability -&gt; Bool
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#unNullability"><span class="hs-identifier hs-var">G.unNullability</span></a></span><span> </span><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687855227"><span class="hs-identifier hs-var">nullability</span></a></span><span>
</span><span id="line-392"></span><span>    </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Schema -&gt; Identity Schema
forall s a. HasDescription s a =&gt; Lens' s a
Lens' Schema (Maybe Text)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#description"><span class="hs-identifier hs-var">description</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Schema -&gt; Identity Schema)
-&gt; Maybe Text -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">(Description -&gt; Text) -&gt; Maybe Description -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Description -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#unDescription"><span class="hs-identifier hs-var">G.unDescription</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EnumTypeDefinition -&gt; Maybe Description
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#_etdDescription"><span class="hs-identifier hs-var">G._etdDescription</span></a></span><span> </span><span class="annot"><span class="annottext">EnumTypeDefinition
</span><a href="#local-6989586621687855224"><span class="hs-identifier hs-var">_eiTypeDefinition</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-394"></span><span>    </span><span class="annot"><a href="#local-6989586621687855229"><span class="hs-identifier hs-type">enumValues</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">J.Value</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-395"></span><span>    </span><span id="local-6989586621687855229"><span class="annot"><span class="annottext">enumValues :: [Value]
</span><a href="#local-6989586621687855229"><span class="hs-identifier hs-var hs-var">enumValues</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-396"></span><span>      </span><span class="annot"><span class="annottext">EnumTypeDefinition -&gt; [EnumValueDefinition]
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#_etdValueDefinitions"><span class="hs-identifier hs-var">G._etdValueDefinitions</span></a></span><span> </span><span class="annot"><span class="annottext">EnumTypeDefinition
</span><a href="#local-6989586621687855224"><span class="hs-identifier hs-var">_eiTypeDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">[EnumValueDefinition] -&gt; (EnumValueDefinition -&gt; Value) -&gt; [Value]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#EnumValueDefinition"><span class="hs-identifier hs-type">G.EnumValueDefinition</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687855234"><span id="local-6989586621687855235"><span id="local-6989586621687855236"><span class="annot"><span class="annottext">[Directive Void]
Maybe Description
EnumValue
_evdDescription :: Maybe Description
_evdName :: EnumValue
_evdDirectives :: [Directive Void]
_evdDirectives :: EnumValueDefinition -&gt; [Directive Void]
_evdName :: EnumValueDefinition -&gt; EnumValue
_evdDescription :: EnumValueDefinition -&gt; Maybe Description
</span><a href="#local-6989586621687855234"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-397"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#String"><span class="hs-identifier hs-var">J.String</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Value) -&gt; Text -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#unName"><span class="hs-identifier hs-var">G.unName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Text) -&gt; Name -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EnumValue -&gt; Name
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#unEnumValue"><span class="hs-identifier hs-var">G.unEnumValue</span></a></span><span> </span><span class="annot"><span class="annottext">EnumValue
</span><a href="#local-6989586621687855235"><span class="hs-identifier hs-var">_evdName</span></a></span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- Declaring GraphQL types</span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="hs-comment">-- | Given an annotated GraphQL type (such as @[[Foo!]]!@ and a callback</span><span>
</span><span id="line-403"></span><span class="hs-comment">-- function to be used on the actual underlying type, construct a 'Schema' by</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- recursively applying modifiers.</span><span>
</span><span id="line-405"></span><span id="local-6989586621687854385"><span class="annot"><a href="Hasura.Server.OpenAPI.html#applyModifiers"><span class="hs-identifier hs-type">applyModifiers</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621687854385"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-407"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#GType"><span class="hs-identifier hs-type">G.GType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#Name"><span class="hs-identifier hs-type">G.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#Nullability"><span class="hs-identifier hs-type">G.Nullability</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621687854385"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Referenced"><span class="hs-identifier hs-type">Referenced</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-409"></span><span>  </span><span class="annot"><a href="#local-6989586621687854385"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Referenced"><span class="hs-identifier hs-type">Referenced</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-410"></span><span id="applyModifiers"><span class="annot"><span class="annottext">applyModifiers :: forall (m :: * -&gt; *).
Monad m =&gt;
GType
-&gt; (Name -&gt; Nullability -&gt; m (Referenced Schema))
-&gt; m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#applyModifiers"><span class="hs-identifier hs-var hs-var">applyModifiers</span></a></span></span><span> </span><span id="local-6989586621687855255"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687855255"><span class="hs-identifier hs-var">gtype</span></a></span></span><span> </span><span id="local-6989586621687855256"><span class="annot"><span class="annottext">Name -&gt; Nullability -&gt; m (Referenced Schema)
</span><a href="#local-6989586621687855256"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687855255"><span class="hs-identifier hs-var">gtype</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-411"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#TypeNamed"><span class="hs-identifier hs-type">G.TypeNamed</span></a></span><span> </span><span id="local-6989586621687855257"><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687855257"><span class="hs-identifier hs-var">nullability</span></a></span></span><span> </span><span id="local-6989586621687855258"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855258"><span class="hs-identifier hs-var">typeName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Nullability -&gt; m (Referenced Schema)
</span><a href="#local-6989586621687855256"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855258"><span class="hs-identifier hs-var">typeName</span></a></span><span> </span><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687855257"><span class="hs-identifier hs-var">nullability</span></a></span><span>
</span><span id="line-412"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#TypeList"><span class="hs-identifier hs-type">G.TypeList</span></a></span><span> </span><span id="local-6989586621687855259"><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687855259"><span class="hs-identifier hs-var">nullability</span></a></span></span><span> </span><span id="local-6989586621687855260"><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687855260"><span class="hs-identifier hs-var">innerType</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-413"></span><span>    </span><span id="local-6989586621687855261"><span class="annot"><a href="#local-6989586621687855261"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GType
-&gt; (Name -&gt; Nullability -&gt; m (Referenced Schema))
-&gt; m (Referenced Schema)
forall (m :: * -&gt; *).
Monad m =&gt;
GType
-&gt; (Name -&gt; Nullability -&gt; m (Referenced Schema))
-&gt; m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#applyModifiers"><span class="hs-identifier hs-var">applyModifiers</span></a></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621687855260"><span class="hs-identifier hs-var">innerType</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Nullability -&gt; m (Referenced Schema)
</span><a href="#local-6989586621687855256"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-414"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-415"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-type">Inline</span></a></span><span>
</span><span id="line-416"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span>
</span><span id="line-417"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#nullable"><span class="hs-identifier hs-type">nullable</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-type">?~</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#unNullability"><span class="hs-identifier hs-var">G.unNullability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687855259"><span class="hs-identifier hs-type">nullability</span></a></span><span>
</span><span id="line-418"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#type_"><span class="hs-identifier hs-type">type_</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-type">?~</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#OpenApiArray"><span class="hs-identifier hs-type">OpenApiArray</span></a></span><span>
</span><span id="line-419"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#items"><span class="hs-identifier hs-type">items</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-type">?~</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#OpenApiItemsObject"><span class="hs-identifier hs-type">OpenApiItemsObject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687855261"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span class="annot"><span class="hs-comment">-- | Adds a declaration for the given type, returns a schema that references it.</span></span><span>
</span><span id="line-422"></span><span id="local-6989586621687854399"><span class="annot"><a href="Hasura.Server.OpenAPI.html#declareType"><span class="hs-identifier hs-type">declareType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621687854399"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#Name"><span class="hs-identifier hs-type">G.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#Nullability"><span class="hs-identifier hs-type">G.Nullability</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.OpenAPI.html#DeclareM"><span class="hs-identifier hs-type">DeclareM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687854399"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Referenced"><span class="hs-identifier hs-type">Referenced</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-423"></span><span id="declareType"><span class="annot"><span class="annottext">declareType :: forall (m :: * -&gt; *).
Monad m =&gt;
Name -&gt; Nullability -&gt; Schema -&gt; DeclareM m (Referenced Schema)
</span><a href="Hasura.Server.OpenAPI.html#declareType"><span class="hs-identifier hs-var hs-var">declareType</span></a></span></span><span> </span><span id="local-6989586621687855273"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855273"><span class="hs-identifier hs-var">typeName</span></a></span></span><span> </span><span id="local-6989586621687855274"><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687855274"><span class="hs-identifier hs-var">nullability</span></a></span></span><span> </span><span id="local-6989586621687855275"><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621687855275"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687855276"><span class="annot"><span class="annottext">refName :: Text
</span><a href="#local-6989586621687855276"><span class="hs-identifier hs-var hs-var hs-var">refName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Nullability -&gt; Text
</span><a href="Hasura.Server.OpenAPI.html#mkReferenceName"><span class="hs-identifier hs-var">mkReferenceName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687855273"><span class="hs-identifier hs-var">typeName</span></a></span><span> </span><span class="annot"><span class="annottext">Nullability
</span><a href="#local-6989586621687855274"><span class="hs-identifier hs-var">nullability</span></a></span><span>
</span><span id="line-425"></span><span>  </span><span class="annot"><span class="annottext">Definitions Schema -&gt; DeclareT (Definitions Schema) m ()
forall d (m :: * -&gt; *). MonadDeclare d m =&gt; d -&gt; m ()
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Declare.html/Data.OpenApi.Declare.html#declare"><span class="hs-identifier hs-var">declare</span></a></span><span> </span><span class="annot"><span class="annottext">(Definitions Schema -&gt; DeclareT (Definitions Schema) m ())
-&gt; Definitions Schema -&gt; DeclareT (Definitions Schema) m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Schema -&gt; Definitions Schema
forall k v. Hashable k =&gt; k -&gt; v -&gt; InsOrdHashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/insert-ordered-containers-0.2.5.3-dcb71999c8104475fd299533bb40a6c15ee8a9411f3a03b68aa99a14a4143c19/share/doc/html/src/Data.HashMap.Strict.InsOrd.html/Data.HashMap.Strict.InsOrd.html#singleton"><span class="hs-identifier hs-var">InsOrdHashMap.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687855276"><span class="hs-identifier hs-var">refName</span></a></span><span> </span><span class="annot"><span class="annottext">Schema
</span><a href="#local-6989586621687855275"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-426"></span><span>  </span><span class="annot"><span class="annottext">Referenced Schema
-&gt; DeclareT (Definitions Schema) m (Referenced Schema)
forall a. a -&gt; DeclareT (Definitions Schema) m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Referenced Schema
 -&gt; DeclareT (Definitions Schema) m (Referenced Schema))
-&gt; Referenced Schema
-&gt; DeclareT (Definitions Schema) m (Referenced Schema)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Reference -&gt; Referenced Schema
forall a. Reference -&gt; Referenced a
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Ref"><span class="hs-identifier hs-var">Ref</span></a></span><span> </span><span class="annot"><span class="annottext">(Reference -&gt; Referenced Schema) -&gt; Reference -&gt; Referenced Schema
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Reference
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Reference"><span class="hs-identifier hs-var">Reference</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687855276"><span class="hs-identifier hs-var">refName</span></a></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="hs-comment">-- | Crafts a reference name for a given type.</span><span>
</span><span id="line-429"></span><span class="hs-comment">--</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- We use the fact that JSON references allow characters that GraphQL types</span><span>
</span><span id="line-431"></span><span class="hs-comment">-- don't: we make a different reference for non-nullable type by using the</span><span>
</span><span id="line-432"></span><span class="hs-comment">-- GraphQL convention of suffixing the name by @!@.</span><span>
</span><span id="line-433"></span><span class="hs-comment">--</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- See Note [Nullable types in OpenAPI].</span><span>
</span><span id="line-435"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#mkReferenceName"><span class="hs-identifier hs-type">mkReferenceName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#Name"><span class="hs-identifier hs-type">G.Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#Nullability"><span class="hs-identifier hs-type">G.Nullability</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-436"></span><span id="mkReferenceName"><span class="annot"><span class="annottext">mkReferenceName :: Name -&gt; Nullability -&gt; Text
</span><a href="Hasura.Server.OpenAPI.html#mkReferenceName"><span class="hs-identifier hs-var hs-var">mkReferenceName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html/Language.GraphQL.Draft.Syntax.Name.html#unName"><span class="hs-identifier hs-var">G.unName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621687855279"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687855279"><span class="hs-identifier hs-var">typeName</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#Nullability"><span class="hs-identifier hs-type">G.Nullability</span></a></span><span> </span><span id="local-6989586621687855281"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687855281"><span class="hs-identifier hs-var">isNullable</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687855281"><span class="hs-identifier hs-var">isNullable</span></a></span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687855279"><span class="hs-identifier hs-var">typeName</span></a></span><span>
</span><span id="line-439"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687855279"><span class="hs-identifier hs-var">typeName</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;!&quot;</span></span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- Local helpers</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="hs-keyword">type</span><span> </span><span id="DeclareM"><span class="annot"><a href="Hasura.Server.OpenAPI.html#DeclareM"><span class="hs-identifier hs-var">DeclareM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Declare.html/Data.OpenApi.Declare.html#DeclareT"><span class="hs-identifier hs-type">DeclareT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Definitions"><span class="hs-identifier hs-type">Definitions</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Schema"><span class="hs-identifier hs-type">Schema</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span class="annot"><span class="hs-comment">-- | Variable definition for x-hasura-admin-secret</span></span><span>
</span><span id="line-447"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#xHasuraAdminSecret"><span class="hs-identifier hs-type">xHasuraAdminSecret</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span>
</span><span id="line-448"></span><span id="xHasuraAdminSecret"><span class="annot"><span class="annottext">xHasuraAdminSecret :: Param
</span><a href="Hasura.Server.OpenAPI.html#xHasuraAdminSecret"><span class="hs-identifier hs-var hs-var">xHasuraAdminSecret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-449"></span><span>  </span><span class="annot"><span class="annottext">Param
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-450"></span><span>    </span><span class="annot"><span class="annottext">Param -&gt; (Param -&gt; Param) -&gt; Param
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Identity Text) -&gt; Param -&gt; Identity Param
forall s a. HasName s a =&gt; Lens' s a
Lens' Param Text
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#name"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; Identity Text) -&gt; Param -&gt; Identity Param)
-&gt; Text -&gt; Param -&gt; Param
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;x-hasura-admin-secret&quot;</span></span><span>
</span><span id="line-451"></span><span>    </span><span class="annot"><span class="annottext">Param -&gt; (Param -&gt; Param) -&gt; Param
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text)) -&gt; Param -&gt; Identity Param
forall s a. HasDescription s a =&gt; Lens' s a
Lens' Param (Maybe Text)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#description"><span class="hs-identifier hs-var">description</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text)) -&gt; Param -&gt; Identity Param)
-&gt; Text -&gt; Param -&gt; Param
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Your x-hasura-admin-secret will be used for authentication of the API request.&quot;</span></span><span>
</span><span id="line-452"></span><span>    </span><span class="annot"><span class="annottext">Param -&gt; (Param -&gt; Param) -&gt; Param
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(ParamLocation -&gt; Identity ParamLocation)
-&gt; Param -&gt; Identity Param
forall s a. HasIn s a =&gt; Lens' s a
Lens' Param ParamLocation
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#in_"><span class="hs-identifier hs-var">in_</span></a></span><span> </span><span class="annot"><span class="annottext">((ParamLocation -&gt; Identity ParamLocation)
 -&gt; Param -&gt; Identity Param)
-&gt; ParamLocation -&gt; Param -&gt; Param
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">ParamLocation
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#ParamHeader"><span class="hs-identifier hs-var">ParamHeader</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><span class="annottext">Param -&gt; (Param -&gt; Param) -&gt; Param
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Referenced Schema) -&gt; Identity (Maybe (Referenced Schema)))
-&gt; Param -&gt; Identity Param
forall s a. HasSchema s a =&gt; Lens' s a
Lens' Param (Maybe (Referenced Schema))
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#schema"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe (Referenced Schema)
  -&gt; Identity (Maybe (Referenced Schema)))
 -&gt; Param -&gt; Identity Param)
-&gt; Referenced Schema -&gt; Param -&gt; Param
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; Referenced Schema
forall a. a -&gt; Referenced a
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#Inline"><span class="hs-identifier hs-var">Inline</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Schema
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Schema -&gt; (Schema -&gt; Schema) -&gt; Schema
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
-&gt; Schema -&gt; Identity Schema
forall s a. HasType s a =&gt; Lens' s a
Lens' Schema (Maybe OpenApiType)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Lens.html/Data.OpenApi.Lens.html#type_"><span class="hs-identifier hs-var">type_</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe OpenApiType -&gt; Identity (Maybe OpenApiType))
 -&gt; Schema -&gt; Identity Schema)
-&gt; OpenApiType -&gt; Schema -&gt; Schema
forall s t a b. ASetter s t a (Maybe b) -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/lens-5.3.2-7ec14d641784087c1f1350eada3cde7884c62d1ab2707daec993ceeca3096d32/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%3F~"><span class="hs-operator hs-var">?~</span></a></span><span> </span><span class="annot"><span class="annottext">OpenApiType
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/openapi3-3.2.4-9ec23b5655de60d9625179cc6a7bd8735dc95a143017717fee4dcaa16e09d711/share/doc/html/src/Data.OpenApi.Internal.html/Data.OpenApi.Internal.html#OpenApiString"><span class="hs-identifier hs-var">OpenApiString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="hs-comment">-- | Convert a GraphQL value to an equivalent JSON representation.</span><span>
</span><span id="line-456"></span><span class="hs-comment">--</span><span>
</span><span id="line-457"></span><span class="hs-comment">-- TODO: can we deduplicate this?</span><span>
</span><span id="line-458"></span><span class="annot"><a href="Hasura.Server.OpenAPI.html#gqlToJsonValue"><span class="hs-identifier hs-type">gqlToJsonValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#Value"><span class="hs-identifier hs-type">G.Value</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">J.Value</span></a></span><span>
</span><span id="line-459"></span><span id="gqlToJsonValue"><span class="annot"><span class="annottext">gqlToJsonValue :: Value Void -&gt; Value
</span><a href="Hasura.Server.OpenAPI.html#gqlToJsonValue"><span class="hs-identifier hs-var hs-var">gqlToJsonValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-460"></span><span>  </span><span class="annot"><span class="annottext">Value Void
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#VNull"><span class="hs-identifier hs-var">G.VNull</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Null"><span class="hs-identifier hs-var">J.Null</span></a></span><span>
</span><span id="line-461"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#VInt"><span class="hs-identifier hs-type">G.VInt</span></a></span><span> </span><span id="local-6989586621687855286"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621687855286"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var">J.toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621687855286"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-462"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#VFloat"><span class="hs-identifier hs-type">G.VFloat</span></a></span><span> </span><span id="local-6989586621687855289"><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621687855289"><span class="hs-identifier hs-var">sci</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Scientific -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var">J.toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621687855289"><span class="hs-identifier hs-var">sci</span></a></span><span>
</span><span id="line-463"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#VString"><span class="hs-identifier hs-type">G.VString</span></a></span><span> </span><span id="local-6989586621687855291"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687855291"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var">J.toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687855291"><span class="hs-identifier hs-var">txt</span></a></span><span>
</span><span id="line-464"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#VBoolean"><span class="hs-identifier hs-type">G.VBoolean</span></a></span><span> </span><span id="local-6989586621687855293"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687855293"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var">J.toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687855293"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-465"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#VEnum"><span class="hs-identifier hs-type">G.VEnum</span></a></span><span> </span><span id="local-6989586621687855295"><span class="annot"><span class="annottext">EnumValue
</span><a href="#local-6989586621687855295"><span class="hs-identifier hs-var">ev</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EnumValue -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var">J.toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">EnumValue
</span><a href="#local-6989586621687855295"><span class="hs-identifier hs-var">ev</span></a></span><span>
</span><span id="line-466"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#VList"><span class="hs-identifier hs-type">G.VList</span></a></span><span> </span><span id="local-6989586621687855297"><span class="annot"><span class="annottext">[Value Void]
</span><a href="#local-6989586621687855297"><span class="hs-identifier hs-var">lst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var">J.toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; [Value] -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Value Void -&gt; Value
</span><a href="Hasura.Server.OpenAPI.html#gqlToJsonValue"><span class="hs-identifier hs-var">gqlToJsonValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Value Void -&gt; Value) -&gt; [Value Void] -&gt; [Value]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Value Void]
</span><a href="#local-6989586621687855297"><span class="hs-identifier hs-var">lst</span></a></span><span>
</span><span id="line-467"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html/Language.GraphQL.Draft.Syntax.html#VObject"><span class="hs-identifier hs-type">G.VObject</span></a></span><span> </span><span id="local-6989586621687855299"><span class="annot"><span class="annottext">HashMap Name (Value Void)
</span><a href="#local-6989586621687855299"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HashMap Name Value -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var">J.toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">(HashMap Name Value -&gt; Value) -&gt; HashMap Name Value -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Value Void -&gt; Value
</span><a href="Hasura.Server.OpenAPI.html#gqlToJsonValue"><span class="hs-identifier hs-var">gqlToJsonValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Value Void -&gt; Value)
-&gt; HashMap Name (Value Void) -&gt; HashMap Name Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap Name (Value Void)
</span><a href="#local-6989586621687855299"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-468"></span></pre></body></html>