<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Hasura.Eventing.ScheduledTrigger</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">graphql-engine-1.0.0: GraphQL API over Postgres</span><ul class="links" id="page-menu"><li id="quick-jump-button"><a href="#">Quick Jump</a></li><li><a href="src/Hasura.Eventing.ScheduledTrigger.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Hasura.Eventing.ScheduledTrigger</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Cron trigger stats logger</a></li><li><a href="#g:2">Scheduled events stats logger</a></li><li><a href="#g:3">Database interactions</a></li><li><a href="#g:4">Export utility functions which are useful to build</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><h1>Scheduled Triggers</h1><p>This module implements the functionality of invoking webhooks during specified
 time events aka scheduled events. The scheduled events are the events generated
 by the graphql-engine using the cron triggers or/and a scheduled event can
 be created by the user at a specified time with the payload, webhook, headers
 and the retry configuration. Scheduled events are modeled using rows in Postgres
 with a <code>timestamp</code> column.</p><p>This module implements scheduling and delivery of scheduled
 events:</p><ol><li value="1">Scheduling a cron event involves creating new cron events. New
 cron events are created based on the cron schedule and the number of
 scheduled events that are already present in the scheduled events buffer.
 The graphql-engine computes the new scheduled events and writes them to
 the database.(Generator)</li><li value="2">Delivering a scheduled event involves reading undelivered scheduled events
 from the database and delivering them to the webhook server. (Processor)</li></ol><p>The rationale behind separating the event scheduling and event delivery
 mechanism into two different threads is that the scheduling and delivering of
 the scheduled events are not directly dependent on each other. The generator
 will almost always try to create scheduled events which are supposed to be
 delivered in the future (timestamp &gt; current_timestamp) and the processor
 will fetch scheduled events of the past (timestamp &lt; current_timestamp). So,
 the set of the scheduled events generated by the generator and the processor
 will never be the same. The point here is that they're not correlated to each
 other. They can be split into different threads for a better performance.</p><h2>Implementation</h2><p>The scheduled triggers eventing is being implemented in the metadata storage.
 All functions that make interaction to storage system are abstracted in
 the @<code><a href="Hasura-Metadata-Class.html#t:MonadMetadataStorage" title="Hasura.Metadata.Class">MonadMetadataStorage</a></code> class.</p><p>During the startup, two threads are started:</p><ol><li value="1"><p>Generator: Fetches the list of scheduled triggers from cache and generates
    the scheduled events.</p><ul><li>Additional events will be generated only if there are fewer than 100
  scheduled events.</li><li><p>The upcoming events timestamp will be generated using:</p><ul><li>cron schedule of the scheduled trigger</li><li>max timestamp of the scheduled events that already exist or
  current_timestamp(when no scheduled events exist)</li><li>The timestamp of the scheduled events is stored with timezone because
  `SELECT NOW()` returns timestamp with timezone, so it's good to
  compare two things of the same type.</li></ul></li></ul><p>This effectively corresponds to doing an INSERT with values containing
specific timestamp.</p></li><li value="2">Processor: Fetches the undelivered cron events and the scheduled events
    from the database and which have timestamp lesser than the
    current timestamp and then process them.</li></ol><p>TODO
 - Consider and document ordering guarantees
   - do we have any in the presence of multiple hasura instances?
 - If we have nothing useful to say about ordering, then consider processing
   events asynchronously, so that a slow webhook doesn't cause everything
   subsequent to be delayed</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:runCronEventsGenerator">runCronEventsGenerator</a> :: (<a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="Hasura-Tracing-Class.html#t:MonadTraceContext" title="Hasura.Tracing.Class">MonadTraceContext</a> m, <a href="Hasura-Metadata-Class.html#t:MonadMetadataStorage" title="Hasura.Metadata.Class">MonadMetadataStorage</a> m) =&gt; <a href="Hasura-Logging.html#t:Logger" title="Hasura.Logging">Logger</a> <a href="Hasura-Logging.html#t:Hasura" title="Hasura.Logging">Hasura</a> -&gt; <a href="Hasura-Eventing-ScheduledTrigger-Types.html#t:FetchedCronTriggerStatsLogger" title="Hasura.Eventing.ScheduledTrigger.Types">FetchedCronTriggerStatsLogger</a> -&gt; <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Prelude.html#t:IO" title="Prelude">IO</a> <a href="Hasura-RQL-Types-SchemaCache.html#t:SchemaCache" title="Hasura.RQL.Types.SchemaCache">SchemaCache</a> -&gt; m void</li><li class="src short"><a href="#v:processScheduledTriggers">processScheduledTriggers</a> :: (<a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="Hasura-Tracing-Class.html#t:MonadTrace" title="Hasura.Tracing.Class">MonadTrace</a> m, <a href="Hasura-Metadata-Class.html#t:MonadMetadataStorage" title="Hasura.Metadata.Class">MonadMetadataStorage</a> m, <a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/list-t-1.0.5.7-a9c088a22c96b528949c3d615f362558ac693f07383e5e281f8eb8cdccb32dfb/share/doc/html/ListT-Prelude.html#t:MonadBaseControl" title="ListT.Prelude">MonadBaseControl</a> <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Prelude.html#t:IO" title="Prelude">IO</a> m) =&gt; <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Prelude.html#t:IO" title="Prelude">IO</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/Data-Environment.html#t:Environment" title="Data.Environment">Environment</a> -&gt; <a href="Hasura-Logging.html#t:Logger" title="Hasura.Logging">Logger</a> <a href="Hasura-Logging.html#t:Hasura" title="Hasura.Logging">Hasura</a> -&gt; <a href="Hasura-Eventing-ScheduledTrigger-Types.html#t:FetchedScheduledEventsStatsLogger" title="Hasura.Eventing.ScheduledTrigger.Types">FetchedScheduledEventsStatsLogger</a> -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/Network-HTTP-Client-Transformable.html#t:Manager" title="Network.HTTP.Client.Transformable">Manager</a> -&gt; <a href="Hasura-Server-Prometheus.html#t:ScheduledTriggerMetrics" title="Hasura.Server.Prometheus">ScheduledTriggerMetrics</a> -&gt; <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Prelude.html#t:IO" title="Prelude">IO</a> <a href="Hasura-RQL-Types-SchemaCache.html#t:SchemaCache" title="Hasura.RQL.Types.SchemaCache">SchemaCache</a> -&gt; <a href="Hasura-Eventing-ScheduledTrigger.html#t:LockedEventsCtx" title="Hasura.Eventing.ScheduledTrigger">LockedEventsCtx</a> -&gt; <a href="Hasura-Server-Types.html#t:TriggersErrorLogLevelStatus" title="Hasura.Server.Types">TriggersErrorLogLevelStatus</a> -&gt; m (<a href="Control-Concurrent-Extended.html#t:Forever" title="Control.Concurrent.Extended">Forever</a> m)</li><li class="src short"><a href="#v:generateScheduleTimes">generateScheduleTimes</a> :: <a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/Data-Aeson-Internal-Prelude.html#t:UTCTime" title="Data.Aeson.Internal.Prelude">UTCTime</a> -&gt; <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/cron-0.7.0-38c0d1e8b57296f929fd8914cc312661566ebfc4cf3fe0eab067e0e68d44beb5/share/doc/html/System-Cron-Types.html#t:CronSchedule" title="System.Cron.Types">CronSchedule</a> -&gt; [<a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/Data-Aeson-Internal-Prelude.html#t:UTCTime" title="Data.Aeson.Internal.Prelude">UTCTime</a>]</li><li class="src short"><span class="keyword">data</span> <a href="#t:CronEventSeed">CronEventSeed</a> = <a href="#v:CronEventSeed">CronEventSeed</a> {<ul class="subs"><li><a href="#v:cesName">cesName</a> :: <a href="Hasura-RQL-Types-EventTrigger.html#t:TriggerName" title="Hasura.RQL.Types.EventTrigger">TriggerName</a></li><li><a href="#v:cesScheduledTime">cesScheduledTime</a> :: <a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/Data-Aeson-Internal-Prelude.html#t:UTCTime" title="Data.Aeson.Internal.Prelude">UTCTime</a></li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:LockedEventsCtx">LockedEventsCtx</a> = <a href="#v:LockedEventsCtx">LockedEventsCtx</a> {<ul class="subs"><li><a href="#v:leCronEvents">leCronEvents</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/GHC-Conc-Sync.html#t:TVar" title="GHC.Conc.Sync">TVar</a> (<a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/containers-0.7-inplace/Data-Set.html#t:Set" title="Data.Set">Set</a> <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:CronEventId" title="Hasura.RQL.Types.ScheduledTrigger">CronEventId</a>)</li><li><a href="#v:leOneOffEvents">leOneOffEvents</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/GHC-Conc-Sync.html#t:TVar" title="GHC.Conc.Sync">TVar</a> (<a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/containers-0.7-inplace/Data-Set.html#t:Set" title="Data.Set">Set</a> <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:OneOffScheduledEventId" title="Hasura.RQL.Types.ScheduledTrigger">OneOffScheduledEventId</a>)</li><li><a href="#v:leEvents">leEvents</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/GHC-Conc-Sync.html#t:TVar" title="GHC.Conc.Sync">TVar</a> (<a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/deferred-folds-0.9.18.6-e04c504505d7ff283d3694beec27890cccc4d771eb49c6f59e7a737441741704/share/doc/html/DeferredFolds-Prelude.html#t:HashMap" title="DeferredFolds.Prelude">HashMap</a> <a href="Hasura-RQL-Types-Common.html#t:SourceName" title="Hasura.RQL.Types.Common">SourceName</a> (<a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/containers-0.7-inplace/Data-Set.html#t:Set" title="Data.Set">Set</a> <a href="Hasura-RQL-Types-Eventing.html#t:EventId" title="Hasura.RQL.Types.Eventing">EventId</a>))</li><li><a href="#v:leActionEvents">leActionEvents</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/GHC-Conc-Sync.html#t:TVar" title="GHC.Conc.Sync">TVar</a> (<a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/containers-0.7-inplace/Data-Set.html#t:Set" title="Data.Set">Set</a> <a href="Hasura-RQL-Types-Action.html#t:LockedActionEventId" title="Hasura.RQL.Types.Action">LockedActionEventId</a>)</li></ul>}</li><li class="src short"><a href="#v:createFetchedCronTriggerStatsLogger">createFetchedCronTriggerStatsLogger</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m =&gt; <a href="Hasura-Logging.html#t:Logger" title="Hasura.Logging">Logger</a> <a href="Hasura-Logging.html#t:Hasura" title="Hasura.Logging">Hasura</a> -&gt; m <a href="Hasura-Eventing-ScheduledTrigger-Types.html#t:FetchedCronTriggerStatsLogger" title="Hasura.Eventing.ScheduledTrigger.Types">FetchedCronTriggerStatsLogger</a></li><li class="src short"><a href="#v:closeFetchedCronTriggersStatsLogger">closeFetchedCronTriggersStatsLogger</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m =&gt; <a href="Hasura-Logging.html#t:Logger" title="Hasura.Logging">Logger</a> <a href="Hasura-Logging.html#t:Hasura" title="Hasura.Logging">Hasura</a> -&gt; <a href="Hasura-Eventing-ScheduledTrigger-Types.html#t:FetchedCronTriggerStatsLogger" title="Hasura.Eventing.ScheduledTrigger.Types">FetchedCronTriggerStatsLogger</a> -&gt; m ()</li><li class="src short"><a href="#v:createFetchedScheduledEventsStatsLogger">createFetchedScheduledEventsStatsLogger</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m =&gt; <a href="Hasura-Logging.html#t:Logger" title="Hasura.Logging">Logger</a> <a href="Hasura-Logging.html#t:Hasura" title="Hasura.Logging">Hasura</a> -&gt; m <a href="Hasura-Eventing-ScheduledTrigger-Types.html#t:FetchedScheduledEventsStatsLogger" title="Hasura.Eventing.ScheduledTrigger.Types">FetchedScheduledEventsStatsLogger</a></li><li class="src short"><a href="#v:closeFetchedScheduledEventsStatsLogger">closeFetchedScheduledEventsStatsLogger</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m =&gt; <a href="Hasura-Logging.html#t:Logger" title="Hasura.Logging">Logger</a> <a href="Hasura-Logging.html#t:Hasura" title="Hasura.Logging">Hasura</a> -&gt; <a href="Hasura-Eventing-ScheduledTrigger-Types.html#t:FetchedScheduledEventsStatsLogger" title="Hasura.Eventing.ScheduledTrigger.Types">FetchedScheduledEventsStatsLogger</a> -&gt; m ()</li><li class="src short"><a href="#v:getDeprivedCronTriggerStatsTx">getDeprivedCronTriggerStatsTx</a> :: [<a href="Hasura-RQL-Types-EventTrigger.html#t:TriggerName" title="Hasura.RQL.Types.EventTrigger">TriggerName</a>] -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> [<a href="Hasura-Eventing-ScheduledTrigger-Types.html#t:CronTriggerStats" title="Hasura.Eventing.ScheduledTrigger.Types">CronTriggerStats</a>]</li><li class="src short"><a href="#v:getScheduledEventsForDeliveryTx">getScheduledEventsForDeliveryTx</a> :: [<a href="Hasura-RQL-Types-EventTrigger.html#t:TriggerName" title="Hasura.RQL.Types.EventTrigger">TriggerName</a>] -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> ([<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:CronEvent" title="Hasura.RQL.Types.ScheduledTrigger">CronEvent</a>], [<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:OneOffScheduledEvent" title="Hasura.RQL.Types.ScheduledTrigger">OneOffScheduledEvent</a>])</li><li class="src short"><a href="#v:insertInvocationTx">insertInvocationTx</a> :: <a href="Hasura-RQL-Types-Eventing.html#t:Invocation" title="Hasura.RQL.Types.Eventing">Invocation</a> '<a href="Hasura-RQL-Types-Eventing.html#v:ScheduledType" title="Hasura.RQL.Types.Eventing">ScheduledType</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventType" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventType</a> -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> ()</li><li class="src short"><a href="#v:setScheduledEventOpTx">setScheduledEventOpTx</a> :: <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventId" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventId</a> -&gt; <a href="Hasura-Eventing-ScheduledTrigger-Types.html#t:ScheduledEventOp" title="Hasura.Eventing.ScheduledTrigger.Types">ScheduledEventOp</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventType" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventType</a> -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> ()</li><li class="src short"><a href="#v:unlockScheduledEventsTx">unlockScheduledEventsTx</a> :: <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventType" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventType</a> -&gt; [<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventId" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventId</a>] -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li class="src short"><a href="#v:unlockAllLockedScheduledEventsTx">unlockAllLockedScheduledEventsTx</a> :: <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> ()</li><li class="src short"><a href="#v:insertCronEventsTx">insertCronEventsTx</a> :: [<a href="Hasura-Eventing-ScheduledTrigger.html#t:CronEventSeed" title="Hasura.Eventing.ScheduledTrigger">CronEventSeed</a>] -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> ()</li><li class="src short"><a href="#v:insertOneOffScheduledEventTx">insertOneOffScheduledEventTx</a> :: <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:OneOffEvent" title="Hasura.RQL.Types.ScheduledTrigger">OneOffEvent</a> -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> <a href="Hasura-RQL-Types-Eventing.html#t:EventId" title="Hasura.RQL.Types.Eventing">EventId</a></li><li class="src short"><a href="#v:dropFutureCronEventsTx">dropFutureCronEventsTx</a> :: <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ClearCronEvents" title="Hasura.RQL.Types.ScheduledTrigger">ClearCronEvents</a> -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> ()</li><li class="src short"><a href="#v:getOneOffScheduledEventsTx">getOneOffScheduledEventsTx</a> :: <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventPagination" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventPagination</a> -&gt; [<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventStatus" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventStatus</a>] -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:RowsCountOption" title="Hasura.RQL.Types.ScheduledTrigger">RowsCountOption</a> -&gt; [<a href="Hasura-Backends-Postgres-SQL-DML.html#t:OrderByItem" title="Hasura.Backends.Postgres.SQL.DML">OrderByItem</a>] -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> (<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:WithOptionalTotalCount" title="Hasura.RQL.Types.ScheduledTrigger">WithOptionalTotalCount</a> [<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:OneOffScheduledEvent" title="Hasura.RQL.Types.ScheduledTrigger">OneOffScheduledEvent</a>])</li><li class="src short"><a href="#v:getCronEventsTx">getCronEventsTx</a> :: <a href="Hasura-RQL-Types-EventTrigger.html#t:TriggerName" title="Hasura.RQL.Types.EventTrigger">TriggerName</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventPagination" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventPagination</a> -&gt; [<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventStatus" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventStatus</a>] -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:RowsCountOption" title="Hasura.RQL.Types.ScheduledTrigger">RowsCountOption</a> -&gt; [<a href="Hasura-Backends-Postgres-SQL-DML.html#t:OrderByItem" title="Hasura.Backends.Postgres.SQL.DML">OrderByItem</a>] -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> (<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:WithOptionalTotalCount" title="Hasura.RQL.Types.ScheduledTrigger">WithOptionalTotalCount</a> [<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:CronEvent" title="Hasura.RQL.Types.ScheduledTrigger">CronEvent</a>])</li><li class="src short"><a href="#v:deleteScheduledEventTx">deleteScheduledEventTx</a> :: <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventId" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventId</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventType" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventType</a> -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> ()</li><li class="src short"><a href="#v:getScheduledEventInvocationsTx">getScheduledEventInvocationsTx</a> :: <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:GetScheduledEventInvocations" title="Hasura.RQL.Types.ScheduledTrigger">GetScheduledEventInvocations</a> -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> (<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:WithOptionalTotalCount" title="Hasura.RQL.Types.ScheduledTrigger">WithOptionalTotalCount</a> [<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventInvocation" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventInvocation</a>])</li><li class="src short"><a href="#v:getScheduledEventsInvocationsQuery">getScheduledEventsInvocationsQuery</a> :: <a href="Hasura-Eventing-ScheduledTrigger.html#t:EventTables" title="Hasura.Eventing.ScheduledTrigger">EventTables</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:GetScheduledEventInvocations" title="Hasura.RQL.Types.ScheduledTrigger">GetScheduledEventInvocations</a> -&gt; <a href="Hasura-Backends-Postgres-SQL-DML.html#t:Select" title="Hasura.Backends.Postgres.SQL.DML">Select</a></li><li class="src short"><a href="#v:getScheduledEventsInvocationsQueryNoPagination">getScheduledEventsInvocationsQueryNoPagination</a> :: <a href="Hasura-Eventing-ScheduledTrigger.html#t:EventTables" title="Hasura.Eventing.ScheduledTrigger">EventTables</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:GetScheduledEventInvocationsBy" title="Hasura.RQL.Types.ScheduledTrigger">GetScheduledEventInvocationsBy</a> -&gt; <a href="Hasura-Backends-Postgres-SQL-DML.html#t:Select" title="Hasura.Backends.Postgres.SQL.DML">Select</a></li><li class="src short"><a href="#v:mkScheduledEventStatusFilter">mkScheduledEventStatusFilter</a> :: [<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventStatus" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventStatus</a>] -&gt; <a href="Hasura-Backends-Postgres-SQL-DML.html#t:BoolExp" title="Hasura.Backends.Postgres.SQL.DML">BoolExp</a></li><li class="src short"><a href="#v:scheduledTimeOrderBy">scheduledTimeOrderBy</a> :: <a href="Hasura-Backends-Postgres-SQL-DML.html#t:OrderByExp" title="Hasura.Backends.Postgres.SQL.DML">OrderByExp</a></li><li class="src short"><a href="#v:executeWithOptionalTotalCount">executeWithOptionalTotalCount</a> :: <a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/Data-Aeson-Types-FromJSON.html#t:FromJSON" title="Data.Aeson.Types.FromJSON">FromJSON</a> a =&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:Query" title="Database.PG.Query.Transaction">Query</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:RowsCountOption" title="Hasura.RQL.Types.ScheduledTrigger">RowsCountOption</a> -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> (<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:WithOptionalTotalCount" title="Hasura.RQL.Types.ScheduledTrigger">WithOptionalTotalCount</a> a)</li><li class="src short"><a href="#v:mkPaginationSelectExp">mkPaginationSelectExp</a> :: <a href="Hasura-Backends-Postgres-SQL-DML.html#t:Select" title="Hasura.Backends.Postgres.SQL.DML">Select</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventPagination" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventPagination</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:RowsCountOption" title="Hasura.RQL.Types.ScheduledTrigger">RowsCountOption</a> -&gt; <a href="Hasura-Backends-Postgres-SQL-DML.html#t:Select" title="Hasura.Backends.Postgres.SQL.DML">Select</a></li><li class="src short"><a href="#v:withCount">withCount</a> :: (<a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Class.html#t:ViaJSON" title="Database.PG.Query.Class">ViaJSON</a> a) -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:WithOptionalTotalCount" title="Hasura.RQL.Types.ScheduledTrigger">WithOptionalTotalCount</a> a</li><li class="src short"><a href="#v:invocationFieldExtractors">invocationFieldExtractors</a> :: <a href="Hasura-Backends-Postgres-SQL-Types.html#t:QualifiedTable" title="Hasura.Backends.Postgres.SQL.Types">QualifiedTable</a> -&gt; [<a href="Hasura-Backends-Postgres-SQL-DML.html#t:Extractor" title="Hasura.Backends.Postgres.SQL.DML">Extractor</a>]</li><li class="src short"><a href="#v:mkEventIdBoolExp">mkEventIdBoolExp</a> :: <a href="Hasura-Backends-Postgres-SQL-Types.html#t:QualifiedTable" title="Hasura.Backends.Postgres.SQL.Types">QualifiedTable</a> -&gt; <a href="Hasura-RQL-Types-Eventing.html#t:EventId" title="Hasura.RQL.Types.Eventing">EventId</a> -&gt; <a href="Hasura-Backends-Postgres-SQL-DML.html#t:BoolExp" title="Hasura.Backends.Postgres.SQL.DML">BoolExp</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:EventTables">EventTables</a> = <a href="#v:EventTables">EventTables</a> {<ul class="subs"><li><a href="#v:etOneOffInvocationsTable">etOneOffInvocationsTable</a> :: <a href="Hasura-Backends-Postgres-SQL-Types.html#t:QualifiedTable" title="Hasura.Backends.Postgres.SQL.Types">QualifiedTable</a></li><li><a href="#v:etCronInvocationsTable">etCronInvocationsTable</a> :: <a href="Hasura-Backends-Postgres-SQL-Types.html#t:QualifiedTable" title="Hasura.Backends.Postgres.SQL.Types">QualifiedTable</a></li><li><a href="#v:etCronEventsTable">etCronEventsTable</a> :: <a href="Hasura-Backends-Postgres-SQL-Types.html#t:QualifiedTable" title="Hasura.Backends.Postgres.SQL.Types">QualifiedTable</a></li></ul>}</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:runCronEventsGenerator" class="def">runCronEventsGenerator</a> :: (<a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="Hasura-Tracing-Class.html#t:MonadTraceContext" title="Hasura.Tracing.Class">MonadTraceContext</a> m, <a href="Hasura-Metadata-Class.html#t:MonadMetadataStorage" title="Hasura.Metadata.Class">MonadMetadataStorage</a> m) =&gt; <a href="Hasura-Logging.html#t:Logger" title="Hasura.Logging">Logger</a> <a href="Hasura-Logging.html#t:Hasura" title="Hasura.Logging">Hasura</a> -&gt; <a href="Hasura-Eventing-ScheduledTrigger-Types.html#t:FetchedCronTriggerStatsLogger" title="Hasura.Eventing.ScheduledTrigger.Types">FetchedCronTriggerStatsLogger</a> -&gt; <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Prelude.html#t:IO" title="Prelude">IO</a> <a href="Hasura-RQL-Types-SchemaCache.html#t:SchemaCache" title="Hasura.RQL.Types.SchemaCache">SchemaCache</a> -&gt; m void <a href="src/Hasura.Eventing.ScheduledTrigger.html#runCronEventsGenerator" class="link">Source</a> <a href="#v:runCronEventsGenerator" class="selflink">#</a></p><div class="doc"><p>runCronEventsGenerator makes sure that all the cron triggers
   have an adequate buffer of cron events.</p></div></div><div class="top"><p class="src"><a id="v:processScheduledTriggers" class="def">processScheduledTriggers</a> :: (<a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m, <a href="Hasura-Tracing-Class.html#t:MonadTrace" title="Hasura.Tracing.Class">MonadTrace</a> m, <a href="Hasura-Metadata-Class.html#t:MonadMetadataStorage" title="Hasura.Metadata.Class">MonadMetadataStorage</a> m, <a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/list-t-1.0.5.7-a9c088a22c96b528949c3d615f362558ac693f07383e5e281f8eb8cdccb32dfb/share/doc/html/ListT-Prelude.html#t:MonadBaseControl" title="ListT.Prelude">MonadBaseControl</a> <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Prelude.html#t:IO" title="Prelude">IO</a> m) =&gt; <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Prelude.html#t:IO" title="Prelude">IO</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/Data-Environment.html#t:Environment" title="Data.Environment">Environment</a> -&gt; <a href="Hasura-Logging.html#t:Logger" title="Hasura.Logging">Logger</a> <a href="Hasura-Logging.html#t:Hasura" title="Hasura.Logging">Hasura</a> -&gt; <a href="Hasura-Eventing-ScheduledTrigger-Types.html#t:FetchedScheduledEventsStatsLogger" title="Hasura.Eventing.ScheduledTrigger.Types">FetchedScheduledEventsStatsLogger</a> -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/Network-HTTP-Client-Transformable.html#t:Manager" title="Network.HTTP.Client.Transformable">Manager</a> -&gt; <a href="Hasura-Server-Prometheus.html#t:ScheduledTriggerMetrics" title="Hasura.Server.Prometheus">ScheduledTriggerMetrics</a> -&gt; <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Prelude.html#t:IO" title="Prelude">IO</a> <a href="Hasura-RQL-Types-SchemaCache.html#t:SchemaCache" title="Hasura.RQL.Types.SchemaCache">SchemaCache</a> -&gt; <a href="Hasura-Eventing-ScheduledTrigger.html#t:LockedEventsCtx" title="Hasura.Eventing.ScheduledTrigger">LockedEventsCtx</a> -&gt; <a href="Hasura-Server-Types.html#t:TriggersErrorLogLevelStatus" title="Hasura.Server.Types">TriggersErrorLogLevelStatus</a> -&gt; m (<a href="Control-Concurrent-Extended.html#t:Forever" title="Control.Concurrent.Extended">Forever</a> m) <a href="src/Hasura.Eventing.ScheduledTrigger.html#processScheduledTriggers" class="link">Source</a> <a href="#v:processScheduledTriggers" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:generateScheduleTimes" class="def">generateScheduleTimes</a> :: <a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/Data-Aeson-Internal-Prelude.html#t:UTCTime" title="Data.Aeson.Internal.Prelude">UTCTime</a> -&gt; <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/cron-0.7.0-38c0d1e8b57296f929fd8914cc312661566ebfc4cf3fe0eab067e0e68d44beb5/share/doc/html/System-Cron-Types.html#t:CronSchedule" title="System.Cron.Types">CronSchedule</a> -&gt; [<a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/Data-Aeson-Internal-Prelude.html#t:UTCTime" title="Data.Aeson.Internal.Prelude">UTCTime</a>] <a href="src/Hasura.Eventing.Common.html#generateScheduleTimes" class="link">Source</a> <a href="#v:generateScheduleTimes" class="selflink">#</a></p><div class="doc"><p>Generates next <code>n events starting </code>from according to <code><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/cron-0.7.0-38c0d1e8b57296f929fd8914cc312661566ebfc4cf3fe0eab067e0e68d44beb5/share/doc/html/System-Cron-Types.html#t:CronSchedule" title="System.Cron.Types">CronSchedule</a></code></p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:CronEventSeed" class="def">CronEventSeed</a> <a href="src/Hasura.RQL.Types.ScheduledTrigger.html#CronEventSeed" class="link">Source</a> <a href="#t:CronEventSeed" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:CronEventSeed" class="def">CronEventSeed</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:cesName" class="def">cesName</a> :: <a href="Hasura-RQL-Types-EventTrigger.html#t:TriggerName" title="Hasura.RQL.Types.EventTrigger">TriggerName</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:cesScheduledTime" class="def">cesScheduledTime</a> :: <a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/Data-Aeson-Internal-Prelude.html#t:UTCTime" title="Data.Aeson.Internal.Prelude">UTCTime</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:CronEventSeed">Instances</h4><details id="i:CronEventSeed" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CronEventSeed:Show:1"></span> <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Prelude.html#t:Show" title="Prelude">Show</a> <a href="Hasura-Eventing-ScheduledTrigger.html#t:CronEventSeed" title="Hasura.Eventing.ScheduledTrigger">CronEventSeed</a></span> <a href="src/Hasura.RQL.Types.ScheduledTrigger.html#line-354" class="link">Source</a> <a href="#t:CronEventSeed" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CronEventSeed:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Hasura-RQL-Types-ScheduledTrigger.html">Hasura.RQL.Types.ScheduledTrigger</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Hasura-Eventing-ScheduledTrigger.html#t:CronEventSeed" title="Hasura.Eventing.ScheduledTrigger">CronEventSeed</a> -&gt; <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Prelude.html#t:ShowS" title="Prelude">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Hasura-Eventing-ScheduledTrigger.html#t:CronEventSeed" title="Hasura.Eventing.ScheduledTrigger">CronEventSeed</a> -&gt; <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Hasura-Eventing-ScheduledTrigger.html#t:CronEventSeed" title="Hasura.Eventing.ScheduledTrigger">CronEventSeed</a>] -&gt; <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Prelude.html#t:ShowS" title="Prelude">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:CronEventSeed:Eq:2"></span> <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Hasura-Eventing-ScheduledTrigger.html#t:CronEventSeed" title="Hasura.Eventing.ScheduledTrigger">CronEventSeed</a></span> <a href="src/Hasura.RQL.Types.ScheduledTrigger.html#line-354" class="link">Source</a> <a href="#t:CronEventSeed" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:CronEventSeed:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Hasura-RQL-Types-ScheduledTrigger.html">Hasura.RQL.Types.ScheduledTrigger</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Hasura-Eventing-ScheduledTrigger.html#t:CronEventSeed" title="Hasura.Eventing.ScheduledTrigger">CronEventSeed</a> -&gt; <a href="Hasura-Eventing-ScheduledTrigger.html#t:CronEventSeed" title="Hasura.Eventing.ScheduledTrigger">CronEventSeed</a> -&gt; <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Hasura-Eventing-ScheduledTrigger.html#t:CronEventSeed" title="Hasura.Eventing.ScheduledTrigger">CronEventSeed</a> -&gt; <a href="Hasura-Eventing-ScheduledTrigger.html#t:CronEventSeed" title="Hasura.Eventing.ScheduledTrigger">CronEventSeed</a> -&gt; <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:LockedEventsCtx" class="def">LockedEventsCtx</a> <a href="src/Hasura.Eventing.Common.html#LockedEventsCtx" class="link">Source</a> <a href="#t:LockedEventsCtx" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:LockedEventsCtx" class="def">LockedEventsCtx</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:leCronEvents" class="def">leCronEvents</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/GHC-Conc-Sync.html#t:TVar" title="GHC.Conc.Sync">TVar</a> (<a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/containers-0.7-inplace/Data-Set.html#t:Set" title="Data.Set">Set</a> <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:CronEventId" title="Hasura.RQL.Types.ScheduledTrigger">CronEventId</a>)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:leOneOffEvents" class="def">leOneOffEvents</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/GHC-Conc-Sync.html#t:TVar" title="GHC.Conc.Sync">TVar</a> (<a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/containers-0.7-inplace/Data-Set.html#t:Set" title="Data.Set">Set</a> <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:OneOffScheduledEventId" title="Hasura.RQL.Types.ScheduledTrigger">OneOffScheduledEventId</a>)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:leEvents" class="def">leEvents</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/GHC-Conc-Sync.html#t:TVar" title="GHC.Conc.Sync">TVar</a> (<a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/deferred-folds-0.9.18.6-e04c504505d7ff283d3694beec27890cccc4d771eb49c6f59e7a737441741704/share/doc/html/DeferredFolds-Prelude.html#t:HashMap" title="DeferredFolds.Prelude">HashMap</a> <a href="Hasura-RQL-Types-Common.html#t:SourceName" title="Hasura.RQL.Types.Common">SourceName</a> (<a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/containers-0.7-inplace/Data-Set.html#t:Set" title="Data.Set">Set</a> <a href="Hasura-RQL-Types-Eventing.html#t:EventId" title="Hasura.RQL.Types.Eventing">EventId</a>))</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:leActionEvents" class="def">leActionEvents</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/GHC-Conc-Sync.html#t:TVar" title="GHC.Conc.Sync">TVar</a> (<a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/containers-0.7-inplace/Data-Set.html#t:Set" title="Data.Set">Set</a> <a href="Hasura-RQL-Types-Action.html#t:LockedActionEventId" title="Hasura.RQL.Types.Action">LockedActionEventId</a>)</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><a href="#g:1" id="g:1"><h1>Cron trigger stats logger</h1></a><div class="top"><p class="src"><a id="v:createFetchedCronTriggerStatsLogger" class="def">createFetchedCronTriggerStatsLogger</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m =&gt; <a href="Hasura-Logging.html#t:Logger" title="Hasura.Logging">Logger</a> <a href="Hasura-Logging.html#t:Hasura" title="Hasura.Logging">Hasura</a> -&gt; m <a href="Hasura-Eventing-ScheduledTrigger-Types.html#t:FetchedCronTriggerStatsLogger" title="Hasura.Eventing.ScheduledTrigger.Types">FetchedCronTriggerStatsLogger</a> <a href="src/Hasura.Eventing.ScheduledTrigger.html#createFetchedCronTriggerStatsLogger" class="link">Source</a> <a href="#v:createFetchedCronTriggerStatsLogger" class="selflink">#</a></p><div class="doc"><p>Logger to accumulate stats of fetched cron triggers, for generating cron events, over a period of time and
 log once using <code>'L.Logger L.Hasura'.
 See </code><code>createStatsLogger</code> for more details.</p></div></div><div class="top"><p class="src"><a id="v:closeFetchedCronTriggersStatsLogger" class="def">closeFetchedCronTriggersStatsLogger</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m =&gt; <a href="Hasura-Logging.html#t:Logger" title="Hasura.Logging">Logger</a> <a href="Hasura-Logging.html#t:Hasura" title="Hasura.Logging">Hasura</a> -&gt; <a href="Hasura-Eventing-ScheduledTrigger-Types.html#t:FetchedCronTriggerStatsLogger" title="Hasura.Eventing.ScheduledTrigger.Types">FetchedCronTriggerStatsLogger</a> -&gt; m () <a href="src/Hasura.Eventing.ScheduledTrigger.html#closeFetchedCronTriggersStatsLogger" class="link">Source</a> <a href="#v:closeFetchedCronTriggersStatsLogger" class="selflink">#</a></p><div class="doc"><p>Close the fetched cron trigger stats logger.</p></div></div><a href="#g:2" id="g:2"><h1>Scheduled events stats logger</h1></a><div class="top"><p class="src"><a id="v:createFetchedScheduledEventsStatsLogger" class="def">createFetchedScheduledEventsStatsLogger</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m =&gt; <a href="Hasura-Logging.html#t:Logger" title="Hasura.Logging">Logger</a> <a href="Hasura-Logging.html#t:Hasura" title="Hasura.Logging">Hasura</a> -&gt; m <a href="Hasura-Eventing-ScheduledTrigger-Types.html#t:FetchedScheduledEventsStatsLogger" title="Hasura.Eventing.ScheduledTrigger.Types">FetchedScheduledEventsStatsLogger</a> <a href="src/Hasura.Eventing.ScheduledTrigger.html#createFetchedScheduledEventsStatsLogger" class="link">Source</a> <a href="#v:createFetchedScheduledEventsStatsLogger" class="selflink">#</a></p><div class="doc"><p>Logger to accumulate stats of fetched scheduled events over a period of time and log once using <code>'L.Logger L.Hasura'.
 See </code><code>createStatsLogger</code> for more details.</p></div></div><div class="top"><p class="src"><a id="v:closeFetchedScheduledEventsStatsLogger" class="def">closeFetchedScheduledEventsStatsLogger</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Control-Monad-IO-Class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m =&gt; <a href="Hasura-Logging.html#t:Logger" title="Hasura.Logging">Logger</a> <a href="Hasura-Logging.html#t:Hasura" title="Hasura.Logging">Hasura</a> -&gt; <a href="Hasura-Eventing-ScheduledTrigger-Types.html#t:FetchedScheduledEventsStatsLogger" title="Hasura.Eventing.ScheduledTrigger.Types">FetchedScheduledEventsStatsLogger</a> -&gt; m () <a href="src/Hasura.Eventing.ScheduledTrigger.html#closeFetchedScheduledEventsStatsLogger" class="link">Source</a> <a href="#v:closeFetchedScheduledEventsStatsLogger" class="selflink">#</a></p><div class="doc"><p>Close the fetched scheduled events stats logger.</p></div></div><a href="#g:3" id="g:3"><h1>Database interactions</h1></a><div class="top"><p class="src"><a id="v:getDeprivedCronTriggerStatsTx" class="def">getDeprivedCronTriggerStatsTx</a> :: [<a href="Hasura-RQL-Types-EventTrigger.html#t:TriggerName" title="Hasura.RQL.Types.EventTrigger">TriggerName</a>] -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> [<a href="Hasura-Eventing-ScheduledTrigger-Types.html#t:CronTriggerStats" title="Hasura.Eventing.ScheduledTrigger.Types">CronTriggerStats</a>] <a href="src/Hasura.Eventing.ScheduledTrigger.html#getDeprivedCronTriggerStatsTx" class="link">Source</a> <a href="#v:getDeprivedCronTriggerStatsTx" class="selflink">#</a></p><div class="doc"><p>Get cron trigger stats for cron jobs with fewer than 100 future reified
 events in the database</p><p>The point here is to maintain a certain number of future events so the user
 can kind of see what's coming up, and obviously to give <code>processCronEvents</code>
 something to do.</p></div></div><div class="top"><p class="src"><a id="v:getScheduledEventsForDeliveryTx" class="def">getScheduledEventsForDeliveryTx</a> :: [<a href="Hasura-RQL-Types-EventTrigger.html#t:TriggerName" title="Hasura.RQL.Types.EventTrigger">TriggerName</a>] -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> ([<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:CronEvent" title="Hasura.RQL.Types.ScheduledTrigger">CronEvent</a>], [<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:OneOffScheduledEvent" title="Hasura.RQL.Types.ScheduledTrigger">OneOffScheduledEvent</a>]) <a href="src/Hasura.Eventing.ScheduledTrigger.html#getScheduledEventsForDeliveryTx" class="link">Source</a> <a href="#v:getScheduledEventsForDeliveryTx" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:insertInvocationTx" class="def">insertInvocationTx</a> :: <a href="Hasura-RQL-Types-Eventing.html#t:Invocation" title="Hasura.RQL.Types.Eventing">Invocation</a> '<a href="Hasura-RQL-Types-Eventing.html#v:ScheduledType" title="Hasura.RQL.Types.Eventing">ScheduledType</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventType" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventType</a> -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> () <a href="src/Hasura.Eventing.ScheduledTrigger.html#insertInvocationTx" class="link">Source</a> <a href="#v:insertInvocationTx" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:setScheduledEventOpTx" class="def">setScheduledEventOpTx</a> :: <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventId" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventId</a> -&gt; <a href="Hasura-Eventing-ScheduledTrigger-Types.html#t:ScheduledEventOp" title="Hasura.Eventing.ScheduledTrigger.Types">ScheduledEventOp</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventType" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventType</a> -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> () <a href="src/Hasura.Eventing.ScheduledTrigger.html#setScheduledEventOpTx" class="link">Source</a> <a href="#v:setScheduledEventOpTx" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:unlockScheduledEventsTx" class="def">unlockScheduledEventsTx</a> :: <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventType" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventType</a> -&gt; [<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventId" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventId</a>] -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> <a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Data-Int.html#t:Int" title="Data.Int">Int</a> <a href="src/Hasura.Eventing.ScheduledTrigger.html#unlockScheduledEventsTx" class="link">Source</a> <a href="#v:unlockScheduledEventsTx" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:unlockAllLockedScheduledEventsTx" class="def">unlockAllLockedScheduledEventsTx</a> :: <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> () <a href="src/Hasura.Eventing.ScheduledTrigger.html#unlockAllLockedScheduledEventsTx" class="link">Source</a> <a href="#v:unlockAllLockedScheduledEventsTx" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:insertCronEventsTx" class="def">insertCronEventsTx</a> :: [<a href="Hasura-Eventing-ScheduledTrigger.html#t:CronEventSeed" title="Hasura.Eventing.ScheduledTrigger">CronEventSeed</a>] -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> () <a href="src/Hasura.Eventing.ScheduledTrigger.html#insertCronEventsTx" class="link">Source</a> <a href="#v:insertCronEventsTx" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:insertOneOffScheduledEventTx" class="def">insertOneOffScheduledEventTx</a> :: <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:OneOffEvent" title="Hasura.RQL.Types.ScheduledTrigger">OneOffEvent</a> -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> <a href="Hasura-RQL-Types-Eventing.html#t:EventId" title="Hasura.RQL.Types.Eventing">EventId</a> <a href="src/Hasura.Eventing.ScheduledTrigger.html#insertOneOffScheduledEventTx" class="link">Source</a> <a href="#v:insertOneOffScheduledEventTx" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:dropFutureCronEventsTx" class="def">dropFutureCronEventsTx</a> :: <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ClearCronEvents" title="Hasura.RQL.Types.ScheduledTrigger">ClearCronEvents</a> -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> () <a href="src/Hasura.Eventing.ScheduledTrigger.html#dropFutureCronEventsTx" class="link">Source</a> <a href="#v:dropFutureCronEventsTx" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getOneOffScheduledEventsTx" class="def">getOneOffScheduledEventsTx</a> :: <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventPagination" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventPagination</a> -&gt; [<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventStatus" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventStatus</a>] -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:RowsCountOption" title="Hasura.RQL.Types.ScheduledTrigger">RowsCountOption</a> -&gt; [<a href="Hasura-Backends-Postgres-SQL-DML.html#t:OrderByItem" title="Hasura.Backends.Postgres.SQL.DML">OrderByItem</a>] -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> (<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:WithOptionalTotalCount" title="Hasura.RQL.Types.ScheduledTrigger">WithOptionalTotalCount</a> [<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:OneOffScheduledEvent" title="Hasura.RQL.Types.ScheduledTrigger">OneOffScheduledEvent</a>]) <a href="src/Hasura.Eventing.ScheduledTrigger.html#getOneOffScheduledEventsTx" class="link">Source</a> <a href="#v:getOneOffScheduledEventsTx" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getCronEventsTx" class="def">getCronEventsTx</a> :: <a href="Hasura-RQL-Types-EventTrigger.html#t:TriggerName" title="Hasura.RQL.Types.EventTrigger">TriggerName</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventPagination" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventPagination</a> -&gt; [<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventStatus" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventStatus</a>] -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:RowsCountOption" title="Hasura.RQL.Types.ScheduledTrigger">RowsCountOption</a> -&gt; [<a href="Hasura-Backends-Postgres-SQL-DML.html#t:OrderByItem" title="Hasura.Backends.Postgres.SQL.DML">OrderByItem</a>] -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> (<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:WithOptionalTotalCount" title="Hasura.RQL.Types.ScheduledTrigger">WithOptionalTotalCount</a> [<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:CronEvent" title="Hasura.RQL.Types.ScheduledTrigger">CronEvent</a>]) <a href="src/Hasura.Eventing.ScheduledTrigger.html#getCronEventsTx" class="link">Source</a> <a href="#v:getCronEventsTx" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:deleteScheduledEventTx" class="def">deleteScheduledEventTx</a> :: <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventId" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventId</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventType" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventType</a> -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> () <a href="src/Hasura.Eventing.ScheduledTrigger.html#deleteScheduledEventTx" class="link">Source</a> <a href="#v:deleteScheduledEventTx" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getScheduledEventInvocationsTx" class="def">getScheduledEventInvocationsTx</a> :: <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:GetScheduledEventInvocations" title="Hasura.RQL.Types.ScheduledTrigger">GetScheduledEventInvocations</a> -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> (<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:WithOptionalTotalCount" title="Hasura.RQL.Types.ScheduledTrigger">WithOptionalTotalCount</a> [<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventInvocation" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventInvocation</a>]) <a href="src/Hasura.Eventing.ScheduledTrigger.html#getScheduledEventInvocationsTx" class="link">Source</a> <a href="#v:getScheduledEventInvocationsTx" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getScheduledEventsInvocationsQuery" class="def">getScheduledEventsInvocationsQuery</a> :: <a href="Hasura-Eventing-ScheduledTrigger.html#t:EventTables" title="Hasura.Eventing.ScheduledTrigger">EventTables</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:GetScheduledEventInvocations" title="Hasura.RQL.Types.ScheduledTrigger">GetScheduledEventInvocations</a> -&gt; <a href="Hasura-Backends-Postgres-SQL-DML.html#t:Select" title="Hasura.Backends.Postgres.SQL.DML">Select</a> <a href="src/Hasura.Eventing.ScheduledTrigger.html#getScheduledEventsInvocationsQuery" class="link">Source</a> <a href="#v:getScheduledEventsInvocationsQuery" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:getScheduledEventsInvocationsQueryNoPagination" class="def">getScheduledEventsInvocationsQueryNoPagination</a> :: <a href="Hasura-Eventing-ScheduledTrigger.html#t:EventTables" title="Hasura.Eventing.ScheduledTrigger">EventTables</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:GetScheduledEventInvocationsBy" title="Hasura.RQL.Types.ScheduledTrigger">GetScheduledEventInvocationsBy</a> -&gt; <a href="Hasura-Backends-Postgres-SQL-DML.html#t:Select" title="Hasura.Backends.Postgres.SQL.DML">Select</a> <a href="src/Hasura.Eventing.ScheduledTrigger.html#getScheduledEventsInvocationsQueryNoPagination" class="link">Source</a> <a href="#v:getScheduledEventsInvocationsQueryNoPagination" class="selflink">#</a></p></div><a href="#g:4" id="g:4"><h1>Export utility functions which are useful to build</h1></a><div class="top"><p class="src"><a id="v:mkScheduledEventStatusFilter" class="def">mkScheduledEventStatusFilter</a> :: [<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventStatus" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventStatus</a>] -&gt; <a href="Hasura-Backends-Postgres-SQL-DML.html#t:BoolExp" title="Hasura.Backends.Postgres.SQL.DML">BoolExp</a> <a href="src/Hasura.Eventing.ScheduledTrigger.html#mkScheduledEventStatusFilter" class="link">Source</a> <a href="#v:mkScheduledEventStatusFilter" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:scheduledTimeOrderBy" class="def">scheduledTimeOrderBy</a> :: <a href="Hasura-Backends-Postgres-SQL-DML.html#t:OrderByExp" title="Hasura.Backends.Postgres.SQL.DML">OrderByExp</a> <a href="src/Hasura.Eventing.ScheduledTrigger.html#scheduledTimeOrderBy" class="link">Source</a> <a href="#v:scheduledTimeOrderBy" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:executeWithOptionalTotalCount" class="def">executeWithOptionalTotalCount</a> :: <a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/Data-Aeson-Types-FromJSON.html#t:FromJSON" title="Data.Aeson.Types.FromJSON">FromJSON</a> a =&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:Query" title="Database.PG.Query.Transaction">Query</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:RowsCountOption" title="Hasura.RQL.Types.ScheduledTrigger">RowsCountOption</a> -&gt; <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Transaction.html#t:TxE" title="Database.PG.Query.Transaction">TxE</a> <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/Hasura-Base-Error.html#t:QErr" title="Hasura.Base.Error">QErr</a> (<a href="Hasura-RQL-Types-ScheduledTrigger.html#t:WithOptionalTotalCount" title="Hasura.RQL.Types.ScheduledTrigger">WithOptionalTotalCount</a> a) <a href="src/Hasura.Eventing.ScheduledTrigger.html#executeWithOptionalTotalCount" class="link">Source</a> <a href="#v:executeWithOptionalTotalCount" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mkPaginationSelectExp" class="def">mkPaginationSelectExp</a> :: <a href="Hasura-Backends-Postgres-SQL-DML.html#t:Select" title="Hasura.Backends.Postgres.SQL.DML">Select</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:ScheduledEventPagination" title="Hasura.RQL.Types.ScheduledTrigger">ScheduledEventPagination</a> -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:RowsCountOption" title="Hasura.RQL.Types.ScheduledTrigger">RowsCountOption</a> -&gt; <a href="Hasura-Backends-Postgres-SQL-DML.html#t:Select" title="Hasura.Backends.Postgres.SQL.DML">Select</a> <a href="src/Hasura.Eventing.ScheduledTrigger.html#mkPaginationSelectExp" class="link">Source</a> <a href="#v:mkPaginationSelectExp" class="selflink">#</a></p><div class="doc"><p>Build a select expression which outputs total count and
 list of json rows with pagination limit and offset applied</p></div></div><div class="top"><p class="src"><a id="v:withCount" class="def">withCount</a> :: (<a href="${pkgroot}/../../../share/doc/ghc-9.10.1/html/libraries/base-4.20.0.0-inplace/Data-Int.html#t:Int" title="Data.Int">Int</a>, <a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/Database-PG-Query-Class.html#t:ViaJSON" title="Database.PG.Query.Class">ViaJSON</a> a) -&gt; <a href="Hasura-RQL-Types-ScheduledTrigger.html#t:WithOptionalTotalCount" title="Hasura.RQL.Types.ScheduledTrigger">WithOptionalTotalCount</a> a <a href="src/Hasura.Eventing.ScheduledTrigger.html#withCount" class="link">Source</a> <a href="#v:withCount" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:invocationFieldExtractors" class="def">invocationFieldExtractors</a> :: <a href="Hasura-Backends-Postgres-SQL-Types.html#t:QualifiedTable" title="Hasura.Backends.Postgres.SQL.Types">QualifiedTable</a> -&gt; [<a href="Hasura-Backends-Postgres-SQL-DML.html#t:Extractor" title="Hasura.Backends.Postgres.SQL.DML">Extractor</a>] <a href="src/Hasura.Eventing.ScheduledTrigger.html#invocationFieldExtractors" class="link">Source</a> <a href="#v:invocationFieldExtractors" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mkEventIdBoolExp" class="def">mkEventIdBoolExp</a> :: <a href="Hasura-Backends-Postgres-SQL-Types.html#t:QualifiedTable" title="Hasura.Backends.Postgres.SQL.Types">QualifiedTable</a> -&gt; <a href="Hasura-RQL-Types-Eventing.html#t:EventId" title="Hasura.RQL.Types.Eventing">EventId</a> -&gt; <a href="Hasura-Backends-Postgres-SQL-DML.html#t:BoolExp" title="Hasura.Backends.Postgres.SQL.DML">BoolExp</a> <a href="src/Hasura.Eventing.ScheduledTrigger.html#mkEventIdBoolExp" class="link">Source</a> <a href="#v:mkEventIdBoolExp" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:EventTables" class="def">EventTables</a> <a href="src/Hasura.Eventing.ScheduledTrigger.html#EventTables" class="link">Source</a> <a href="#t:EventTables" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:EventTables" class="def">EventTables</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:etOneOffInvocationsTable" class="def">etOneOffInvocationsTable</a> :: <a href="Hasura-Backends-Postgres-SQL-Types.html#t:QualifiedTable" title="Hasura.Backends.Postgres.SQL.Types">QualifiedTable</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:etCronInvocationsTable" class="def">etCronInvocationsTable</a> :: <a href="Hasura-Backends-Postgres-SQL-Types.html#t:QualifiedTable" title="Hasura.Backends.Postgres.SQL.Types">QualifiedTable</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:etCronEventsTable" class="def">etCronEventsTable</a> :: <a href="Hasura-Backends-Postgres-SQL-Types.html#t:QualifiedTable" title="Hasura.Backends.Postgres.SQL.Types">QualifiedTable</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.28.0</p></div></body></html>