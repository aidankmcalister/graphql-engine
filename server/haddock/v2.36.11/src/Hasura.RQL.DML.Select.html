<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Select.html"><span class="hs-identifier">Hasura.RQL.DML.Select</span></a></span><span>
</span><span id="line-2"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#runSelect"><span class="hs-identifier">runSelect</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-4"></span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/monad-control-1.0.3.1-127c0b1895a90d6faa345827c6b6be6447278996974a93c84184eef9ccf5fbbc/share/doc/html/src/Control.Monad.Trans.Control.html/Control.Monad.Trans.Control.html"><span class="hs-identifier">Control.Monad.Trans.Control</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/monad-control-1.0.3.1-127c0b1895a90d6faa345827c6b6be6447278996974a93c84184eef9ccf5fbbc/share/doc/html/src/Control.Monad.Trans.Control.html/Control.Monad.Trans.Control.html#MonadBaseControl"><span class="hs-identifier">MonadBaseControl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Strict.html/Data.HashMap.Strict.html"><span class="hs-identifier">Data.HashMap.Strict</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HashMap</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DS</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html"><span class="hs-identifier">Data.Text.Extended</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.html/Database.PG.Query.html"><span class="hs-identifier">Database.PG.Query</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PG</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Authentication.User.html"><span class="hs-identifier">Hasura.Authentication.User</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfo"><span class="hs-identifier">UserInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfoM"><span class="hs-identifier">UserInfoM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html"><span class="hs-identifier">Hasura.Backends.Postgres.Connection.MonadTx</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Types.html"><span class="hs-identifier">Hasura.Backends.Postgres.Execute.Types</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.DML</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.Types</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#TableName"><span class="hs-identifier">TableName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Select</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Select.Internal.Helpers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#selectToSelectWithM"><span class="hs-identifier">selectToSelectWithM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#toQuery"><span class="hs-identifier">toQuery</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html/Hasura.EncJSON.html"><span class="hs-identifier">Hasura.EncJSON</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.LogicalModel.Cache.html"><span class="hs-identifier">Hasura.LogicalModel.Cache</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.LogicalModel.Cache.html#LogicalModelCache"><span class="hs-identifier">LogicalModelCache</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.LogicalModel.Cache.html#LogicalModelInfo"><span class="hs-identifier">LogicalModelInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.LogicalModel.Fields.html"><span class="hs-identifier">Hasura.LogicalModel.Fields</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.LogicalModel.Fields.html#LogicalModelFieldsRM"><span class="hs-identifier">LogicalModelFieldsRM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.LogicalModel.Fields.html#runLogicalModelFieldsLookup"><span class="hs-identifier">runLogicalModelFieldsLookup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html/Hasura.Prelude.html"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html"><span class="hs-identifier">Hasura.RQL.DML.Internal</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Types.html"><span class="hs-identifier">Hasura.RQL.DML.Types</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html"><span class="hs-identifier">Hasura.RQL.IR.BoolExp</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.OrderBy.html"><span class="hs-identifier">Hasura.RQL.IR.OrderBy</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html"><span class="hs-identifier">Hasura.RQL.IR.Select</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html"><span class="hs-identifier">Hasura.RQL.Types.Backend</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html"><span class="hs-identifier">Hasura.RQL.Types.BackendType</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Column.html"><span class="hs-identifier">Hasura.RQL.Types.Column</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html"><span class="hs-identifier">Hasura.RQL.Types.Common</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html"><span class="hs-identifier">Hasura.RQL.Types.Metadata</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html"><span class="hs-identifier">Hasura.RQL.Types.Relationships.Local</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html"><span class="hs-identifier">Hasura.RQL.Types.SchemaCache</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Table.Cache.html"><span class="hs-identifier">Hasura.Table.Cache</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Tracing.html"><span class="hs-identifier">Hasura.Tracing</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tracing</span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">type</span><span> </span><span id="SelectQExt"><span class="annot"><a href="Hasura.RQL.DML.Select.html#SelectQExt"><span class="hs-identifier hs-var">SelectQExt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelectG"><span class="hs-identifier hs-type">SelectG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ExtCol"><span class="hs-identifier hs-type">ExtCol</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html#BoolExp"><span class="hs-identifier hs-type">BoolExp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- Columns in RQL</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- This technically doesn't need to be generalized to all backends as</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- it is specific to this module; however the generalization work was</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- already done, and there's no particular reason to force this to be</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- specific.</span><span>
</span><span id="line-46"></span><span class="hs-keyword">data</span><span> </span><span id="ExtCol"><span class="annot"><a href="Hasura.RQL.DML.Select.html#ExtCol"><span class="hs-identifier hs-var">ExtCol</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687949693"><span class="annot"><a href="#local-6989586621687949693"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#BackendType"><span class="hs-identifier hs-type">BackendType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ECSimple"><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECSimple"><span class="hs-identifier hs-var">ECSimple</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Column"><span class="hs-identifier hs-type">Column</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949693"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ECRel"><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECRel"><span class="hs-identifier hs-var">ECRel</span></a></span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#RelName"><span class="hs-identifier hs-type">RelName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#RelName"><span class="hs-identifier hs-type">RelName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#SelectQExt"><span class="hs-identifier hs-type">SelectQExt</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span id="local-6989586621687949675"><span class="annot"><a href="Hasura.RQL.DML.Select.html#convSelCol"><span class="hs-identifier hs-type">convSelCol</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949675"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949675"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#TableInfoRM"><span class="hs-identifier hs-type">TableInfoRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687949675"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="Hasura.Table.Cache.html#FieldInfoMap"><span class="hs-identifier hs-type">FieldInfoMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Table.Cache.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="Hasura.Table.Cache.html#SelPermInfo"><span class="hs-identifier hs-type">SelPermInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelCol"><span class="hs-identifier hs-type">SelCol</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><a href="#local-6989586621687949675"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ExtCol"><span class="hs-identifier hs-type">ExtCol</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-56"></span><span id="convSelCol"><span class="annot"><span class="annottext">convSelCol :: forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; SelCol
-&gt; m [ExtCol ('Postgres 'Vanilla)]
</span><a href="Hasura.RQL.DML.Select.html#convSelCol"><span class="hs-identifier hs-var hs-var">convSelCol</span></a></span></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SCExtSimple"><span class="hs-identifier hs-type">SCExtSimple</span></a></span><span> </span><span id="local-6989586621687950147"><span class="annot"><span class="annottext">PGCol
</span><a href="#local-6989586621687950147"><span class="hs-identifier hs-var">cn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)] -&gt; m [ExtCol ('Postgres 'Vanilla)]
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Column ('Postgres 'Vanilla) -&gt; ExtCol ('Postgres 'Vanilla)
forall (b :: BackendType). Column b -&gt; ExtCol b
</span><a href="Hasura.RQL.DML.Select.html#ECSimple"><span class="hs-identifier hs-var">ECSimple</span></a></span><span> </span><span class="annot"><span class="annottext">Column ('Postgres 'Vanilla)
PGCol
</span><a href="#local-6989586621687950147"><span class="hs-identifier hs-var">cn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-58"></span><span class="annot"><a href="Hasura.RQL.DML.Select.html#convSelCol"><span class="hs-identifier hs-var">convSelCol</span></a></span><span> </span><span id="local-6989586621687950148"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950148"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SCExtRel"><span class="hs-identifier hs-type">SCExtRel</span></a></span><span> </span><span id="local-6989586621687950150"><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687950150"><span class="hs-identifier hs-var">rn</span></a></span></span><span> </span><span id="local-6989586621687950151"><span class="annot"><span class="annottext">Maybe RelName
</span><a href="#local-6989586621687950151"><span class="hs-identifier hs-var">malias</span></a></span></span><span> </span><span id="local-6989586621687950152"><span class="annot"><span class="annottext">SelectQ
</span><a href="#local-6989586621687950152"><span class="hs-identifier hs-var">selQ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-comment">-- Point to the name key</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687950154"><span class="annot"><span class="annottext">pgWhenRelErr :: Text
</span><a href="#local-6989586621687950154"><span class="hs-identifier hs-var hs-var hs-var">pgWhenRelErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;only relationships can be expanded&quot;</span></span><span>
</span><span id="line-61"></span><span>  </span><span id="local-6989586621687950155"><span class="annot"><a href="#local-6989586621687950155"><span class="hs-identifier hs-var">relInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="annottext">Text
-&gt; m (RelInfo ('Postgres 'Vanilla))
-&gt; m (RelInfo ('Postgres 'Vanilla))
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;name&quot;</span></span><span>
</span><span id="line-63"></span><span>      </span><span class="annot"><span class="annottext">(m (RelInfo ('Postgres 'Vanilla))
 -&gt; m (RelInfo ('Postgres 'Vanilla)))
-&gt; m (RelInfo ('Postgres 'Vanilla))
-&gt; m (RelInfo ('Postgres 'Vanilla))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; RelName -&gt; Text -&gt; m (RelInfo ('Postgres 'Vanilla))
forall (m :: * -&gt; *) (backend :: BackendType).
MonadError QErr m =&gt;
FieldInfoMap (FieldInfo backend)
-&gt; RelName -&gt; Text -&gt; m (RelInfo backend)
</span><a href="Hasura.Table.Cache.html#askRelType"><span class="hs-identifier hs-var">askRelType</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950148"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687950150"><span class="hs-identifier hs-var">rn</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687950154"><span class="hs-identifier hs-var">pgWhenRelErr</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621687950155"><span class="hs-identifier hs-type">relInfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelInfo"><span class="hs-identifier hs-type">RelInfo</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">riTarget :: forall (b :: BackendType). RelInfo b -&gt; RelTarget b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riTarget"><span class="hs-identifier hs-var">riTarget</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelTargetNativeQuery"><span class="hs-identifier hs-type">RelTargetNativeQuery</span></a></span><span> </span><span class="annot"><span class="annottext">NativeQueryName
</span><span class="hs-identifier">_</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; m [ExtCol ('Postgres 'Vanilla)]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;convSelCol RelTargetNativeQuery&quot;</span></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelInfo"><span class="hs-identifier hs-type">RelInfo</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">riTarget :: forall (b :: BackendType). RelInfo b -&gt; RelTarget b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riTarget"><span class="hs-identifier hs-var">riTarget</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelTargetTable"><span class="hs-identifier hs-type">RelTargetTable</span></a></span><span> </span><span id="local-6989586621687950163"><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950163"><span class="hs-identifier hs-var">relTable</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-67"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621687950164"><span class="annot"><a href="#local-6989586621687950164"><span class="hs-identifier hs-var">rfim</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687950165"><span class="annot"><a href="#local-6989586621687950165"><span class="hs-identifier hs-var">rspi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RelName
-&gt; TableName ('Postgres 'Vanilla)
-&gt; m (FieldInfoMap (FieldInfo ('Postgres 'Vanilla)),
      SelPermInfo ('Postgres 'Vanilla))
forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
RelName
-&gt; TableName ('Postgres 'Vanilla)
-&gt; m (FieldInfoMap (FieldInfo ('Postgres 'Vanilla)),
      SelPermInfo ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Internal.html#fetchRelDet"><span class="hs-identifier hs-var">fetchRelDet</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687950150"><span class="hs-identifier hs-var">rn</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950163"><span class="hs-identifier hs-var">relTable</span></a></span><span>
</span><span id="line-68"></span><span>      </span><span id="local-6989586621687950167"><span class="annot"><a href="#local-6989586621687950167"><span class="hs-identifier hs-var">resolvedSelQ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#resolveStar"><span class="hs-identifier hs-type">resolveStar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950164"><span class="hs-identifier hs-type">rfim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950165"><span class="hs-identifier hs-type">rspi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950152"><span class="hs-identifier hs-type">selQ</span></a></span><span>
</span><span id="line-69"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECRel"><span class="hs-identifier hs-type">ECRel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950150"><span class="hs-identifier hs-type">rn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950151"><span class="hs-identifier hs-type">malias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950167"><span class="hs-identifier hs-type">resolvedSelQ</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-70"></span><span class="annot"><a href="Hasura.RQL.DML.Select.html#convSelCol"><span class="hs-identifier hs-var">convSelCol</span></a></span><span> </span><span id="local-6989586621687950169"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950169"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span></span><span> </span><span id="local-6989586621687950170"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950170"><span class="hs-identifier hs-var">spi</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SCStar"><span class="hs-identifier hs-type">SCStar</span></a></span><span> </span><span id="local-6989586621687950172"><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621687950172"><span class="hs-identifier hs-var">wildcard</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; Wildcard
-&gt; m [ExtCol ('Postgres 'Vanilla)]
forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; Wildcard
-&gt; m [ExtCol ('Postgres 'Vanilla)]
</span><a href="Hasura.RQL.DML.Select.html#convWildcard"><span class="hs-identifier hs-var">convWildcard</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950169"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950170"><span class="hs-identifier hs-var">spi</span></a></span><span> </span><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621687950172"><span class="hs-identifier hs-var">wildcard</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span id="local-6989586621687949716"><span class="annot"><a href="Hasura.RQL.DML.Select.html#convWildcard"><span class="hs-identifier hs-type">convWildcard</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949716"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949716"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#TableInfoRM"><span class="hs-identifier hs-type">TableInfoRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687949716"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><a href="Hasura.Table.Cache.html#FieldInfoMap"><span class="hs-identifier hs-type">FieldInfoMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Table.Cache.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><a href="Hasura.Table.Cache.html#SelPermInfo"><span class="hs-identifier hs-type">SelPermInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#Wildcard"><span class="hs-identifier hs-type">Wildcard</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><a href="#local-6989586621687949716"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ExtCol"><span class="hs-identifier hs-type">ExtCol</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-79"></span><span id="convWildcard"><span class="annot"><span class="annottext">convWildcard :: forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; Wildcard
-&gt; m [ExtCol ('Postgres 'Vanilla)]
</span><a href="Hasura.RQL.DML.Select.html#convWildcard"><span class="hs-identifier hs-var hs-var">convWildcard</span></a></span></span><span> </span><span id="local-6989586621687950200"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950200"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span></span><span> </span><span id="local-6989586621687950201"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950201"><span class="hs-identifier hs-var">selPermInfo</span></a></span></span><span> </span><span id="local-6989586621687950202"><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621687950202"><span class="hs-identifier hs-var">wildcard</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621687950202"><span class="hs-identifier hs-var">wildcard</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">Wildcard
</span><a href="Hasura.RQL.DML.Types.html#Star"><span class="hs-identifier hs-var">Star</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)] -&gt; m [ExtCol ('Postgres 'Vanilla)]
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)]
</span><a href="#local-6989586621687950204"><span class="hs-identifier hs-var">simpleCols</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#StarDot"><span class="hs-identifier hs-type">StarDot</span></a></span><span> </span><span id="local-6989586621687950206"><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621687950206"><span class="hs-identifier hs-var">wc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)]
</span><a href="#local-6989586621687950204"><span class="hs-identifier hs-var">simpleCols</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)]
-&gt; [ExtCol ('Postgres 'Vanilla)] -&gt; [ExtCol ('Postgres 'Vanilla)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ExtCol ('Postgres 'Vanilla)] -&gt; [ExtCol ('Postgres 'Vanilla)])
-&gt; m [ExtCol ('Postgres 'Vanilla)]
-&gt; m [ExtCol ('Postgres 'Vanilla)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Maybe (ExtCol ('Postgres 'Vanilla))]
-&gt; [ExtCol ('Postgres 'Vanilla)]
forall a. [Maybe a] -&gt; [a]
forall (f :: * -&gt; *) a. Filterable f =&gt; f (Maybe a) -&gt; f a
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/witherable-0.5-ed5d92584b79c1fa03d7efeb1159ae93eef86189605b088dd8806eb40d0b16f5/share/doc/html/src/Witherable.html/Witherable.html#catMaybes"><span class="hs-identifier hs-var">catMaybes</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe (ExtCol ('Postgres 'Vanilla))]
 -&gt; [ExtCol ('Postgres 'Vanilla)])
-&gt; m [Maybe (ExtCol ('Postgres 'Vanilla))]
-&gt; m [ExtCol ('Postgres 'Vanilla)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Wildcard -&gt; m [Maybe (ExtCol ('Postgres 'Vanilla))]
</span><a href="#local-6989586621687950209"><span class="hs-identifier hs-var">relExtCols</span></a></span><span> </span><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621687950206"><span class="hs-identifier hs-var">wc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>    </span><span id="local-6989586621687950210"><span class="annot"><span class="annottext">cols :: HashMap
  (Column ('Postgres 'Vanilla))
  (AnnRedactionExpPartialSQL ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950210"><span class="hs-identifier hs-var hs-var">cols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
-&gt; HashMap
     (Column ('Postgres 'Vanilla))
     (AnnRedactionExpPartialSQL ('Postgres 'Vanilla))
forall (b :: BackendType).
SelPermInfo b -&gt; HashMap (Column b) (AnnRedactionExpPartialSQL b)
</span><a href="Hasura.Table.Cache.html#spiCols"><span class="hs-identifier hs-var">spiCols</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950201"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621687950212"><span class="annot"><span class="annottext">pgCols :: [PGCol]
</span><a href="#local-6989586621687950212"><span class="hs-identifier hs-var hs-var">pgCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StructuredColumnInfo ('Postgres 'Vanilla) -&gt; PGCol)
-&gt; [StructuredColumnInfo ('Postgres 'Vanilla)] -&gt; [PGCol]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">StructuredColumnInfo ('Postgres 'Vanilla)
-&gt; Column ('Postgres 'Vanilla)
StructuredColumnInfo ('Postgres 'Vanilla) -&gt; PGCol
forall (b :: BackendType). StructuredColumnInfo b -&gt; Column b
</span><a href="Hasura.RQL.Types.Column.html#structuredColumnInfoColumn"><span class="hs-identifier hs-var">structuredColumnInfoColumn</span></a></span><span> </span><span class="annot"><span class="annottext">([StructuredColumnInfo ('Postgres 'Vanilla)] -&gt; [PGCol])
-&gt; [StructuredColumnInfo ('Postgres 'Vanilla)] -&gt; [PGCol]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; [StructuredColumnInfo ('Postgres 'Vanilla)]
forall (backend :: BackendType).
FieldInfoMap (FieldInfo backend) -&gt; [StructuredColumnInfo backend]
</span><a href="Hasura.Table.Cache.html#getCols"><span class="hs-identifier hs-var">getCols</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950200"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span id="local-6989586621687950215"><span class="annot"><span class="annottext">relColInfos :: [RelInfo ('Postgres 'Vanilla)]
</span><a href="#local-6989586621687950215"><span class="hs-identifier hs-var hs-var">relColInfos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; [RelInfo ('Postgres 'Vanilla)]
forall (backend :: BackendType).
FieldInfoMap (FieldInfo backend) -&gt; [RelInfo backend]
</span><a href="Hasura.Table.Cache.html#getRels"><span class="hs-identifier hs-var">getRels</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950200"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621687950204"><span class="annot"><span class="annottext">simpleCols :: [ExtCol ('Postgres 'Vanilla)]
</span><a href="#local-6989586621687950204"><span class="hs-identifier hs-var hs-var">simpleCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PGCol -&gt; ExtCol ('Postgres 'Vanilla))
-&gt; [PGCol] -&gt; [ExtCol ('Postgres 'Vanilla)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Column ('Postgres 'Vanilla) -&gt; ExtCol ('Postgres 'Vanilla)
PGCol -&gt; ExtCol ('Postgres 'Vanilla)
forall (b :: BackendType). Column b -&gt; ExtCol b
</span><a href="Hasura.RQL.DML.Select.html#ECSimple"><span class="hs-identifier hs-var">ECSimple</span></a></span><span> </span><span class="annot"><span class="annottext">([PGCol] -&gt; [ExtCol ('Postgres 'Vanilla)])
-&gt; [PGCol] -&gt; [ExtCol ('Postgres 'Vanilla)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PGCol -&gt; Bool) -&gt; [PGCol] -&gt; [PGCol]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Column ('Postgres 'Vanilla)
-&gt; HashMap
     (Column ('Postgres 'Vanilla))
     (AnnRedactionExpPartialSQL ('Postgres 'Vanilla))
-&gt; Bool
forall k a. (Eq k, Hashable k) =&gt; k -&gt; HashMap k a -&gt; Bool
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#member"><span class="hs-operator hs-var">`HashMap.member`</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap
  (Column ('Postgres 'Vanilla))
  (AnnRedactionExpPartialSQL ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950210"><span class="hs-identifier hs-var">cols</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PGCol]
</span><a href="#local-6989586621687950212"><span class="hs-identifier hs-var">pgCols</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>    </span><span id="local-6989586621687950257"><span class="annot"><span class="annottext">mkRelCol :: Wildcard -&gt; RelInfo b -&gt; m (Maybe (ExtCol b))
</span><a href="#local-6989586621687950257"><span class="hs-identifier hs-var hs-var">mkRelCol</span></a></span></span><span> </span><span id="local-6989586621687950258"><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621687950258"><span class="hs-identifier hs-var">_wc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelInfo"><span class="hs-identifier hs-type">RelInfo</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">riTarget :: forall (b :: BackendType). RelInfo b -&gt; RelTarget b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riTarget"><span class="hs-identifier hs-var">riTarget</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelTargetNativeQuery"><span class="hs-identifier hs-type">RelTargetNativeQuery</span></a></span><span> </span><span class="annot"><span class="annottext">NativeQueryName
</span><span class="hs-identifier">_</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-91"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; m (Maybe (ExtCol b))
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;convWildcard RelTargetNativeQuery&quot;</span></span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><a href="#local-6989586621687950257"><span class="hs-identifier hs-var">mkRelCol</span></a></span><span> </span><span id="local-6989586621687950259"><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621687950259"><span class="hs-identifier hs-var">wc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelInfo"><span class="hs-identifier hs-type">RelInfo</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">riName :: forall (b :: BackendType). RelInfo b -&gt; RelName
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riName"><span class="hs-identifier hs-var">riName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621687950261"><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687950261"><span class="hs-identifier hs-var">relName</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">riTarget :: forall (b :: BackendType). RelInfo b -&gt; RelTarget b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riTarget"><span class="hs-identifier hs-var">riTarget</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelTargetTable"><span class="hs-identifier hs-type">RelTargetTable</span></a></span><span> </span><span id="local-6989586621687950262"><span class="annot"><span class="annottext">TableName b
</span><a href="#local-6989586621687950262"><span class="hs-identifier hs-var">relTableName</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-93"></span><span>      </span><span id="local-6989586621687950263"><span class="annot"><a href="#local-6989586621687950263"><span class="hs-identifier hs-var">relTabInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
-&gt; m (TableInfo ('Postgres 'Vanilla))
forall (m :: * -&gt; *).
(QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
TableName ('Postgres 'Vanilla)
-&gt; m (TableInfo ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Internal.html#fetchRelTabInfo"><span class="hs-identifier hs-var">fetchRelTabInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TableName b
TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950262"><span class="hs-identifier hs-var">relTableName</span></a></span><span>
</span><span id="line-94"></span><span>      </span><span id="local-6989586621687950265"><span class="annot"><a href="#local-6989586621687950265"><span class="hs-identifier hs-var">mRelSelPerm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#askPermInfo"><span class="hs-identifier hs-type">askPermInfo</span></a></span><span> </span><span class="annot"><a href="Hasura.Table.Cache.html#permSel"><span class="hs-identifier hs-type">permSel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950263"><span class="hs-identifier hs-type">relTabInfo</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">forM</span></span><span> </span><span class="annot"><a href="#local-6989586621687950265"><span class="hs-identifier hs-type">mRelSelPerm</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687950271"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950271"><span class="hs-identifier hs-var">relSelPermInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-97"></span><span>        </span><span id="local-6989586621687950272"><span class="annot"><a href="#local-6989586621687950272"><span class="hs-identifier hs-var">rExtCols</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; Wildcard
-&gt; m [ExtCol ('Postgres 'Vanilla)]
forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; Wildcard
-&gt; m [ExtCol ('Postgres 'Vanilla)]
</span><a href="Hasura.RQL.DML.Select.html#convWildcard"><span class="hs-identifier hs-var">convWildcard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableCoreInfoG
  ('Postgres 'Vanilla)
  (FieldInfo ('Postgres 'Vanilla))
  (ColumnInfo ('Postgres 'Vanilla))
-&gt; FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
forall (b :: BackendType) field primaryKeyColumn.
TableCoreInfoG b field primaryKeyColumn -&gt; FieldInfoMap field
</span><a href="Hasura.Table.Cache.html#_tciFieldInfoMap"><span class="hs-identifier hs-var">_tciFieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">(TableCoreInfoG
   ('Postgres 'Vanilla)
   (FieldInfo ('Postgres 'Vanilla))
   (ColumnInfo ('Postgres 'Vanilla))
 -&gt; FieldInfoMap (FieldInfo ('Postgres 'Vanilla)))
-&gt; TableCoreInfoG
     ('Postgres 'Vanilla)
     (FieldInfo ('Postgres 'Vanilla))
     (ColumnInfo ('Postgres 'Vanilla))
-&gt; FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TableInfo ('Postgres 'Vanilla)
-&gt; TableCoreInfoG
     ('Postgres 'Vanilla)
     (FieldInfo ('Postgres 'Vanilla))
     (ColumnInfo ('Postgres 'Vanilla))
forall (b :: BackendType). TableInfo b -&gt; TableCoreInfo b
</span><a href="Hasura.Table.Cache.html#_tiCoreInfo"><span class="hs-identifier hs-var">_tiCoreInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TableInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950263"><span class="hs-identifier hs-var">relTabInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950271"><span class="hs-identifier hs-var">relSelPermInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621687950259"><span class="hs-identifier hs-var">wc</span></a></span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-99"></span><span>          </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECRel"><span class="hs-identifier hs-type">ECRel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950261"><span class="hs-identifier hs-type">relName</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-100"></span><span>          </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelectG"><span class="hs-identifier hs-type">SelectG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950272"><span class="hs-identifier hs-type">rExtCols</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621687950209"><span class="annot"><span class="annottext">relExtCols :: Wildcard -&gt; m [Maybe (ExtCol ('Postgres 'Vanilla))]
</span><a href="#local-6989586621687950209"><span class="hs-identifier hs-var hs-var">relExtCols</span></a></span></span><span> </span><span id="local-6989586621687950276"><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621687950276"><span class="hs-identifier hs-var">wc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RelInfo ('Postgres 'Vanilla)
 -&gt; m (Maybe (ExtCol ('Postgres 'Vanilla))))
-&gt; [RelInfo ('Postgres 'Vanilla)]
-&gt; m [Maybe (ExtCol ('Postgres 'Vanilla))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wildcard
-&gt; RelInfo ('Postgres 'Vanilla)
-&gt; m (Maybe (ExtCol ('Postgres 'Vanilla)))
forall {b :: BackendType} {m :: * -&gt; *} {b :: BackendType}.
(TableName b ~ QualifiedTable, QErrM m,
 TableInfoRM ('Postgres 'Vanilla) m, UserInfoM m) =&gt;
Wildcard -&gt; RelInfo b -&gt; m (Maybe (ExtCol b))
</span><a href="#local-6989586621687950257"><span class="hs-identifier hs-var">mkRelCol</span></a></span><span> </span><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621687950276"><span class="hs-identifier hs-var">wc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RelInfo ('Postgres 'Vanilla)]
</span><a href="#local-6989586621687950215"><span class="hs-identifier hs-var">relColInfos</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span id="local-6989586621687949714"><span class="annot"><a href="Hasura.RQL.DML.Select.html#resolveStar"><span class="hs-identifier hs-type">resolveStar</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949714"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949714"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#TableInfoRM"><span class="hs-identifier hs-type">TableInfoRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687949714"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><a href="Hasura.Table.Cache.html#FieldInfoMap"><span class="hs-identifier hs-type">FieldInfoMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Table.Cache.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><a href="Hasura.Table.Cache.html#SelPermInfo"><span class="hs-identifier hs-type">SelPermInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelectQ"><span class="hs-identifier hs-type">SelectQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="#local-6989586621687949714"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#SelectQExt"><span class="hs-identifier hs-type">SelectQExt</span></a></span></span><span>
</span><span id="line-110"></span><span id="resolveStar"><span class="annot"><span class="annottext">resolveStar :: forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla) -&gt; SelectQ -&gt; m SelectQExt
</span><a href="Hasura.RQL.DML.Select.html#resolveStar"><span class="hs-identifier hs-var hs-var">resolveStar</span></a></span></span><span> </span><span id="local-6989586621687950310"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950310"><span class="hs-identifier hs-var">fim</span></a></span></span><span> </span><span id="local-6989586621687950311"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950311"><span class="hs-identifier hs-var">selPermInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelectG"><span class="hs-identifier hs-type">SelectG</span></a></span><span> </span><span id="local-6989586621687950312"><span class="annot"><span class="annottext">[SelCol]
</span><a href="#local-6989586621687950312"><span class="hs-identifier hs-var">selCols</span></a></span></span><span> </span><span id="local-6989586621687950313"><span class="annot"><span class="annottext">Maybe (BoolExp ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950313"><span class="hs-identifier hs-var">mWh</span></a></span></span><span> </span><span id="local-6989586621687950314"><span class="annot"><span class="annottext">Maybe OrderByExp
</span><a href="#local-6989586621687950314"><span class="hs-identifier hs-var">mOb</span></a></span></span><span> </span><span id="local-6989586621687950315"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687950315"><span class="hs-identifier hs-var">mLt</span></a></span></span><span> </span><span id="local-6989586621687950316"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687950316"><span class="hs-identifier hs-var">mOf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621687950317"><span class="annot"><a href="#local-6989586621687950317"><span class="hs-identifier hs-var">procOverrides</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Maybe [ExtCol ('Postgres 'Vanilla)]]
 -&gt; [ExtCol ('Postgres 'Vanilla)])
-&gt; m [Maybe [ExtCol ('Postgres 'Vanilla)]]
-&gt; m [ExtCol ('Postgres 'Vanilla)]
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[ExtCol ('Postgres 'Vanilla)]] -&gt; [ExtCol ('Postgres 'Vanilla)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[ExtCol ('Postgres 'Vanilla)]] -&gt; [ExtCol ('Postgres 'Vanilla)])
-&gt; ([Maybe [ExtCol ('Postgres 'Vanilla)]]
    -&gt; [[ExtCol ('Postgres 'Vanilla)]])
-&gt; [Maybe [ExtCol ('Postgres 'Vanilla)]]
-&gt; [ExtCol ('Postgres 'Vanilla)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Maybe [ExtCol ('Postgres 'Vanilla)]]
-&gt; [[ExtCol ('Postgres 'Vanilla)]]
forall a. [Maybe a] -&gt; [a]
forall (f :: * -&gt; *) a. Filterable f =&gt; f (Maybe a) -&gt; f a
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/witherable-0.5-ed5d92584b79c1fa03d7efeb1159ae93eef86189605b088dd8806eb40d0b16f5/share/doc/html/src/Witherable.html/Witherable.html#catMaybes"><span class="hs-identifier hs-var">catMaybes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">(m [Maybe [ExtCol ('Postgres 'Vanilla)]]
 -&gt; m [ExtCol ('Postgres 'Vanilla)])
-&gt; m [Maybe [ExtCol ('Postgres 'Vanilla)]]
-&gt; m [ExtCol ('Postgres 'Vanilla)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
-&gt; m [Maybe [ExtCol ('Postgres 'Vanilla)]]
-&gt; m [Maybe [ExtCol ('Postgres 'Vanilla)]]
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;columns&quot;</span></span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><span class="annottext">(m [Maybe [ExtCol ('Postgres 'Vanilla)]]
 -&gt; m [Maybe [ExtCol ('Postgres 'Vanilla)]])
-&gt; m [Maybe [ExtCol ('Postgres 'Vanilla)]]
-&gt; m [Maybe [ExtCol ('Postgres 'Vanilla)]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SelCol]
-&gt; (SelCol -&gt; m (Maybe [ExtCol ('Postgres 'Vanilla)]))
-&gt; m [Maybe [ExtCol ('Postgres 'Vanilla)]]
forall (m :: * -&gt; *) a b. QErrM m =&gt; [a] -&gt; (a -&gt; m b) -&gt; m [b]
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#indexedForM"><span class="hs-identifier hs-var">indexedForM</span></a></span><span> </span><span class="annot"><span class="annottext">[SelCol]
</span><a href="#local-6989586621687950312"><span class="hs-identifier hs-var">selCols</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="annottext">((SelCol -&gt; m (Maybe [ExtCol ('Postgres 'Vanilla)]))
 -&gt; m [Maybe [ExtCol ('Postgres 'Vanilla)]])
-&gt; (SelCol -&gt; m (Maybe [ExtCol ('Postgres 'Vanilla)]))
-&gt; m [Maybe [ExtCol ('Postgres 'Vanilla)]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687950321"><span class="annot"><span class="annottext">SelCol
</span><a href="#local-6989586621687950321"><span class="hs-identifier hs-var">selCol</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SelCol
</span><a href="#local-6989586621687950321"><span class="hs-identifier hs-var">selCol</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SCStar"><span class="hs-identifier hs-type">SCStar</span></a></span><span> </span><span class="annot"><span class="annottext">Wildcard
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe [ExtCol ('Postgres 'Vanilla)]
-&gt; m (Maybe [ExtCol ('Postgres 'Vanilla)])
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe [ExtCol ('Postgres 'Vanilla)]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-116"></span><span>      </span><span class="annot"><span class="annottext">SelCol
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)]
-&gt; Maybe [ExtCol ('Postgres 'Vanilla)]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">([ExtCol ('Postgres 'Vanilla)]
 -&gt; Maybe [ExtCol ('Postgres 'Vanilla)])
-&gt; m [ExtCol ('Postgres 'Vanilla)]
-&gt; m (Maybe [ExtCol ('Postgres 'Vanilla)])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; SelCol
-&gt; m [ExtCol ('Postgres 'Vanilla)]
forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; SelCol
-&gt; m [ExtCol ('Postgres 'Vanilla)]
</span><a href="Hasura.RQL.DML.Select.html#convSelCol"><span class="hs-identifier hs-var">convSelCol</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950310"><span class="hs-identifier hs-var">fim</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950311"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SelCol
</span><a href="#local-6989586621687950321"><span class="hs-identifier hs-var">selCol</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621687950322"><span class="annot"><a href="#local-6989586621687950322"><span class="hs-identifier hs-var">everything</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621687950323"><span class="hs-identifier hs-type">wildcards</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)] -&gt; m [ExtCol ('Postgres 'Vanilla)]
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="annottext">[Wildcard]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; Wildcard
-&gt; m [ExtCol ('Postgres 'Vanilla)]
forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; Wildcard
-&gt; m [ExtCol ('Postgres 'Vanilla)]
</span><a href="Hasura.RQL.DML.Select.html#convWildcard"><span class="hs-identifier hs-var">convWildcard</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950310"><span class="hs-identifier hs-var">fim</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950311"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(Wildcard -&gt; m [ExtCol ('Postgres 'Vanilla)])
-&gt; Wildcard -&gt; m [ExtCol ('Postgres 'Vanilla)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Wildcard] -&gt; Wildcard
forall a. Ord a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">[Wildcard]
</span><a href="#local-6989586621687950323"><span class="hs-identifier hs-var">wildcards</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687950325"><span class="annot"><a href="#local-6989586621687950325"><span class="hs-identifier hs-var hs-var">extCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ExtCol ('Postgres 'Vanilla)
 -&gt; ExtCol ('Postgres 'Vanilla) -&gt; Bool)
-&gt; [ExtCol ('Postgres 'Vanilla)]
-&gt; [ExtCol ('Postgres 'Vanilla)]
-&gt; [ExtCol ('Postgres 'Vanilla)]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">unionBy</span></span><span> </span><span class="annot"><span class="annottext">ExtCol ('Postgres 'Vanilla) -&gt; ExtCol ('Postgres 'Vanilla) -&gt; Bool
forall {b :: BackendType} {b :: BackendType}.
(Column b ~ Column b, Eq (Column b)) =&gt;
ExtCol b -&gt; ExtCol b -&gt; Bool
</span><a href="#local-6989586621687950327"><span class="hs-identifier hs-var">equals</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)]
</span><a href="#local-6989586621687950317"><span class="hs-identifier hs-var">procOverrides</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)]
</span><a href="#local-6989586621687950322"><span class="hs-identifier hs-var">everything</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelectG"><span class="hs-identifier hs-type">SelectG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950325"><span class="hs-identifier hs-type">extCols</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950313"><span class="hs-identifier hs-type">mWh</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950314"><span class="hs-identifier hs-type">mOb</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950315"><span class="hs-identifier hs-type">mLt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950316"><span class="hs-identifier hs-type">mOf</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-123"></span><span>    </span><span id="local-6989586621687950323"><span class="annot"><span class="annottext">wildcards :: [Wildcard]
</span><a href="#local-6989586621687950323"><span class="hs-identifier hs-var hs-var">wildcards</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either Wildcard SelCol] -&gt; [Wildcard]
forall a b. [Either a b] -&gt; [a]
</span><span class="hs-identifier hs-var">lefts</span></span><span> </span><span class="annot"><span class="annottext">([Either Wildcard SelCol] -&gt; [Wildcard])
-&gt; [Either Wildcard SelCol] -&gt; [Wildcard]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SelCol -&gt; Either Wildcard SelCol)
-&gt; [SelCol] -&gt; [Either Wildcard SelCol]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">SelCol -&gt; Either Wildcard SelCol
</span><a href="#local-6989586621687950329"><span class="hs-identifier hs-var">mkEither</span></a></span><span> </span><span class="annot"><span class="annottext">[SelCol]
</span><a href="#local-6989586621687950312"><span class="hs-identifier hs-var">selCols</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621687950329"><span class="annot"><span class="annottext">mkEither :: SelCol -&gt; Either Wildcard SelCol
</span><a href="#local-6989586621687950329"><span class="hs-identifier hs-var hs-var">mkEither</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SCStar"><span class="hs-identifier hs-type">SCStar</span></a></span><span> </span><span id="local-6989586621687950330"><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621687950330"><span class="hs-identifier hs-var">wc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wildcard -&gt; Either Wildcard SelCol
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621687950330"><span class="hs-identifier hs-var">wc</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><a href="#local-6989586621687950329"><span class="hs-identifier hs-var">mkEither</span></a></span><span> </span><span id="local-6989586621687950331"><span class="annot"><span class="annottext">SelCol
</span><a href="#local-6989586621687950331"><span class="hs-identifier hs-var">selCol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelCol -&gt; Either Wildcard SelCol
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">SelCol
</span><a href="#local-6989586621687950331"><span class="hs-identifier hs-var">selCol</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621687950327"><span class="annot"><span class="annottext">equals :: ExtCol b -&gt; ExtCol b -&gt; Bool
</span><a href="#local-6989586621687950327"><span class="hs-identifier hs-var hs-var">equals</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECSimple"><span class="hs-identifier hs-type">ECSimple</span></a></span><span> </span><span id="local-6989586621687950338"><span class="annot"><span class="annottext">Column b
</span><a href="#local-6989586621687950338"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECSimple"><span class="hs-identifier hs-type">ECSimple</span></a></span><span> </span><span id="local-6989586621687950339"><span class="annot"><span class="annottext">Column b
</span><a href="#local-6989586621687950339"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Column b
</span><a href="#local-6989586621687950338"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Column b -&gt; Column b -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Column b
Column b
</span><a href="#local-6989586621687950339"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><a href="#local-6989586621687950327"><span class="hs-identifier hs-var">equals</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECRel"><span class="hs-identifier hs-type">ECRel</span></a></span><span> </span><span id="local-6989586621687950340"><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687950340"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe RelName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECRel"><span class="hs-identifier hs-type">ECRel</span></a></span><span> </span><span id="local-6989586621687950341"><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687950341"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe RelName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687950340"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">RelName -&gt; RelName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687950341"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><a href="#local-6989586621687950327"><span class="hs-identifier hs-var">equals</span></a></span><span> </span><span class="annot"><span class="annottext">ExtCol b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ExtCol b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span id="local-6989586621687949803"><span class="annot"><a href="Hasura.RQL.DML.Select.html#convOrderByElem"><span class="hs-identifier hs-type">convOrderByElem</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949803"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949803"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#TableInfoRM"><span class="hs-identifier hs-type">TableInfoRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687949803"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#SessionVariableBuilder"><span class="hs-identifier hs-type">SessionVariableBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949803"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Table.Cache.html#FieldInfoMap"><span class="hs-identifier hs-type">FieldInfoMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Table.Cache.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Table.Cache.html#SelPermInfo"><span class="hs-identifier hs-type">SelPermInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-136"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.OrderBy.html#OrderByCol"><span class="hs-identifier hs-type">OrderByCol</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><a href="#local-6989586621687949803"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.OrderBy.html#AnnotatedOrderByElement"><span class="hs-identifier hs-type">AnnotatedOrderByElement</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-138"></span><span id="convOrderByElem"><span class="annot"><span class="annottext">convOrderByElem :: forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
SessionVariableBuilder m
-&gt; (FieldInfoMap (FieldInfo ('Postgres 'Vanilla)),
    SelPermInfo ('Postgres 'Vanilla))
-&gt; OrderByCol
-&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)
</span><a href="Hasura.RQL.DML.Select.html#convOrderByElem"><span class="hs-identifier hs-var hs-var">convOrderByElem</span></a></span></span><span> </span><span id="local-6989586621687950404"><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621687950404"><span class="hs-identifier hs-var">sessVarBldr</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687950405"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950405"><span class="hs-identifier hs-var">flds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687950406"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950406"><span class="hs-identifier hs-var">spi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.OrderBy.html#OCPG"><span class="hs-identifier hs-type">OCPG</span></a></span><span> </span><span id="local-6989586621687950408"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687950408"><span class="hs-identifier hs-var">fldName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-140"></span><span>    </span><span id="local-6989586621687950409"><span class="annot"><a href="#local-6989586621687950409"><span class="hs-identifier hs-var">fldInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; FieldName -&gt; m (FieldInfo ('Postgres 'Vanilla))
forall (m :: * -&gt; *) fieldInfo.
MonadError QErr m =&gt;
FieldInfoMap fieldInfo -&gt; FieldName -&gt; m fieldInfo
</span><a href="Hasura.Table.Cache.html#askFieldInfo"><span class="hs-identifier hs-var">askFieldInfo</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950405"><span class="hs-identifier hs-var">flds</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687950408"><span class="hs-identifier hs-var">fldName</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621687950409"><span class="hs-identifier hs-type">fldInfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-142"></span><span>      </span><span class="annot"><a href="Hasura.Table.Cache.html#FIColumn"><span class="hs-identifier hs-type">FIColumn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#SCIScalarColumn"><span class="hs-identifier hs-type">SCIScalarColumn</span></a></span><span> </span><span id="local-6989586621687950413"><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950413"><span class="hs-identifier hs-var">colInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
-&gt; Column ('Postgres 'Vanilla) -&gt; m ()
forall (m :: * -&gt; *).
(UserInfoM m, QErrM m) =&gt;
SelPermInfo ('Postgres 'Vanilla)
-&gt; Column ('Postgres 'Vanilla) -&gt; m ()
</span><a href="Hasura.RQL.DML.Internal.html#checkSelOnCol"><span class="hs-identifier hs-var">checkSelOnCol</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950406"><span class="hs-identifier hs-var">spi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla) -&gt; Column ('Postgres 'Vanilla)
forall (b :: BackendType). ColumnInfo b -&gt; Column b
</span><a href="Hasura.RQL.Types.Column.html#ciColumn"><span class="hs-identifier hs-var">ciColumn</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950413"><span class="hs-identifier hs-var">colInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687950416"><span class="annot"><span class="annottext">redactionExp :: AnnRedactionExpPartialSQL ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950416"><span class="hs-identifier hs-var hs-var hs-var">redactionExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnnRedactionExpPartialSQL ('Postgres 'Vanilla)
-&gt; Maybe (AnnRedactionExpPartialSQL ('Postgres 'Vanilla))
-&gt; AnnRedactionExpPartialSQL ('Postgres 'Vanilla)
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">AnnRedactionExpPartialSQL ('Postgres 'Vanilla)
forall (b :: BackendType) v. AnnRedactionExp b v
</span><a href="Hasura.RQL.IR.BoolExp.html#NoRedaction"><span class="hs-identifier hs-var">NoRedaction</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (AnnRedactionExpPartialSQL ('Postgres 'Vanilla))
 -&gt; AnnRedactionExpPartialSQL ('Postgres 'Vanilla))
-&gt; Maybe (AnnRedactionExpPartialSQL ('Postgres 'Vanilla))
-&gt; AnnRedactionExpPartialSQL ('Postgres 'Vanilla)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PGCol
-&gt; HashMap PGCol (AnnRedactionExpPartialSQL ('Postgres 'Vanilla))
-&gt; Maybe (AnnRedactionExpPartialSQL ('Postgres 'Vanilla))
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#lookup"><span class="hs-identifier hs-var">HashMap.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla) -&gt; Column ('Postgres 'Vanilla)
forall (b :: BackendType). ColumnInfo b -&gt; Column b
</span><a href="Hasura.RQL.Types.Column.html#ciColumn"><span class="hs-identifier hs-var">ciColumn</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950413"><span class="hs-identifier hs-var">colInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
-&gt; HashMap
     (Column ('Postgres 'Vanilla))
     (AnnRedactionExpPartialSQL ('Postgres 'Vanilla))
forall (b :: BackendType).
SelPermInfo b -&gt; HashMap (Column b) (AnnRedactionExpPartialSQL b)
</span><a href="Hasura.Table.Cache.html#spiCols"><span class="hs-identifier hs-var">spiCols</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950406"><span class="hs-identifier hs-var">spi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>        </span><span id="local-6989586621687950420"><span class="annot"><a href="#local-6989586621687950420"><span class="hs-identifier hs-var">resolvedRedactionExp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SessionVariableBuilder m
-&gt; AnnRedactionExpPartialSQL ('Postgres 'Vanilla)
-&gt; m (AnnRedactionExp
        ('Postgres 'Vanilla) (SQLExpression ('Postgres 'Vanilla)))
forall (f :: * -&gt; *).
Applicative f =&gt;
SessionVariableBuilder f
-&gt; AnnRedactionExpPartialSQL ('Postgres 'Vanilla)
-&gt; f (AnnRedactionExp
        ('Postgres 'Vanilla) (SQLExpression ('Postgres 'Vanilla)))
</span><a href="Hasura.RQL.DML.Internal.html#convAnnRedactionExpPartialSQL"><span class="hs-identifier hs-var">convAnnRedactionExpPartialSQL</span></a></span><span> </span><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621687950404"><span class="hs-identifier hs-var">sessVarBldr</span></a></span><span> </span><span class="annot"><span class="annottext">AnnRedactionExpPartialSQL ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950416"><span class="hs-identifier hs-var">redactionExp</span></a></span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687950422"><span class="annot"><a href="#local-6989586621687950422"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla) -&gt; ColumnType ('Postgres 'Vanilla)
forall (b :: BackendType). ColumnInfo b -&gt; ColumnType b
</span><a href="Hasura.RQL.Types.Column.html#ciType"><span class="hs-identifier hs-var">ciType</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950413"><span class="hs-identifier hs-var">colInfo</span></a></span><span>
</span><span id="line-147"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Column.html#isScalarColumnWhere"><span class="hs-identifier hs-type">isScalarColumnWhere</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#isGeoType"><span class="hs-identifier hs-type">isGeoType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950422"><span class="hs-identifier hs-type">ty</span></a></span><span>
</span><span id="line-148"></span><span>          </span><span class="hs-keyword">then</span><span>
</span><span id="line-149"></span><span>            </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-type">throw400</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-type">UnexpectedPayload</span></a></span><span>
</span><span id="line-150"></span><span>              </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621687950408"><span class="hs-identifier hs-type">fldName</span></a></span><span>
</span><span id="line-151"></span><span>              </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-type">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; has type 'geometry' and cannot be used in order_by&quot;</span></span><span>
</span><span id="line-152"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.OrderBy.html#AOCColumn"><span class="hs-identifier hs-type">AOCColumn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950413"><span class="hs-identifier hs-type">colInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950420"><span class="hs-identifier hs-type">resolvedRedactionExp</span></a></span><span>
</span><span id="line-153"></span><span>      </span><span class="annot"><a href="Hasura.Table.Cache.html#FIRelationship"><span class="hs-identifier hs-type">FIRelationship</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres 'Vanilla)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><span class="annottext">Code
-&gt; Text -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-var">UnexpectedPayload</span></a></span><span>
</span><span id="line-155"></span><span>          </span><span class="annot"><span class="annottext">(Text -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp))
-&gt; Text -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687950408"><span class="hs-identifier hs-var">fldName</span></a></span><span>
</span><span id="line-156"></span><span>          </span><span class="annot"><span class="annottext">FieldName -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is a relationship and should be expanded&quot;</span></span><span>
</span><span id="line-157"></span><span>      </span><span class="annot"><a href="Hasura.Table.Cache.html#FIComputedField"><span class="hs-identifier hs-type">FIComputedField</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldInfo ('Postgres 'Vanilla)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><span class="annottext">Code
-&gt; Text -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-var">UnexpectedPayload</span></a></span><span>
</span><span id="line-159"></span><span>          </span><span class="annot"><span class="annottext">(Text -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp))
-&gt; Text -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687950408"><span class="hs-identifier hs-var">fldName</span></a></span><span>
</span><span id="line-160"></span><span>          </span><span class="annot"><span class="annottext">FieldName -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is a computed field and can't be used in 'order_by'&quot;</span></span><span>
</span><span id="line-161"></span><span>      </span><span class="hs-comment">-- TODO Rakesh (from master)</span><span>
</span><span id="line-162"></span><span>      </span><span class="annot"><a href="Hasura.Table.Cache.html#FIRemoteRelationship"><span class="hs-identifier hs-type">FIRemoteRelationship</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><span class="annottext">Code
-&gt; Text -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-var">UnexpectedPayload</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687950408"><span class="hs-identifier hs-var">fldName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is a remote field&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.OrderBy.html#OCRel"><span class="hs-identifier hs-type">OCRel</span></a></span><span> </span><span id="local-6989586621687950434"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687950434"><span class="hs-identifier hs-var">fldName</span></a></span></span><span> </span><span id="local-6989586621687950435"><span class="annot"><span class="annottext">OrderByCol
</span><a href="#local-6989586621687950435"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-165"></span><span>    </span><span id="local-6989586621687950436"><span class="annot"><a href="#local-6989586621687950436"><span class="hs-identifier hs-var">fldInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; FieldName -&gt; m (FieldInfo ('Postgres 'Vanilla))
forall (m :: * -&gt; *) fieldInfo.
MonadError QErr m =&gt;
FieldInfoMap fieldInfo -&gt; FieldName -&gt; m fieldInfo
</span><a href="Hasura.Table.Cache.html#askFieldInfo"><span class="hs-identifier hs-var">askFieldInfo</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950405"><span class="hs-identifier hs-var">flds</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687950434"><span class="hs-identifier hs-var">fldName</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621687950436"><span class="hs-identifier hs-type">fldInfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-167"></span><span>      </span><span class="annot"><a href="Hasura.Table.Cache.html#FIColumn"><span class="hs-identifier hs-type">FIColumn</span></a></span><span> </span><span class="annot"><span class="annottext">StructuredColumnInfo ('Postgres 'Vanilla)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-168"></span><span>        </span><span class="annot"><span class="annottext">Code
-&gt; Text -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-var">UnexpectedPayload</span></a></span><span>
</span><span id="line-169"></span><span>          </span><span class="annot"><span class="annottext">(Text -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp))
-&gt; Text -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687950434"><span class="hs-identifier hs-var">fldName</span></a></span><span>
</span><span id="line-170"></span><span>          </span><span class="annot"><span class="annottext">FieldName -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is a Postgres column and cannot be chained further&quot;</span></span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><a href="Hasura.Table.Cache.html#FIComputedField"><span class="hs-identifier hs-type">FIComputedField</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldInfo ('Postgres 'Vanilla)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">Code
-&gt; Text -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-var">UnexpectedPayload</span></a></span><span>
</span><span id="line-173"></span><span>          </span><span class="annot"><span class="annottext">(Text -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp))
-&gt; Text -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687950434"><span class="hs-identifier hs-var">fldName</span></a></span><span>
</span><span id="line-174"></span><span>          </span><span class="annot"><span class="annottext">FieldName -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is a computed field and can't be used in 'order_by'&quot;</span></span><span>
</span><span id="line-175"></span><span>      </span><span class="annot"><a href="Hasura.Table.Cache.html#FIRelationship"><span class="hs-identifier hs-type">FIRelationship</span></a></span><span> </span><span id="local-6989586621687950437"><span class="annot"><span class="annottext">RelInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950437"><span class="hs-identifier hs-var">relInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-176"></span><span>        </span><span id="local-6989586621687950438"><span class="annot"><a href="#local-6989586621687950438"><span class="hs-identifier hs-var">relTableName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres 'Vanilla) -&gt; RelTarget ('Postgres 'Vanilla)
forall (b :: BackendType). RelInfo b -&gt; RelTarget b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riTarget"><span class="hs-identifier hs-var">riTarget</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950437"><span class="hs-identifier hs-var">relInfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-177"></span><span>          </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelTargetTable"><span class="hs-identifier hs-type">RelTargetTable</span></a></span><span> </span><span id="local-6989586621687950439"><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950439"><span class="hs-identifier hs-var">tn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QualifiedTable -&gt; m QualifiedTable
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
QualifiedTable
</span><a href="#local-6989586621687950439"><span class="hs-identifier hs-var">tn</span></a></span><span>
</span><span id="line-178"></span><span>          </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelTargetNativeQuery"><span class="hs-identifier hs-type">RelTargetNativeQuery</span></a></span><span> </span><span class="annot"><span class="annottext">NativeQueryName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; m QualifiedTable
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;convOrderByElem RelTargetNativeQuery&quot;</span></span><span>
</span><span id="line-179"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#riType"><span class="hs-identifier hs-var">riType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950437"><span class="hs-identifier hs-type">relInfo</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#ArrRel"><span class="hs-identifier hs-type">ArrRel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>          </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-type">throw400</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-type">UnexpectedPayload</span></a></span><span>
</span><span id="line-181"></span><span>          </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621687950434"><span class="hs-identifier hs-type">fldName</span></a></span><span>
</span><span id="line-182"></span><span>          </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-type">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; is an array relationship and can't be used in 'order_by'&quot;</span></span><span>
</span><span id="line-183"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621687950443"><span class="annot"><a href="#local-6989586621687950443"><span class="hs-identifier hs-var">relFim</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687950444"><span class="annot"><a href="#local-6989586621687950444"><span class="hs-identifier hs-var">relSelPermInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#fetchRelDet"><span class="hs-identifier hs-type">fetchRelDet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#riName"><span class="hs-identifier hs-var">riName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950437"><span class="hs-identifier hs-type">relInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687950438"><span class="hs-identifier hs-type">relTableName</span></a></span><span>
</span><span id="line-184"></span><span>        </span><span id="local-6989586621687950445"><span class="annot"><a href="#local-6989586621687950445"><span class="hs-identifier hs-var">resolvedSelFltr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#convAnnBoolExpPartialSQL"><span class="hs-identifier hs-type">convAnnBoolExpPartialSQL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950404"><span class="hs-identifier hs-type">sessVarBldr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.Table.Cache.html#spiFilter"><span class="hs-identifier hs-var">spiFilter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950444"><span class="hs-identifier hs-type">relSelPermInfo</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.OrderBy.html#AOCObjectRelation"><span class="hs-identifier hs-type">AOCObjectRelation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950437"><span class="hs-identifier hs-type">relInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950445"><span class="hs-identifier hs-type">resolvedSelFltr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#convOrderByElem"><span class="hs-identifier hs-type">convOrderByElem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950404"><span class="hs-identifier hs-type">sessVarBldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621687950443"><span class="hs-identifier hs-type">relFim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621687950444"><span class="hs-identifier hs-type">relSelPermInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687950435"><span class="hs-identifier hs-type">rest</span></a></span><span>
</span><span id="line-186"></span><span>      </span><span class="annot"><a href="Hasura.Table.Cache.html#FIRemoteRelationship"><span class="hs-identifier hs-type">FIRemoteRelationship</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-187"></span><span>        </span><span class="annot"><span class="annottext">Code
-&gt; Text -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-var">UnexpectedPayload</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687950434"><span class="hs-identifier hs-var">fldName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is a remote field&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span id="local-6989586621687949843"><span class="annot"><a href="Hasura.RQL.DML.Select.html#convSelectQ"><span class="hs-identifier hs-type">convSelectQ</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949843"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949843"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#TableInfoRM"><span class="hs-identifier hs-type">TableInfoRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687949843"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><a href="Hasura.LogicalModel.Fields.html#LogicalModelFieldsRM"><span class="hs-identifier hs-type">LogicalModelFieldsRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687949843"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SQLGenCtx"><span class="hs-identifier hs-type">SQLGenCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><a href="Hasura.Table.Cache.html#FieldInfoMap"><span class="hs-identifier hs-type">FieldInfoMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Table.Cache.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- Table information of current table</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="Hasura.Table.Cache.html#SelPermInfo"><span class="hs-identifier hs-type">SelPermInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- Additional select permission info</span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#SelectQExt"><span class="hs-identifier hs-type">SelectQExt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- Given Select Query</span><span>
</span><span id="line-200"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#SessionVariableBuilder"><span class="hs-identifier hs-type">SessionVariableBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949843"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ValueParser"><span class="hs-identifier hs-type">ValueParser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687949843"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><a href="#local-6989586621687949843"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleSelect"><span class="hs-identifier hs-type">AnnSimpleSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-203"></span><span id="convSelectQ"><span class="annot"><span class="annottext">convSelectQ :: forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m,
 LogicalModelFieldsRM ('Postgres 'Vanilla) m) =&gt;
SQLGenCtx
-&gt; TableName ('Postgres 'Vanilla)
-&gt; FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; SelectQExt
-&gt; SessionVariableBuilder m
-&gt; ValueParser ('Postgres 'Vanilla) m SQLExp
-&gt; m (AnnSimpleSelect ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Select.html#convSelectQ"><span class="hs-identifier hs-var hs-var">convSelectQ</span></a></span></span><span> </span><span id="local-6989586621687950518"><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621687950518"><span class="hs-identifier hs-var">sqlGen</span></a></span></span><span> </span><span id="local-6989586621687950519"><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950519"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span id="local-6989586621687950520"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950520"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span></span><span> </span><span id="local-6989586621687950521"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950521"><span class="hs-identifier hs-var">selPermInfo</span></a></span></span><span> </span><span id="local-6989586621687950522"><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621687950522"><span class="hs-identifier hs-var">selQ</span></a></span></span><span> </span><span id="local-6989586621687950523"><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621687950523"><span class="hs-identifier hs-var">sessVarBldr</span></a></span></span><span> </span><span id="local-6989586621687950524"><span class="annot"><span class="annottext">ValueParser ('Postgres 'Vanilla) m SQLExp
</span><a href="#local-6989586621687950524"><span class="hs-identifier hs-var">prepValBldr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-comment">-- Convert where clause</span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621687950525"><span class="annot"><a href="#local-6989586621687950525"><span class="hs-identifier hs-var">wClause</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (BoolExp ('Postgres 'Vanilla))
-&gt; (BoolExp ('Postgres 'Vanilla)
    -&gt; m (AnnBoolExp ('Postgres 'Vanilla) SQLExp))
-&gt; m (Maybe (AnnBoolExp ('Postgres 'Vanilla) SQLExp))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectQExt -&gt; Maybe (BoolExp ('Postgres 'Vanilla))
forall a b c. SelectG a b c -&gt; Maybe b
</span><a href="Hasura.RQL.DML.Types.html#sqWhere"><span class="hs-identifier hs-var">sqWhere</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621687950522"><span class="hs-identifier hs-var">selQ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((BoolExp ('Postgres 'Vanilla)
  -&gt; m (AnnBoolExp ('Postgres 'Vanilla) SQLExp))
 -&gt; m (Maybe (AnnBoolExp ('Postgres 'Vanilla) SQLExp)))
-&gt; (BoolExp ('Postgres 'Vanilla)
    -&gt; m (AnnBoolExp ('Postgres 'Vanilla) SQLExp))
-&gt; m (Maybe (AnnBoolExp ('Postgres 'Vanilla) SQLExp))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687950527"><span class="annot"><span class="annottext">BoolExp ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950527"><span class="hs-identifier hs-var">boolExp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><span class="annottext">Text
-&gt; m (AnnBoolExp ('Postgres 'Vanilla) SQLExp)
-&gt; m (AnnBoolExp ('Postgres 'Vanilla) SQLExp)
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;where&quot;</span></span><span>
</span><span id="line-207"></span><span>      </span><span class="annot"><span class="annottext">(m (AnnBoolExp ('Postgres 'Vanilla) SQLExp)
 -&gt; m (AnnBoolExp ('Postgres 'Vanilla) SQLExp))
-&gt; m (AnnBoolExp ('Postgres 'Vanilla) SQLExp)
-&gt; m (AnnBoolExp ('Postgres 'Vanilla) SQLExp)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; BoolExp ('Postgres 'Vanilla)
-&gt; SessionVariableBuilder m
-&gt; FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; ValueParser
     ('Postgres 'Vanilla) m (SQLExpression ('Postgres 'Vanilla))
-&gt; m (AnnBoolExpSQL ('Postgres 'Vanilla))
forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m,
 LogicalModelFieldsRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; BoolExp ('Postgres 'Vanilla)
-&gt; SessionVariableBuilder m
-&gt; FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; ValueParser
     ('Postgres 'Vanilla) m (SQLExpression ('Postgres 'Vanilla))
-&gt; m (AnnBoolExpSQL ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Internal.html#convBoolExp"><span class="hs-identifier hs-var">convBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950520"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950521"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span> </span><span class="annot"><span class="annottext">BoolExp ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950527"><span class="hs-identifier hs-var">boolExp</span></a></span><span> </span><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621687950523"><span class="hs-identifier hs-var">sessVarBldr</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950520"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">ValueParser
  ('Postgres 'Vanilla) m (SQLExpression ('Postgres 'Vanilla))
ValueParser ('Postgres 'Vanilla) m SQLExp
</span><a href="#local-6989586621687950524"><span class="hs-identifier hs-var">prepValBldr</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>  </span><span id="local-6989586621687950529"><span class="annot"><a href="#local-6989586621687950529"><span class="hs-identifier hs-var">annFlds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-type">withPathK</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;columns&quot;</span></span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#indexedForM"><span class="hs-identifier hs-type">indexedForM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#sqColumns"><span class="hs-identifier hs-var">sqColumns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950522"><span class="hs-identifier hs-type">selQ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-212"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECSimple"><span class="hs-identifier hs-type">ECSimple</span></a></span><span> </span><span id="local-6989586621687950531"><span class="annot"><span class="annottext">Column ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950531"><span class="hs-identifier hs-var">pgCol</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-213"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621687950532"><span class="annot"><a href="#local-6989586621687950532"><span class="hs-identifier hs-var">colInfo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687950533"><span class="annot"><a href="#local-6989586621687950533"><span class="hs-identifier hs-var">redactionExp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; PGCol
-&gt; m (ColumnInfo ('Postgres 'Vanilla),
      AnnRedactionExpPartialSQL ('Postgres 'Vanilla))
forall (m :: * -&gt; *).
(UserInfoM m, QErrM m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; PGCol
-&gt; m (ColumnInfo ('Postgres 'Vanilla),
      AnnRedactionExpPartialSQL ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Select.html#convExtSimple"><span class="hs-identifier hs-var">convExtSimple</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950520"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950521"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Column ('Postgres 'Vanilla)
PGCol
</span><a href="#local-6989586621687950531"><span class="hs-identifier hs-var">pgCol</span></a></span><span>
</span><span id="line-214"></span><span>        </span><span id="local-6989586621687950535"><span class="annot"><a href="#local-6989586621687950535"><span class="hs-identifier hs-var">resolvedRedactionExp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#convAnnRedactionExpPartialSQL"><span class="hs-identifier hs-type">convAnnRedactionExpPartialSQL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950523"><span class="hs-identifier hs-type">sessVarBldr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950533"><span class="hs-identifier hs-type">redactionExp</span></a></span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#fromCol"><span class="hs-identifier hs-type">fromCol</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687950531"><span class="hs-identifier hs-type">pgCol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#mkAnnColumnField"><span class="hs-identifier hs-type">mkAnnColumnField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ciColumn"><span class="hs-identifier hs-var">ciColumn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950532"><span class="hs-identifier hs-type">colInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ciType"><span class="hs-identifier hs-var">ciType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950532"><span class="hs-identifier hs-type">colInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687950535"><span class="hs-identifier hs-type">resolvedRedactionExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECRel"><span class="hs-identifier hs-type">ECRel</span></a></span><span> </span><span id="local-6989586621687950538"><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687950538"><span class="hs-identifier hs-var">relName</span></a></span></span><span> </span><span id="local-6989586621687950539"><span class="annot"><span class="annottext">Maybe RelName
</span><a href="#local-6989586621687950539"><span class="hs-identifier hs-var">mAlias</span></a></span></span><span> </span><span id="local-6989586621687950540"><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621687950540"><span class="hs-identifier hs-var">relSelQ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-217"></span><span>        </span><span id="local-6989586621687950541"><span class="annot"><a href="#local-6989586621687950541"><span class="hs-identifier hs-var">annRel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-218"></span><span>          </span><span class="annot"><span class="annottext">SQLGenCtx
-&gt; FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; RelName
-&gt; Maybe RelName
-&gt; SelectQExt
-&gt; SessionVariableBuilder m
-&gt; ValueParser ('Postgres 'Vanilla) m SQLExp
-&gt; m (Either
        (ObjectRelationSelect ('Postgres 'Vanilla))
        (ArraySelect ('Postgres 'Vanilla)))
forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m,
 LogicalModelFieldsRM ('Postgres 'Vanilla) m) =&gt;
SQLGenCtx
-&gt; FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; RelName
-&gt; Maybe RelName
-&gt; SelectQExt
-&gt; SessionVariableBuilder m
-&gt; ValueParser ('Postgres 'Vanilla) m SQLExp
-&gt; m (Either
        (ObjectRelationSelect ('Postgres 'Vanilla))
        (ArraySelect ('Postgres 'Vanilla)))
</span><a href="Hasura.RQL.DML.Select.html#convExtRel"><span class="hs-identifier hs-var">convExtRel</span></a></span><span>
</span><span id="line-219"></span><span>            </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621687950518"><span class="hs-identifier hs-var">sqlGen</span></a></span><span>
</span><span id="line-220"></span><span>            </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950520"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span>
</span><span id="line-221"></span><span>            </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687950538"><span class="hs-identifier hs-var">relName</span></a></span><span>
</span><span id="line-222"></span><span>            </span><span class="annot"><span class="annottext">Maybe RelName
</span><a href="#local-6989586621687950539"><span class="hs-identifier hs-var">mAlias</span></a></span><span>
</span><span id="line-223"></span><span>            </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621687950540"><span class="hs-identifier hs-var">relSelQ</span></a></span><span>
</span><span id="line-224"></span><span>            </span><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621687950523"><span class="hs-identifier hs-var">sessVarBldr</span></a></span><span>
</span><span id="line-225"></span><span>            </span><span class="annot"><span class="annottext">ValueParser ('Postgres 'Vanilla) m SQLExp
</span><a href="#local-6989586621687950524"><span class="hs-identifier hs-var">prepValBldr</span></a></span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-227"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#fromRel"><span class="hs-identifier hs-type">fromRel</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromMaybe</span></span><span> </span><span class="annot"><a href="#local-6989586621687950538"><span class="hs-identifier hs-type">relName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950539"><span class="hs-identifier hs-type">mAlias</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-228"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">either</span></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFObjectRelation"><span class="hs-identifier hs-type">AFObjectRelation</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFArrayRelation"><span class="hs-identifier hs-type">AFArrayRelation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950541"><span class="hs-identifier hs-type">annRel</span></a></span><span>
</span><span id="line-229"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621687950547"><span class="annot"><a href="#local-6989586621687950547"><span class="hs-identifier hs-var">annOrdByML</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">forM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#sqOrderBy"><span class="hs-identifier hs-var">sqOrderBy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950522"><span class="hs-identifier hs-type">selQ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#OrderByExp"><span class="hs-identifier hs-type">OrderByExp</span></a></span><span> </span><span id="local-6989586621687950550"><span class="annot"><span class="annottext">[OrderByItem ('Postgres 'Vanilla)]
</span><a href="#local-6989586621687950550"><span class="hs-identifier hs-var">obItems</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><span class="annottext">Text
-&gt; m [OrderByItemG
        ('Postgres 'Vanilla)
        (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)]
-&gt; m [OrderByItemG
        ('Postgres 'Vanilla)
        (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)]
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;order_by&quot;</span></span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><span class="annottext">(m [OrderByItemG
      ('Postgres 'Vanilla)
      (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)]
 -&gt; m [OrderByItemG
         ('Postgres 'Vanilla)
         (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)])
-&gt; m [OrderByItemG
        ('Postgres 'Vanilla)
        (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)]
-&gt; m [OrderByItemG
        ('Postgres 'Vanilla)
        (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[OrderByItem ('Postgres 'Vanilla)]
-&gt; (OrderByItem ('Postgres 'Vanilla)
    -&gt; m (OrderByItemG
            ('Postgres 'Vanilla)
            (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)))
-&gt; m [OrderByItemG
        ('Postgres 'Vanilla)
        (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)]
forall (m :: * -&gt; *) a b. QErrM m =&gt; [a] -&gt; (a -&gt; m b) -&gt; m [b]
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#indexedForM"><span class="hs-identifier hs-var">indexedForM</span></a></span><span> </span><span class="annot"><span class="annottext">[OrderByItem ('Postgres 'Vanilla)]
</span><a href="#local-6989586621687950550"><span class="hs-identifier hs-var">obItems</span></a></span><span>
</span><span id="line-234"></span><span>      </span><span class="annot"><span class="annottext">((OrderByItem ('Postgres 'Vanilla)
  -&gt; m (OrderByItemG
          ('Postgres 'Vanilla)
          (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)))
 -&gt; m [OrderByItemG
         ('Postgres 'Vanilla)
         (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)])
-&gt; (OrderByItem ('Postgres 'Vanilla)
    -&gt; m (OrderByItemG
            ('Postgres 'Vanilla)
            (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)))
-&gt; m [OrderByItemG
        ('Postgres 'Vanilla)
        (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(OrderByCol
 -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp))
-&gt; OrderByItem ('Postgres 'Vanilla)
-&gt; m (OrderByItemG
        ('Postgres 'Vanilla)
        (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b)
-&gt; OrderByItemG ('Postgres 'Vanilla) a
-&gt; m (OrderByItemG ('Postgres 'Vanilla) b)
</span><span class="hs-identifier hs-var">mapM</span></span><span>
</span><span id="line-235"></span><span>      </span><span class="annot"><span class="annottext">((OrderByCol
  -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp))
 -&gt; OrderByItem ('Postgres 'Vanilla)
 -&gt; m (OrderByItemG
         ('Postgres 'Vanilla)
         (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)))
-&gt; (OrderByCol
    -&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp))
-&gt; OrderByItem ('Postgres 'Vanilla)
-&gt; m (OrderByItemG
        ('Postgres 'Vanilla)
        (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SessionVariableBuilder m
-&gt; (FieldInfoMap (FieldInfo ('Postgres 'Vanilla)),
    SelPermInfo ('Postgres 'Vanilla))
-&gt; OrderByCol
-&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)
forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
SessionVariableBuilder m
-&gt; (FieldInfoMap (FieldInfo ('Postgres 'Vanilla)),
    SelPermInfo ('Postgres 'Vanilla))
-&gt; OrderByCol
-&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)
</span><a href="Hasura.RQL.DML.Select.html#convOrderByElem"><span class="hs-identifier hs-var">convOrderByElem</span></a></span><span> </span><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621687950523"><span class="hs-identifier hs-var">sessVarBldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950520"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950521"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687950551"><span class="annot"><a href="#local-6989586621687950551"><span class="hs-identifier hs-var hs-var">annOrdByM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OrderByItemG
   ('Postgres 'Vanilla)
   (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)]
-&gt; Maybe
     (NonEmpty
        (OrderByItemG
           ('Postgres 'Vanilla)
           (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)))
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NE.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">([OrderByItemG
    ('Postgres 'Vanilla)
    (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)]
 -&gt; Maybe
      (NonEmpty
         (OrderByItemG
            ('Postgres 'Vanilla)
            (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp))))
-&gt; Maybe
     [OrderByItemG
        ('Postgres 'Vanilla)
        (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)]
-&gt; Maybe
     (NonEmpty
        (OrderByItemG
           ('Postgres 'Vanilla)
           (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)))
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe
  [OrderByItemG
     ('Postgres 'Vanilla)
     (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)]
</span><a href="#local-6989586621687950547"><span class="hs-identifier hs-var">annOrdByML</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-comment">-- validate limit and offset values</span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-type">withPathK</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;limit&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM_</span></span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#onlyPositiveInt"><span class="hs-identifier hs-type">onlyPositiveInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950556"><span class="hs-identifier hs-type">mQueryLimit</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-type">withPathK</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;offset&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM_</span></span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#onlyPositiveInt"><span class="hs-identifier hs-type">onlyPositiveInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950557"><span class="hs-identifier hs-type">mQueryOffset</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span>  </span><span id="local-6989586621687950558"><span class="annot"><a href="#local-6989586621687950558"><span class="hs-identifier hs-var">resolvedSelFltr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-244"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#convAnnBoolExpPartialSQL"><span class="hs-identifier hs-type">convAnnBoolExpPartialSQL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950523"><span class="hs-identifier hs-type">sessVarBldr</span></a></span><span>
</span><span id="line-245"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.Table.Cache.html#spiFilter"><span class="hs-identifier hs-var">spiFilter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950521"><span class="hs-identifier hs-type">selPermInfo</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687950559"><span class="annot"><a href="#local-6989586621687950559"><span class="hs-identifier hs-var hs-var">tabFrom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
-&gt; SelectFromG ('Postgres 'Vanilla) SQLExp
forall (b :: BackendType) v. TableName b -&gt; SelectFromG b v
</span><a href="Hasura.RQL.IR.Select.From.html#FromTable"><span class="hs-identifier hs-var">FromTable</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950519"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-248"></span><span>      </span><span id="local-6989586621687950561"><span class="annot"><a href="#local-6989586621687950561"><span class="hs-identifier hs-var hs-var">tabPerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnnBoolExp ('Postgres 'Vanilla) SQLExp
-&gt; Maybe Int -&gt; TablePermG ('Postgres 'Vanilla) SQLExp
forall (b :: BackendType) v.
AnnBoolExp b v -&gt; Maybe Int -&gt; TablePermG b v
</span><a href="Hasura.RQL.IR.Select.TablePerm.html#TablePerm"><span class="hs-identifier hs-var">TablePerm</span></a></span><span> </span><span class="annot"><span class="annottext">AnnBoolExp ('Postgres 'Vanilla) SQLExp
</span><a href="#local-6989586621687950558"><span class="hs-identifier hs-var">resolvedSelFltr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687950563"><span class="hs-identifier hs-var">mPermLimit</span></a></span><span>
</span><span id="line-249"></span><span>      </span><span id="local-6989586621687950564"><span class="annot"><a href="#local-6989586621687950564"><span class="hs-identifier hs-var hs-var">tabArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (AnnBoolExp ('Postgres 'Vanilla) SQLExp)
-&gt; Maybe
     (NonEmpty
        (OrderByItemG
           ('Postgres 'Vanilla)
           (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)))
-&gt; Maybe Int
-&gt; Maybe Int64
-&gt; Maybe (NonEmpty (AnnDistinctColumn ('Postgres 'Vanilla) SQLExp))
-&gt; SelectArgsG ('Postgres 'Vanilla) SQLExp
forall (b :: BackendType) v.
Maybe (AnnBoolExp b v)
-&gt; Maybe (NonEmpty (AnnotatedOrderByItemG b v))
-&gt; Maybe Int
-&gt; Maybe Int64
-&gt; Maybe (NonEmpty (AnnDistinctColumn b v))
-&gt; SelectArgsG b v
</span><a href="Hasura.RQL.IR.Select.Args.html#SelectArgs"><span class="hs-identifier hs-var">SelectArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (AnnBoolExp ('Postgres 'Vanilla) SQLExp)
</span><a href="#local-6989586621687950525"><span class="hs-identifier hs-var">wClause</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe
  (NonEmpty
     (OrderByItemG
        ('Postgres 'Vanilla)
        (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)))
</span><a href="#local-6989586621687950551"><span class="hs-identifier hs-var">annOrdByM</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687950556"><span class="hs-identifier hs-var">mQueryLimit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int64) -&gt; Maybe Int -&gt; Maybe Int64
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687950557"><span class="hs-identifier hs-var">mQueryOffset</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty (AnnDistinctColumn ('Postgres 'Vanilla) SQLExp))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-250"></span><span>      </span><span id="local-6989586621687950566"><span class="annot"><a href="#local-6989586621687950566"><span class="hs-identifier hs-var hs-var">strfyNum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SQLGenCtx -&gt; StringifyNumbers
</span><a href="Hasura.RQL.Types.Common.html#stringifyNum"><span class="hs-identifier hs-var">stringifyNum</span></a></span><span> </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621687950518"><span class="hs-identifier hs-var">sqlGen</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.AnnSelectG.html#AnnSelectG"><span class="hs-identifier hs-type">AnnSelectG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950529"><span class="hs-identifier hs-type">annFlds</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950559"><span class="hs-identifier hs-type">tabFrom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950561"><span class="hs-identifier hs-type">tabPerm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950564"><span class="hs-identifier hs-type">tabArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950566"><span class="hs-identifier hs-type">strfyNum</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-253"></span><span>    </span><span id="local-6989586621687950557"><span class="annot"><span class="annottext">mQueryOffset :: Maybe Int
</span><a href="#local-6989586621687950557"><span class="hs-identifier hs-var hs-var">mQueryOffset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectQExt -&gt; Maybe Int
forall a b c. SelectG a b c -&gt; Maybe c
</span><a href="Hasura.RQL.DML.Types.html#sqOffset"><span class="hs-identifier hs-var">sqOffset</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621687950522"><span class="hs-identifier hs-var">selQ</span></a></span><span>
</span><span id="line-254"></span><span>    </span><span id="local-6989586621687950556"><span class="annot"><span class="annottext">mQueryLimit :: Maybe Int
</span><a href="#local-6989586621687950556"><span class="hs-identifier hs-var hs-var">mQueryLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectQExt -&gt; Maybe Int
forall a b c. SelectG a b c -&gt; Maybe c
</span><a href="Hasura.RQL.DML.Types.html#sqLimit"><span class="hs-identifier hs-var">sqLimit</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621687950522"><span class="hs-identifier hs-var">selQ</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621687950563"><span class="annot"><span class="annottext">mPermLimit :: Maybe Int
</span><a href="#local-6989586621687950563"><span class="hs-identifier hs-var hs-var">mPermLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla) -&gt; Maybe Int
forall (b :: BackendType). SelPermInfo b -&gt; Maybe Int
</span><a href="Hasura.Table.Cache.html#spiLimit"><span class="hs-identifier hs-var">spiLimit</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950521"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span id="local-6989586621687949859"><span class="annot"><a href="Hasura.RQL.DML.Select.html#convExtSimple"><span class="hs-identifier hs-type">convExtSimple</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949859"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949859"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><a href="Hasura.Table.Cache.html#FieldInfoMap"><span class="hs-identifier hs-type">FieldInfoMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Table.Cache.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><a href="Hasura.Table.Cache.html#SelPermInfo"><span class="hs-identifier hs-type">SelPermInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-261"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#PGCol"><span class="hs-identifier hs-type">PGCol</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><a href="#local-6989586621687949859"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html#AnnRedactionExpPartialSQL"><span class="hs-identifier hs-type">AnnRedactionExpPartialSQL</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-263"></span><span id="convExtSimple"><span class="annot"><span class="annottext">convExtSimple :: forall (m :: * -&gt; *).
(UserInfoM m, QErrM m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; PGCol
-&gt; m (ColumnInfo ('Postgres 'Vanilla),
      AnnRedactionExpPartialSQL ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Select.html#convExtSimple"><span class="hs-identifier hs-var hs-var">convExtSimple</span></a></span></span><span> </span><span id="local-6989586621687950585"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950585"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span></span><span> </span><span id="local-6989586621687950586"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950586"><span class="hs-identifier hs-var">selPermInfo</span></a></span></span><span> </span><span id="local-6989586621687950587"><span class="annot"><span class="annottext">PGCol
</span><a href="#local-6989586621687950587"><span class="hs-identifier hs-var">pgCol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-264"></span><span>  </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
-&gt; Column ('Postgres 'Vanilla) -&gt; m ()
forall (m :: * -&gt; *).
(UserInfoM m, QErrM m) =&gt;
SelPermInfo ('Postgres 'Vanilla)
-&gt; Column ('Postgres 'Vanilla) -&gt; m ()
</span><a href="Hasura.RQL.DML.Internal.html#checkSelOnCol"><span class="hs-identifier hs-var">checkSelOnCol</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950586"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Column ('Postgres 'Vanilla)
PGCol
</span><a href="#local-6989586621687950587"><span class="hs-identifier hs-var">pgCol</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621687950588"><span class="annot"><a href="#local-6989586621687950588"><span class="hs-identifier hs-var">colInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; Column ('Postgres 'Vanilla)
-&gt; Text
-&gt; m (ColumnInfo ('Postgres 'Vanilla))
forall (m :: * -&gt; *) (backend :: BackendType).
(MonadError QErr m, Backend backend) =&gt;
FieldInfoMap (FieldInfo backend)
-&gt; Column backend -&gt; Text -&gt; m (ColumnInfo backend)
</span><a href="Hasura.Table.Cache.html#askColInfo"><span class="hs-identifier hs-var">askColInfo</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950585"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">Column ('Postgres 'Vanilla)
PGCol
</span><a href="#local-6989586621687950587"><span class="hs-identifier hs-var">pgCol</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687950590"><span class="hs-identifier hs-var">relWhenPGErr</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621687950588"><span class="hs-identifier hs-type">colInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromMaybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html#NoRedaction"><span class="hs-identifier hs-type">NoRedaction</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#lookup"><span class="hs-identifier hs-type">HashMap.lookup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950587"><span class="hs-identifier hs-type">pgCol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Table.Cache.html#spiCols"><span class="hs-identifier hs-var">spiCols</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950586"><span class="hs-identifier hs-type">selPermInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621687950590"><span class="annot"><span class="annottext">relWhenPGErr :: Text
</span><a href="#local-6989586621687950590"><span class="hs-identifier hs-var hs-var">relWhenPGErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;relationships have to be expanded&quot;</span></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span id="local-6989586621687949870"><span class="annot"><a href="Hasura.RQL.DML.Select.html#convExtRel"><span class="hs-identifier hs-type">convExtRel</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949870"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949870"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#TableInfoRM"><span class="hs-identifier hs-type">TableInfoRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687949870"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><a href="Hasura.LogicalModel.Fields.html#LogicalModelFieldsRM"><span class="hs-identifier hs-type">LogicalModelFieldsRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687949870"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-276"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SQLGenCtx"><span class="hs-identifier hs-type">SQLGenCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><a href="Hasura.Table.Cache.html#FieldInfoMap"><span class="hs-identifier hs-type">FieldInfoMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Table.Cache.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#RelName"><span class="hs-identifier hs-type">RelName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-279"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#RelName"><span class="hs-identifier hs-type">RelName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-280"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#SelectQExt"><span class="hs-identifier hs-type">SelectQExt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#SessionVariableBuilder"><span class="hs-identifier hs-type">SessionVariableBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949870"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-282"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ValueParser"><span class="hs-identifier hs-type">ValueParser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687949870"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><a href="#local-6989586621687949870"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ObjectRelationSelect"><span class="hs-identifier hs-type">ObjectRelationSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ArraySelect"><span class="hs-identifier hs-type">ArraySelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-284"></span><span id="convExtRel"><span class="annot"><span class="annottext">convExtRel :: forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m,
 LogicalModelFieldsRM ('Postgres 'Vanilla) m) =&gt;
SQLGenCtx
-&gt; FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; RelName
-&gt; Maybe RelName
-&gt; SelectQExt
-&gt; SessionVariableBuilder m
-&gt; ValueParser ('Postgres 'Vanilla) m SQLExp
-&gt; m (Either
        (ObjectRelationSelect ('Postgres 'Vanilla))
        (ArraySelect ('Postgres 'Vanilla)))
</span><a href="Hasura.RQL.DML.Select.html#convExtRel"><span class="hs-identifier hs-var hs-var">convExtRel</span></a></span></span><span> </span><span id="local-6989586621687950621"><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621687950621"><span class="hs-identifier hs-var">sqlGen</span></a></span></span><span> </span><span id="local-6989586621687950622"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950622"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span></span><span> </span><span id="local-6989586621687950623"><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687950623"><span class="hs-identifier hs-var">relName</span></a></span></span><span> </span><span id="local-6989586621687950624"><span class="annot"><span class="annottext">Maybe RelName
</span><a href="#local-6989586621687950624"><span class="hs-identifier hs-var">mAlias</span></a></span></span><span> </span><span id="local-6989586621687950625"><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621687950625"><span class="hs-identifier hs-var">selQ</span></a></span></span><span> </span><span id="local-6989586621687950626"><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621687950626"><span class="hs-identifier hs-var">sessVarBldr</span></a></span></span><span> </span><span id="local-6989586621687950627"><span class="annot"><span class="annottext">ValueParser ('Postgres 'Vanilla) m SQLExp
</span><a href="#local-6989586621687950627"><span class="hs-identifier hs-var">prepValBldr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-comment">-- Point to the name key</span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621687950628"><span class="annot"><a href="#local-6989586621687950628"><span class="hs-identifier hs-var">relInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><span class="annottext">Text
-&gt; m (RelInfo ('Postgres 'Vanilla))
-&gt; m (RelInfo ('Postgres 'Vanilla))
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;name&quot;</span></span><span>
</span><span id="line-288"></span><span>      </span><span class="annot"><span class="annottext">(m (RelInfo ('Postgres 'Vanilla))
 -&gt; m (RelInfo ('Postgres 'Vanilla)))
-&gt; m (RelInfo ('Postgres 'Vanilla))
-&gt; m (RelInfo ('Postgres 'Vanilla))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; RelName -&gt; Text -&gt; m (RelInfo ('Postgres 'Vanilla))
forall (m :: * -&gt; *) (backend :: BackendType).
MonadError QErr m =&gt;
FieldInfoMap (FieldInfo backend)
-&gt; RelName -&gt; Text -&gt; m (RelInfo backend)
</span><a href="Hasura.Table.Cache.html#askRelType"><span class="hs-identifier hs-var">askRelType</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950622"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687950623"><span class="hs-identifier hs-var">relName</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687950629"><span class="hs-identifier hs-var">pgWhenRelErr</span></a></span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelInfo"><span class="hs-identifier hs-type">RelInfo</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#riType"><span class="hs-identifier hs-var">riType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621687950630"><span class="annot"><a href="#local-6989586621687950630"><span class="hs-identifier hs-var">relTy</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#riMapping"><span class="hs-identifier hs-var">riMapping</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelMapping"><span class="hs-identifier hs-type">RelMapping</span></a></span><span> </span><span id="local-6989586621687950633"><span class="annot"><a href="#local-6989586621687950633"><span class="hs-identifier hs-var">colMapping</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#riTarget"><span class="hs-identifier hs-var">riTarget</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621687950634"><span class="annot"><a href="#local-6989586621687950634"><span class="hs-identifier hs-var">relTarget</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621687950628"><span class="hs-identifier hs-type">relInfo</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621687950635"><span class="annot"><a href="#local-6989586621687950635"><span class="hs-identifier hs-var">relTableName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621687950634"><span class="hs-identifier hs-type">relTarget</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-291"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelTargetNativeQuery"><span class="hs-identifier hs-type">RelTargetNativeQuery</span></a></span><span> </span><span class="annot"><span class="annottext">NativeQueryName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; m QualifiedTable
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;convExtRel RelTargetNativeQuery&quot;</span></span><span>
</span><span id="line-292"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelTargetTable"><span class="hs-identifier hs-type">RelTargetTable</span></a></span><span> </span><span id="local-6989586621687950636"><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950636"><span class="hs-identifier hs-var">tn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QualifiedTable -&gt; m QualifiedTable
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
QualifiedTable
</span><a href="#local-6989586621687950636"><span class="hs-identifier hs-var">tn</span></a></span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621687950637"><span class="annot"><a href="#local-6989586621687950637"><span class="hs-identifier hs-var">relCIM</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687950638"><span class="annot"><a href="#local-6989586621687950638"><span class="hs-identifier hs-var">relSPI</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#fetchRelDet"><span class="hs-identifier hs-type">fetchRelDet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950623"><span class="hs-identifier hs-type">relName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950635"><span class="hs-identifier hs-type">relTableName</span></a></span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621687950639"><span class="annot"><a href="#local-6989586621687950639"><span class="hs-identifier hs-var">annSel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#convSelectQ"><span class="hs-identifier hs-type">convSelectQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950621"><span class="hs-identifier hs-type">sqlGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950635"><span class="hs-identifier hs-type">relTableName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950637"><span class="hs-identifier hs-type">relCIM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950638"><span class="hs-identifier hs-type">relSPI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950625"><span class="hs-identifier hs-type">selQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950626"><span class="hs-identifier hs-type">sessVarBldr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950627"><span class="hs-identifier hs-type">prepValBldr</span></a></span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621687950630"><span class="hs-identifier hs-type">relTy</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><span class="annottext">RelType
</span><a href="Hasura.RQL.Types.Common.html#ObjRel"><span class="hs-identifier hs-var">ObjRel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-297"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687950641"><span class="hs-identifier hs-var">misused</span></a></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-var">UnexpectedPayload</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687950642"><span class="hs-identifier hs-var">objRelMisuseMsg</span></a></span><span>
</span><span id="line-298"></span><span>      </span><span class="annot"><span class="annottext">Either
  (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
  (ArraySelectG ('Postgres 'Vanilla) Void SQLExp)
-&gt; m (Either
        (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
        (ArraySelectG ('Postgres 'Vanilla) Void SQLExp))
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-299"></span><span>        </span><span class="annot"><span class="annottext">(Either
   (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
   (ArraySelectG ('Postgres 'Vanilla) Void SQLExp)
 -&gt; m (Either
         (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
         (ArraySelectG ('Postgres 'Vanilla) Void SQLExp)))
-&gt; Either
     (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
     (ArraySelectG ('Postgres 'Vanilla) Void SQLExp)
-&gt; m (Either
        (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
        (ArraySelectG ('Postgres 'Vanilla) Void SQLExp))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp
-&gt; Either
     (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
     (ArraySelectG ('Postgres 'Vanilla) Void SQLExp)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span>
</span><span id="line-300"></span><span>        </span><span class="annot"><span class="annottext">(ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp
 -&gt; Either
      (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
      (ArraySelectG ('Postgres 'Vanilla) Void SQLExp))
-&gt; ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp
-&gt; Either
     (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
     (ArraySelectG ('Postgres 'Vanilla) Void SQLExp)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RelName
-&gt; HashMap
     (ColumnPath ('Postgres 'Vanilla)) (ColumnPath ('Postgres 'Vanilla))
-&gt; Nullable
-&gt; AnnObjectSelectG ('Postgres 'Vanilla) Void SQLExp
-&gt; ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp
forall (b :: BackendType) a.
RelName
-&gt; HashMap (ColumnPath b) (ColumnPath b)
-&gt; Nullable
-&gt; a
-&gt; AnnRelationSelectG b a
</span><a href="Hasura.RQL.IR.Select.RelationSelect.html#AnnRelationSelectG"><span class="hs-identifier hs-var">AnnRelationSelectG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RelName -&gt; Maybe RelName -&gt; RelName
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687950623"><span class="hs-identifier hs-var">relName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RelName
</span><a href="#local-6989586621687950624"><span class="hs-identifier hs-var">mAlias</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashMap
  (ColumnPath ('Postgres 'Vanilla)) (ColumnPath ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950633"><span class="hs-identifier hs-var">colMapping</span></a></span><span> </span><span class="annot"><span class="annottext">Nullable
</span><a href="Hasura.RQL.Types.Relationships.Local.html#Nullable"><span class="hs-identifier hs-var">Nullable</span></a></span><span>
</span><span id="line-301"></span><span>        </span><span class="annot"><span class="annottext">(AnnObjectSelectG ('Postgres 'Vanilla) Void SQLExp
 -&gt; ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
-&gt; AnnObjectSelectG ('Postgres 'Vanilla) Void SQLExp
-&gt; ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(FieldName, AnnFieldG ('Postgres 'Vanilla) Void SQLExp)]
-&gt; SelectFromG ('Postgres 'Vanilla) SQLExp
-&gt; AnnBoolExp ('Postgres 'Vanilla) SQLExp
-&gt; AnnObjectSelectG ('Postgres 'Vanilla) Void SQLExp
forall (b :: BackendType) r v.
AnnFieldsG b r v
-&gt; SelectFromG b v -&gt; AnnBoolExp b v -&gt; AnnObjectSelectG b r v
</span><a href="Hasura.RQL.IR.Select.html#AnnObjectSelectG"><span class="hs-identifier hs-var">AnnObjectSelectG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnSelectG
  ('Postgres 'Vanilla) (AnnFieldG ('Postgres 'Vanilla) Void) SQLExp
-&gt; [(FieldName, AnnFieldG ('Postgres 'Vanilla) Void SQLExp)]
forall (b :: BackendType) (f :: * -&gt; *) v.
AnnSelectG b f v -&gt; Fields (f v)
</span><a href="Hasura.RQL.IR.Select.AnnSelectG.html#_asnFields"><span class="hs-identifier hs-var">_asnFields</span></a></span><span> </span><span class="annot"><span class="annottext">AnnSelectG
  ('Postgres 'Vanilla) (AnnFieldG ('Postgres 'Vanilla) Void) SQLExp
</span><a href="#local-6989586621687950639"><span class="hs-identifier hs-var">annSel</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
-&gt; SelectFromG ('Postgres 'Vanilla) SQLExp
forall (b :: BackendType) v. TableName b -&gt; SelectFromG b v
</span><a href="Hasura.RQL.IR.Select.From.html#FromTable"><span class="hs-identifier hs-var">FromTable</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
QualifiedTable
</span><a href="#local-6989586621687950635"><span class="hs-identifier hs-var">relTableName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>        </span><span class="annot"><span class="annottext">(AnnBoolExp ('Postgres 'Vanilla) SQLExp
 -&gt; AnnObjectSelectG ('Postgres 'Vanilla) Void SQLExp)
-&gt; AnnBoolExp ('Postgres 'Vanilla) SQLExp
-&gt; AnnObjectSelectG ('Postgres 'Vanilla) Void SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TablePermG ('Postgres 'Vanilla) SQLExp
-&gt; AnnBoolExp ('Postgres 'Vanilla) SQLExp
forall (b :: BackendType) v. TablePermG b v -&gt; AnnBoolExp b v
</span><a href="Hasura.RQL.IR.Select.TablePerm.html#_tpFilter"><span class="hs-identifier hs-var">_tpFilter</span></a></span><span>
</span><span id="line-303"></span><span>        </span><span class="annot"><span class="annottext">(TablePermG ('Postgres 'Vanilla) SQLExp
 -&gt; AnnBoolExp ('Postgres 'Vanilla) SQLExp)
-&gt; TablePermG ('Postgres 'Vanilla) SQLExp
-&gt; AnnBoolExp ('Postgres 'Vanilla) SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AnnSelectG
  ('Postgres 'Vanilla) (AnnFieldG ('Postgres 'Vanilla) Void) SQLExp
-&gt; TablePermG ('Postgres 'Vanilla) SQLExp
forall (b :: BackendType) (f :: * -&gt; *) v.
AnnSelectG b f v -&gt; TablePermG b v
</span><a href="Hasura.RQL.IR.Select.AnnSelectG.html#_asnPerm"><span class="hs-identifier hs-var">_asnPerm</span></a></span><span> </span><span class="annot"><span class="annottext">AnnSelectG
  ('Postgres 'Vanilla) (AnnFieldG ('Postgres 'Vanilla) Void) SQLExp
</span><a href="#local-6989586621687950639"><span class="hs-identifier hs-var">annSel</span></a></span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><span class="annottext">RelType
</span><a href="Hasura.RQL.Types.Common.html#ArrRel"><span class="hs-identifier hs-var">ArrRel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-305"></span><span>      </span><span class="annot"><span class="annottext">Either
  (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
  (ArraySelectG ('Postgres 'Vanilla) Void SQLExp)
-&gt; m (Either
        (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
        (ArraySelectG ('Postgres 'Vanilla) Void SQLExp))
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-306"></span><span>        </span><span class="annot"><span class="annottext">(Either
   (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
   (ArraySelectG ('Postgres 'Vanilla) Void SQLExp)
 -&gt; m (Either
         (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
         (ArraySelectG ('Postgres 'Vanilla) Void SQLExp)))
-&gt; Either
     (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
     (ArraySelectG ('Postgres 'Vanilla) Void SQLExp)
-&gt; m (Either
        (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
        (ArraySelectG ('Postgres 'Vanilla) Void SQLExp))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArraySelectG ('Postgres 'Vanilla) Void SQLExp
-&gt; Either
     (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
     (ArraySelectG ('Postgres 'Vanilla) Void SQLExp)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-307"></span><span>        </span><span class="annot"><span class="annottext">(ArraySelectG ('Postgres 'Vanilla) Void SQLExp
 -&gt; Either
      (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
      (ArraySelectG ('Postgres 'Vanilla) Void SQLExp))
-&gt; ArraySelectG ('Postgres 'Vanilla) Void SQLExp
-&gt; Either
     (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
     (ArraySelectG ('Postgres 'Vanilla) Void SQLExp)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArrayRelationSelectG ('Postgres 'Vanilla) Void SQLExp
-&gt; ArraySelectG ('Postgres 'Vanilla) Void SQLExp
forall (b :: BackendType) r v.
ArrayRelationSelectG b r v -&gt; ArraySelectG b r v
</span><a href="Hasura.RQL.IR.Select.html#ASSimple"><span class="hs-identifier hs-var">ASSimple</span></a></span><span>
</span><span id="line-308"></span><span>        </span><span class="annot"><span class="annottext">(ArrayRelationSelectG ('Postgres 'Vanilla) Void SQLExp
 -&gt; ArraySelectG ('Postgres 'Vanilla) Void SQLExp)
-&gt; ArrayRelationSelectG ('Postgres 'Vanilla) Void SQLExp
-&gt; ArraySelectG ('Postgres 'Vanilla) Void SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RelName
-&gt; HashMap
     (ColumnPath ('Postgres 'Vanilla)) (ColumnPath ('Postgres 'Vanilla))
-&gt; Nullable
-&gt; AnnSelectG
     ('Postgres 'Vanilla) (AnnFieldG ('Postgres 'Vanilla) Void) SQLExp
-&gt; ArrayRelationSelectG ('Postgres 'Vanilla) Void SQLExp
forall (b :: BackendType) a.
RelName
-&gt; HashMap (ColumnPath b) (ColumnPath b)
-&gt; Nullable
-&gt; a
-&gt; AnnRelationSelectG b a
</span><a href="Hasura.RQL.IR.Select.RelationSelect.html#AnnRelationSelectG"><span class="hs-identifier hs-var">AnnRelationSelectG</span></a></span><span>
</span><span id="line-309"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RelName -&gt; Maybe RelName -&gt; RelName
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687950623"><span class="hs-identifier hs-var">relName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RelName
</span><a href="#local-6989586621687950624"><span class="hs-identifier hs-var">mAlias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>          </span><span class="annot"><span class="annottext">HashMap
  (ColumnPath ('Postgres 'Vanilla)) (ColumnPath ('Postgres 'Vanilla))
</span><a href="#local-6989586621687950633"><span class="hs-identifier hs-var">colMapping</span></a></span><span>
</span><span id="line-311"></span><span>          </span><span class="annot"><span class="annottext">Nullable
</span><a href="Hasura.RQL.Types.Relationships.Local.html#Nullable"><span class="hs-identifier hs-var">Nullable</span></a></span><span>
</span><span id="line-312"></span><span>          </span><span class="annot"><span class="annottext">AnnSelectG
  ('Postgres 'Vanilla) (AnnFieldG ('Postgres 'Vanilla) Void) SQLExp
</span><a href="#local-6989586621687950639"><span class="hs-identifier hs-var">annSel</span></a></span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621687950629"><span class="annot"><span class="annottext">pgWhenRelErr :: Text
</span><a href="#local-6989586621687950629"><span class="hs-identifier hs-var hs-var">pgWhenRelErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;only relationships can be expanded&quot;</span></span><span>
</span><span id="line-315"></span><span>    </span><span id="local-6989586621687950641"><span class="annot"><span class="annottext">misused :: Bool
</span><a href="#local-6989586621687950641"><span class="hs-identifier hs-var hs-var">misused</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-316"></span><span>      </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span>
</span><span id="line-317"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Maybe (BoolExp ('Postgres 'Vanilla)) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectQExt -&gt; Maybe (BoolExp ('Postgres 'Vanilla))
forall a b c. SelectG a b c -&gt; Maybe b
</span><a href="Hasura.RQL.DML.Types.html#sqWhere"><span class="hs-identifier hs-var">sqWhere</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621687950625"><span class="hs-identifier hs-var">selQ</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-318"></span><span>          </span><span class="annot"><span class="annottext">Maybe Int -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectQExt -&gt; Maybe Int
forall a b c. SelectG a b c -&gt; Maybe c
</span><a href="Hasura.RQL.DML.Types.html#sqLimit"><span class="hs-identifier hs-var">sqLimit</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621687950625"><span class="hs-identifier hs-var">selQ</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-319"></span><span>          </span><span class="annot"><span class="annottext">Maybe Int -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectQExt -&gt; Maybe Int
forall a b c. SelectG a b c -&gt; Maybe c
</span><a href="Hasura.RQL.DML.Types.html#sqOffset"><span class="hs-identifier hs-var">sqOffset</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621687950625"><span class="hs-identifier hs-var">selQ</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-320"></span><span>          </span><span class="annot"><span class="annottext">Maybe OrderByExp -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectQExt -&gt; Maybe OrderByExp
forall a b c. SelectG a b c -&gt; Maybe OrderByExp
</span><a href="Hasura.RQL.DML.Types.html#sqOrderBy"><span class="hs-identifier hs-var">sqOrderBy</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621687950625"><span class="hs-identifier hs-var">selQ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621687950642"><span class="annot"><span class="annottext">objRelMisuseMsg :: Text
</span><a href="#local-6989586621687950642"><span class="hs-identifier hs-var hs-var">objRelMisuseMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-323"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;when selecting an 'obj_relationship' 'where', 'order_by', 'limit' and 'offset'  can't be used&quot;</span></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span id="local-6989586621687949944"><span class="annot"><a href="Hasura.RQL.DML.Select.html#convSelectQuery"><span class="hs-identifier hs-type">convSelectQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949944"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949944"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#TableInfoRM"><span class="hs-identifier hs-type">TableInfoRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687949944"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><a href="Hasura.LogicalModel.Fields.html#LogicalModelFieldsRM"><span class="hs-identifier hs-type">LogicalModelFieldsRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687949944"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-331"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SQLGenCtx"><span class="hs-identifier hs-type">SQLGenCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-332"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#SessionVariableBuilder"><span class="hs-identifier hs-type">SessionVariableBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949944"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-333"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ValueParser"><span class="hs-identifier hs-type">ValueParser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687949944"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-334"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelectQuery"><span class="hs-identifier hs-type">SelectQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-335"></span><span>  </span><span class="annot"><a href="#local-6989586621687949944"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleSelect"><span class="hs-identifier hs-type">AnnSimpleSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-336"></span><span id="convSelectQuery"><span class="annot"><span class="annottext">convSelectQuery :: forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m,
 LogicalModelFieldsRM ('Postgres 'Vanilla) m) =&gt;
SQLGenCtx
-&gt; SessionVariableBuilder m
-&gt; ValueParser ('Postgres 'Vanilla) m SQLExp
-&gt; SelectQuery
-&gt; m (AnnSimpleSelect ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Select.html#convSelectQuery"><span class="hs-identifier hs-var hs-var">convSelectQuery</span></a></span></span><span> </span><span id="local-6989586621687950679"><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621687950679"><span class="hs-identifier hs-var">sqlGen</span></a></span></span><span> </span><span id="local-6989586621687950680"><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621687950680"><span class="hs-identifier hs-var">sessVarBldr</span></a></span></span><span> </span><span id="local-6989586621687950681"><span class="annot"><span class="annottext">ValueParser ('Postgres 'Vanilla) m SQLExp
</span><a href="#local-6989586621687950681"><span class="hs-identifier hs-var">prepArgBuilder</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#DMLQuery"><span class="hs-identifier hs-type">DMLQuery</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687950683"><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621687950683"><span class="hs-identifier hs-var">qt</span></a></span></span><span> </span><span id="local-6989586621687950684"><span class="annot"><span class="annottext">SelectQ
</span><a href="#local-6989586621687950684"><span class="hs-identifier hs-var">selQ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-337"></span><span>  </span><span id="local-6989586621687950685"><span class="annot"><a href="#local-6989586621687950685"><span class="hs-identifier hs-var">tabInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; m (TableInfo ('Postgres 'Vanilla))
-&gt; m (TableInfo ('Postgres 'Vanilla))
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;table&quot;</span></span><span> </span><span class="annot"><span class="annottext">(m (TableInfo ('Postgres 'Vanilla))
 -&gt; m (TableInfo ('Postgres 'Vanilla)))
-&gt; m (TableInfo ('Postgres 'Vanilla))
-&gt; m (TableInfo ('Postgres 'Vanilla))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
-&gt; m (TableInfo ('Postgres 'Vanilla))
forall (m :: * -&gt; *).
(QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
TableName ('Postgres 'Vanilla)
-&gt; m (TableInfo ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Internal.html#askTableInfoSource"><span class="hs-identifier hs-var">askTableInfoSource</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
QualifiedTable
</span><a href="#local-6989586621687950683"><span class="hs-identifier hs-var">qt</span></a></span><span>
</span><span id="line-338"></span><span>  </span><span id="local-6989586621687950687"><span class="annot"><a href="#local-6989586621687950687"><span class="hs-identifier hs-var">selPermInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#askSelPermInfo"><span class="hs-identifier hs-type">askSelPermInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950685"><span class="hs-identifier hs-type">tabInfo</span></a></span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687950689"><span class="annot"><a href="#local-6989586621687950689"><span class="hs-identifier hs-var hs-var">fieldInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableCoreInfoG
  ('Postgres 'Vanilla)
  (FieldInfo ('Postgres 'Vanilla))
  (ColumnInfo ('Postgres 'Vanilla))
-&gt; FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
forall (b :: BackendType) field primaryKeyColumn.
TableCoreInfoG b field primaryKeyColumn -&gt; FieldInfoMap field
</span><a href="Hasura.Table.Cache.html#_tciFieldInfoMap"><span class="hs-identifier hs-var">_tciFieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">(TableCoreInfoG
   ('Postgres 'Vanilla)
   (FieldInfo ('Postgres 'Vanilla))
   (ColumnInfo ('Postgres 'Vanilla))
 -&gt; FieldInfoMap (FieldInfo ('Postgres 'Vanilla)))
-&gt; TableCoreInfoG
     ('Postgres 'Vanilla)
     (FieldInfo ('Postgres 'Vanilla))
     (ColumnInfo ('Postgres 'Vanilla))
-&gt; FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TableInfo ('Postgres 'Vanilla)
-&gt; TableCoreInfoG
     ('Postgres 'Vanilla)
     (FieldInfo ('Postgres 'Vanilla))
     (ColumnInfo ('Postgres 'Vanilla))
forall (b :: BackendType). TableInfo b -&gt; TableCoreInfo b
</span><a href="Hasura.Table.Cache.html#_tiCoreInfo"><span class="hs-identifier hs-var">_tiCoreInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TableInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950685"><span class="hs-identifier hs-var">tabInfo</span></a></span><span>
</span><span id="line-340"></span><span>  </span><span id="local-6989586621687950690"><span class="annot"><a href="#local-6989586621687950690"><span class="hs-identifier hs-var">extSelQ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#resolveStar"><span class="hs-identifier hs-type">resolveStar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950689"><span class="hs-identifier hs-type">fieldInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950687"><span class="hs-identifier hs-type">selPermInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950684"><span class="hs-identifier hs-type">selQ</span></a></span><span>
</span><span id="line-341"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#validateHeaders"><span class="hs-identifier hs-type">validateHeaders</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.Table.Cache.html#spiRequiredHeaders"><span class="hs-identifier hs-var">spiRequiredHeaders</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950687"><span class="hs-identifier hs-type">selPermInfo</span></a></span><span>
</span><span id="line-342"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#convSelectQ"><span class="hs-identifier hs-type">convSelectQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950679"><span class="hs-identifier hs-type">sqlGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950683"><span class="hs-identifier hs-type">qt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950689"><span class="hs-identifier hs-type">fieldInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950687"><span class="hs-identifier hs-type">selPermInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950690"><span class="hs-identifier hs-type">extSelQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950680"><span class="hs-identifier hs-type">sessVarBldr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950681"><span class="hs-identifier hs-type">prepArgBuilder</span></a></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="annot"><a href="Hasura.RQL.DML.Select.html#selectP2"><span class="hs-identifier hs-type">selectP2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#JsonAggSelect"><span class="hs-identifier hs-type">JsonAggSelect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleSelect"><span class="hs-identifier hs-type">AnnSimpleSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DS.Seq</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html/Database.PG.Query.Connection.html#PrepArg"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Transaction.html/Database.PG.Query.Transaction.html#TxE"><span class="hs-identifier hs-type">PG.TxE</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html/Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span>
</span><span id="line-345"></span><span id="selectP2"><span class="annot"><span class="annottext">selectP2 :: UserInfo
-&gt; JsonAggSelect
-&gt; (AnnSimpleSelect ('Postgres 'Vanilla), Seq PrepArg)
-&gt; TxE QErr EncJSON
</span><a href="Hasura.RQL.DML.Select.html#selectP2"><span class="hs-identifier hs-var hs-var">selectP2</span></a></span></span><span> </span><span id="local-6989586621687950694"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687950694"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687950695"><span class="annot"><span class="annottext">JsonAggSelect
</span><a href="#local-6989586621687950695"><span class="hs-identifier hs-var">jsonAggSelect</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687950696"><span class="annot"><span class="annottext">AnnSimpleSelect ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950696"><span class="hs-identifier hs-var">sel</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687950697"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687950697"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-346"></span><span>  </span><span id="local-6989586621687950698"><span class="annot"><a href="#local-6989586621687950698"><span class="hs-identifier hs-var">selectWithQuery</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WriterT CustomSQLCTEs (TxET QErr IO) Select
-&gt; TxET QErr IO SelectWith
forall (m :: * -&gt; *).
MonadIO m =&gt;
WriterT CustomSQLCTEs m Select -&gt; m SelectWith
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#selectToSelectWithM"><span class="hs-identifier hs-var">selectToSelectWithM</span></a></span><span> </span><span class="annot"><span class="annottext">(WriterT CustomSQLCTEs (TxET QErr IO) Select
 -&gt; TxET QErr IO SelectWith)
-&gt; WriterT CustomSQLCTEs (TxET QErr IO) Select
-&gt; TxET QErr IO SelectWith
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserInfo
-&gt; JsonAggSelect
-&gt; AnnSimpleSelect ('Postgres 'Vanilla)
-&gt; WriterT CustomSQLCTEs (TxET QErr IO) Select
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), PostgresAnnotatedFieldJSON pgKind,
 PostgresGenerateSQLSelect pgKind, MonadWriter CustomSQLCTEs m,
 MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; JsonAggSelect -&gt; AnnSimpleSelect ('Postgres pgKind) -&gt; m Select
</span><a href="Hasura.Backends.Postgres.Translate.Select.Simple.html#mkSQLSelect"><span class="hs-identifier hs-var">mkSQLSelect</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687950694"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">JsonAggSelect
</span><a href="#local-6989586621687950695"><span class="hs-identifier hs-var">jsonAggSelect</span></a></span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelect ('Postgres 'Vanilla)
</span><a href="#local-6989586621687950696"><span class="hs-identifier hs-var">sel</span></a></span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687950700"><span class="annot"><a href="#local-6989586621687950700"><span class="hs-identifier hs-var hs-var">selectSQL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-348"></span><span>        </span><span class="annot"><span class="annottext">SelectWith -&gt; Query
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#toQuery"><span class="hs-identifier hs-var">toQuery</span></a></span><span>
</span><span id="line-349"></span><span>          </span><span class="annot"><span class="annottext">(SelectWith -&gt; Query) -&gt; SelectWith -&gt; Query
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SelectWith
</span><a href="#local-6989586621687950698"><span class="hs-identifier hs-var">selectWithQuery</span></a></span><span>
</span><span id="line-350"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">runIdentity</span></span><span>
</span><span id="line-351"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Class.html/Database.PG.Query.Class.html#getRow"><span class="hs-identifier hs-var">PG.getRow</span></a></span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Transaction.html/Database.PG.Query.Transaction.html#rawQE"><span class="hs-identifier hs-type">PG.rawQE</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Types.html#dmlTxErrorHandler"><span class="hs-identifier hs-type">dmlTxErrorHandler</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950700"><span class="hs-identifier hs-type">selectSQL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">toList</span></span><span> </span><span class="annot"><a href="#local-6989586621687950697"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span id="local-6989586621687949969"><span class="annot"><a href="Hasura.RQL.DML.Select.html#phaseOne"><span class="hs-identifier hs-type">phaseOne</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949969"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949969"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#CacheRM"><span class="hs-identifier hs-type">CacheRM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687949969"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SQLGenCtx"><span class="hs-identifier hs-type">SQLGenCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-357"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelectQuery"><span class="hs-identifier hs-type">SelectQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-358"></span><span>  </span><span class="annot"><a href="#local-6989586621687949969"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleSelect"><span class="hs-identifier hs-type">AnnSimpleSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DS.Seq</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html/Database.PG.Query.Connection.html#PrepArg"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-359"></span><span id="phaseOne"><span class="annot"><span class="annottext">phaseOne :: forall (m :: * -&gt; *).
(QErrM m, UserInfoM m, CacheRM m) =&gt;
SQLGenCtx
-&gt; SelectQuery
-&gt; m (AnnSimpleSelect ('Postgres 'Vanilla), Seq PrepArg)
</span><a href="Hasura.RQL.DML.Select.html#phaseOne"><span class="hs-identifier hs-var hs-var">phaseOne</span></a></span></span><span> </span><span id="local-6989586621687950769"><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621687950769"><span class="hs-identifier hs-var">sqlGen</span></a></span></span><span> </span><span id="local-6989586621687950770"><span class="annot"><span class="annottext">SelectQuery
</span><a href="#local-6989586621687950770"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687950771"><span class="annot"><span class="annottext">sourceName :: SourceName
</span><a href="#local-6989586621687950771"><span class="hs-identifier hs-var hs-var hs-var">sourceName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectQuery -&gt; SourceName
forall a. DMLQuery a -&gt; SourceName
</span><a href="Hasura.RQL.DML.Types.html#getSourceDMLQuery"><span class="hs-identifier hs-var">getSourceDMLQuery</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQuery
</span><a href="#local-6989586621687950770"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-361"></span><span>  </span><span id="local-6989586621687950773"><span class="annot"><a href="#local-6989586621687950773"><span class="hs-identifier hs-var">tableCache</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">TableCache</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier">Postgres</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier">Vanilla</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe
  (HashMap
     (TableName ('Postgres 'Vanilla)) (TableInfo ('Postgres 'Vanilla)))
-&gt; HashMap
     (TableName ('Postgres 'Vanilla)) (TableInfo ('Postgres 'Vanilla))
forall m. Monoid m =&gt; Maybe m -&gt; m
forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><span class="hs-identifier hs-var">fold</span></span><span> </span><span class="annot"><span class="annottext">(Maybe
   (HashMap
      (TableName ('Postgres 'Vanilla)) (TableInfo ('Postgres 'Vanilla)))
 -&gt; HashMap
      (TableName ('Postgres 'Vanilla)) (TableInfo ('Postgres 'Vanilla)))
-&gt; m (Maybe
        (HashMap
           (TableName ('Postgres 'Vanilla)) (TableInfo ('Postgres 'Vanilla))))
-&gt; m (HashMap
        (TableName ('Postgres 'Vanilla)) (TableInfo ('Postgres 'Vanilla)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">SourceName
-&gt; m (Maybe
        (HashMap
           (TableName ('Postgres 'Vanilla)) (TableInfo ('Postgres 'Vanilla))))
forall (b :: BackendType) (m :: * -&gt; *).
(Backend b, CacheRM m) =&gt;
SourceName -&gt; m (Maybe (TableCache b))
</span><a href="Hasura.RQL.Types.SchemaCache.html#askTableCache"><span class="hs-identifier hs-var">askTableCache</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621687950771"><span class="hs-identifier hs-var">sourceName</span></a></span><span>
</span><span id="line-362"></span><span>  </span><span id="local-6989586621687950776"><span class="annot"><a href="#local-6989586621687950776"><span class="hs-identifier hs-var">logicalModelCache</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">LogicalModelCache</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier">Postgres</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier">Vanilla</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fold</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#askLogicalModelCache"><span class="hs-identifier hs-type">askLogicalModelCache</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950771"><span class="hs-identifier hs-type">sourceName</span></a></span><span>
</span><span id="line-363"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">flip</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#runTableCacheRT"><span class="hs-identifier hs-var">runTableCacheRT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950773"><span class="hs-identifier hs-type">tableCache</span></a></span><span>
</span><span id="line-364"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.LogicalModel.Fields.html#runLogicalModelFieldsLookup"><span class="hs-identifier hs-type">runLogicalModelFieldsLookup</span></a></span><span> </span><span class="annot"><a href="Hasura.LogicalModel.Cache.html#_lmiFields"><span class="hs-identifier hs-var">_lmiFields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950776"><span class="hs-identifier hs-type">logicalModelCache</span></a></span><span>
</span><span id="line-365"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#runDMLP1T"><span class="hs-identifier hs-type">runDMLP1T</span></a></span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#convSelectQuery"><span class="hs-identifier hs-type">convSelectQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950769"><span class="hs-identifier hs-type">sqlGen</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#sessVarFromCurrentSetting"><span class="hs-identifier hs-type">sessVarFromCurrentSetting</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#valueParserWithCollectableType"><span class="hs-identifier hs-type">valueParserWithCollectableType</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#binRHSBuilder"><span class="hs-identifier hs-type">binRHSBuilder</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687950770"><span class="hs-identifier hs-type">query</span></a></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span id="local-6989586621687950039"><span class="annot"><a href="Hasura.RQL.DML.Select.html#phaseTwo"><span class="hs-identifier hs-type">phaseTwo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950039"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleSelect"><span class="hs-identifier hs-type">AnnSimpleSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DS.Seq</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html/Database.PG.Query.Connection.html#PrepArg"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621687950039"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html/Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span></span><span>
</span><span id="line-369"></span><span id="phaseTwo"><span class="annot"><span class="annottext">phaseTwo :: forall (m :: * -&gt; *).
MonadTx m =&gt;
UserInfo
-&gt; (AnnSimpleSelect ('Postgres 'Vanilla), Seq PrepArg) -&gt; m EncJSON
</span><a href="Hasura.RQL.DML.Select.html#phaseTwo"><span class="hs-identifier hs-var hs-var">phaseTwo</span></a></span></span><span> </span><span id="local-6989586621687950788"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687950788"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-370"></span><span>  </span><span class="annot"><span class="annottext">TxE QErr EncJSON -&gt; m EncJSON
forall a. TxE QErr a -&gt; m a
forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">(TxE QErr EncJSON -&gt; m EncJSON)
-&gt; ((AnnSelectG
       ('Postgres 'Vanilla) (AnnFieldG ('Postgres 'Vanilla) Void) SQLExp,
     Seq PrepArg)
    -&gt; TxE QErr EncJSON)
-&gt; (AnnSelectG
      ('Postgres 'Vanilla) (AnnFieldG ('Postgres 'Vanilla) Void) SQLExp,
    Seq PrepArg)
-&gt; m EncJSON
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UserInfo
-&gt; JsonAggSelect
-&gt; (AnnSimpleSelect ('Postgres 'Vanilla), Seq PrepArg)
-&gt; TxE QErr EncJSON
</span><a href="Hasura.RQL.DML.Select.html#selectP2"><span class="hs-identifier hs-var">selectP2</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687950788"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">JsonAggSelect
</span><a href="Hasura.RQL.Types.Common.html#JASMultipleRows"><span class="hs-identifier hs-var">JASMultipleRows</span></a></span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span id="local-6989586621687950044"><span class="annot"><a href="Hasura.RQL.DML.Select.html#runSelect"><span class="hs-identifier hs-type">runSelect</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950044"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-374"></span><span>    </span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950044"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-375"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#CacheRM"><span class="hs-identifier hs-type">CacheRM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950044"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-376"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687950044"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-377"></span><span>    </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/monad-control-1.0.3.1-127c0b1895a90d6faa345827c6b6be6447278996974a93c84184eef9ccf5fbbc/share/doc/html/src/Control.Monad.Trans.Control.html/Control.Monad.Trans.Control.html#MonadBaseControl"><span class="hs-identifier hs-type">MonadBaseControl</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621687950044"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-378"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.Class.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950044"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-379"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html#MetadataM"><span class="hs-identifier hs-type">MetadataM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950044"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-381"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SQLGenCtx"><span class="hs-identifier hs-type">SQLGenCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-382"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelectQuery"><span class="hs-identifier hs-type">SelectQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-383"></span><span>  </span><span class="annot"><a href="#local-6989586621687950044"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html/Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span></span><span>
</span><span id="line-384"></span><span id="runSelect"><span class="annot"><span class="annottext">runSelect :: forall (m :: * -&gt; *).
(QErrM m, UserInfoM m, CacheRM m, MonadIO m, MonadBaseControl IO m,
 MonadTrace m, MetadataM m) =&gt;
SQLGenCtx -&gt; SelectQuery -&gt; m EncJSON
</span><a href="Hasura.RQL.DML.Select.html#runSelect"><span class="hs-identifier hs-var hs-var">runSelect</span></a></span></span><span> </span><span id="local-6989586621687950817"><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621687950817"><span class="hs-identifier hs-var">sqlGen</span></a></span></span><span> </span><span id="local-6989586621687950818"><span class="annot"><span class="annottext">SelectQuery
</span><a href="#local-6989586621687950818"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-385"></span><span>  </span><span id="local-6989586621687950819"><span class="annot"><a href="#local-6989586621687950819"><span class="hs-identifier hs-var">sourceConfig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) (m :: * -&gt; *).
(CacheRM m, MonadError QErr m, Backend b, MetadataM m) =&gt;
SourceName -&gt; m (SourceConfig b)
</span><a href="Hasura.RQL.Types.SchemaCache.html#askSourceConfig"><span class="hs-identifier hs-var">askSourceConfig</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectQuery -&gt; SourceName
forall a. DMLQuery a -&gt; SourceName
</span><a href="Hasura.RQL.DML.Types.html#getSourceDMLQuery"><span class="hs-identifier hs-var">getSourceDMLQuery</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQuery
</span><a href="#local-6989586621687950818"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>  </span><span id="local-6989586621687950821"><span class="annot"><a href="#local-6989586621687950821"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.Authentication.User.html#askUserInfo"><span class="hs-identifier hs-type">askUserInfo</span></a></span><span>
</span><span id="line-387"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#phaseOne"><span class="hs-identifier hs-type">phaseOne</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950817"><span class="hs-identifier hs-type">sqlGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950818"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#runTxWithCtx"><span class="hs-identifier hs-type">runTxWithCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Types.html#_pscExecCtx"><span class="hs-identifier hs-var">_pscExecCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950819"><span class="hs-identifier hs-type">sourceConfig</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Types.html#Tx"><span class="hs-identifier hs-type">Tx</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Transaction.html/Database.PG.Query.Transaction.html#ReadOnly"><span class="hs-identifier hs-type">PG.ReadOnly</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Types.html#LegacyRQLQuery"><span class="hs-identifier hs-type">LegacyRQLQuery</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#phaseTwo"><span class="hs-identifier hs-type">phaseTwo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687950821"><span class="hs-identifier hs-type">userInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span></pre></body></html>