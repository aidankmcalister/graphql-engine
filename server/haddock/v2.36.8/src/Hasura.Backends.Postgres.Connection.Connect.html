<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Connect to a postgres db and run queries.</span><span>
</span><span id="line-2"></span><span class="hs-comment">--   This module is meant for simple one-off checks against</span><span>
</span><span id="line-3"></span><span class="hs-comment">--   a postgres database, such as health checks or version checks,</span><span>
</span><span id="line-4"></span><span class="hs-comment">--   and not for normal work.</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.Connect.html"><span class="hs-identifier">Hasura.Backends.Postgres.Connection.Connect</span></a></span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.Connect.html#withPostgresDB"><span class="hs-identifier">withPostgresDB</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">where</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.html/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier">Value</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier">object</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator">(.=)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Environment.html/Data.Environment.html"><span class="hs-identifier">Data.Environment</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Env</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.html/Database.PG.Query.html"><span class="hs-identifier">Database.PG.Query</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PG</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.html"><span class="hs-identifier">Hasura.Backends.Postgres.Connection</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PG</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErr"><span class="hs-identifier">QErr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html/Hasura.Prelude.html"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html"><span class="hs-identifier">Hasura.RQL.Types.Common</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SourceName"><span class="hs-identifier">SourceName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#resolveUrlConf"><span class="hs-identifier">resolveUrlConf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="annot"><span class="hs-comment">-- | Connect to a postgres database and run a transaction.</span></span><span>
</span><span id="line-19"></span><span id="local-6989586621687768586"><span class="annot"><a href="Hasura.Backends.Postgres.Connection.Connect.html#withPostgresDB"><span class="hs-identifier hs-type">withPostgresDB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Environment.html/Data.Environment.html#Environment"><span class="hs-identifier hs-type">Env.Environment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SourceName"><span class="hs-identifier hs-type">SourceName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.Settings.html#PostgresConnConfiguration"><span class="hs-identifier hs-type">PG.PostgresConnConfiguration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Transaction.html/Database.PG.Query.Transaction.html#TxET"><span class="hs-identifier hs-type">PG.TxET</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621687768586"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687768586"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-20"></span><span id="withPostgresDB"><span class="annot"><span class="annottext">withPostgresDB :: forall a.
Environment
-&gt; SourceName
-&gt; PostgresConnConfiguration
-&gt; TxET QErr IO a
-&gt; IO (Either QErr a)
</span><a href="Hasura.Backends.Postgres.Connection.Connect.html#withPostgresDB"><span class="hs-identifier hs-var hs-var">withPostgresDB</span></a></span></span><span> </span><span id="local-6989586621687768684"><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621687768684"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621687768685"><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621687768685"><span class="hs-identifier hs-var">sourceName</span></a></span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.Settings.html#PostgresConnConfiguration"><span class="hs-identifier hs-type">PG.PostgresConnConfiguration</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687768687"><span id="local-6989586621687768688"><span id="local-6989586621687768689"><span id="local-6989586621687768690"><span id="local-6989586621687768691"><span class="annot"><span class="annottext">Maybe (NonEmpty PostgresSourceConnInfo)
Maybe PostgresConnectionSet
Maybe ConnectionTemplate
ExtensionsSchema
PostgresSourceConnInfo
pccConnectionInfo :: PostgresSourceConnInfo
pccReadReplicas :: Maybe (NonEmpty PostgresSourceConnInfo)
pccExtensionsSchema :: ExtensionsSchema
pccConnectionTemplate :: Maybe ConnectionTemplate
pccConnectionSet :: Maybe PostgresConnectionSet
pccConnectionSet :: PostgresConnConfiguration -&gt; Maybe PostgresConnectionSet
pccConnectionTemplate :: PostgresConnConfiguration -&gt; Maybe ConnectionTemplate
pccExtensionsSchema :: PostgresConnConfiguration -&gt; ExtensionsSchema
pccReadReplicas :: PostgresConnConfiguration
-&gt; Maybe (NonEmpty PostgresSourceConnInfo)
pccConnectionInfo :: PostgresConnConfiguration -&gt; PostgresSourceConnInfo
</span><a href="#local-6989586621687768687"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621687768697"><span class="annot"><span class="annottext">TxET QErr IO a
</span><a href="#local-6989586621687768697"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><span class="annottext">PostgresSourceConnInfo -&gt; IO (Either QErr PGPool)
</span><a href="#local-6989586621687768698"><span class="hs-identifier hs-var">generateMinimalPool</span></a></span><span> </span><span class="annot"><span class="annottext">PostgresSourceConnInfo
</span><a href="#local-6989586621687768687"><span class="hs-identifier hs-var">pccConnectionInfo</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either QErr PGPool)
-&gt; (Either QErr PGPool -&gt; IO (Either QErr a)) -&gt; IO (Either QErr a)
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621687768699"><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621687768699"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-23"></span><span>      </span><span class="hs-comment">-- Cannot able to intialise a pool due to a bad connection config.</span><span>
</span><span id="line-24"></span><span>      </span><span class="annot"><span class="annottext">Either QErr a -&gt; IO (Either QErr a)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either QErr a -&gt; IO (Either QErr a))
-&gt; Either QErr a -&gt; IO (Either QErr a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QErr -&gt; Either QErr a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621687768699"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621687768700"><span class="annot"><span class="annottext">PGPool
</span><a href="#local-6989586621687768700"><span class="hs-identifier hs-var">pool</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-26"></span><span>      </span><span class="annot"><span class="annottext">ExceptT QErr IO a -&gt; IO (Either QErr a)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGPool -&gt; TxET QErr IO a -&gt; ExceptT QErr IO a
forall (m :: * -&gt; *) e a.
(MonadIO m, MonadBaseControl IO m, FromPGConnErr e) =&gt;
PGPool -&gt; TxET e m a -&gt; ExceptT e m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Pool.html/Database.PG.Query.Pool.html#runTx%27"><span class="hs-identifier hs-var">PG.runTx'</span></a></span><span> </span><span class="annot"><span class="annottext">PGPool
</span><a href="#local-6989586621687768700"><span class="hs-identifier hs-var">pool</span></a></span><span> </span><span class="annot"><span class="annottext">TxET QErr IO a
</span><a href="#local-6989586621687768697"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO (Either QErr a) -&gt; IO () -&gt; IO (Either QErr a)
forall a b. IO a -&gt; IO b -&gt; IO a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">PGPool -&gt; IO ()
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Pool.html/Database.PG.Query.Pool.html#destroyPGPool"><span class="hs-identifier hs-var">PG.destroyPGPool</span></a></span><span> </span><span class="annot"><span class="annottext">PGPool
</span><a href="#local-6989586621687768700"><span class="hs-identifier hs-var">pool</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="#local-6989586621687768705"><span class="hs-identifier hs-type">context</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span id="local-6989586621687768705"><span class="annot"><span class="annottext">context :: Value
</span><a href="#local-6989586621687768705"><span class="hs-identifier hs-var hs-var">context</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">object</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;source&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; SourceName -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621687768685"><span class="hs-identifier hs-var">sourceName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="#local-6989586621687768698"><span class="hs-identifier hs-type">generateMinimalPool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.Settings.html#PostgresSourceConnInfo"><span class="hs-identifier hs-type">PG.PostgresSourceConnInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Pool.html/Database.PG.Query.Pool.html#PGPool"><span class="hs-identifier hs-type">PG.PGPool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>    </span><span id="local-6989586621687768698"><span class="annot"><span class="annottext">generateMinimalPool :: PostgresSourceConnInfo -&gt; IO (Either QErr PGPool)
</span><a href="#local-6989586621687768698"><span class="hs-identifier hs-var hs-var">generateMinimalPool</span></a></span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.Settings.html#PostgresSourceConnInfo"><span class="hs-identifier hs-type">PG.PostgresSourceConnInfo</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687768707"><span id="local-6989586621687768708"><span id="local-6989586621687768709"><span id="local-6989586621687768710"><span id="local-6989586621687768711"><span class="annot"><span class="annottext">Bool
Maybe (PGClientCerts CertVar CertVar)
Maybe PostgresPoolSettings
TxIsolation
UrlConf
psciDatabaseUrl :: UrlConf
psciPoolSettings :: Maybe PostgresPoolSettings
psciUsePreparedStatements :: Bool
psciIsolationLevel :: TxIsolation
psciSslConfiguration :: Maybe (PGClientCerts CertVar CertVar)
psciSslConfiguration :: PostgresSourceConnInfo -&gt; Maybe (PGClientCerts CertVar CertVar)
psciIsolationLevel :: PostgresSourceConnInfo -&gt; TxIsolation
psciUsePreparedStatements :: PostgresSourceConnInfo -&gt; Bool
psciPoolSettings :: PostgresSourceConnInfo -&gt; Maybe PostgresPoolSettings
psciDatabaseUrl :: PostgresSourceConnInfo -&gt; UrlConf
</span><a href="#local-6989586621687768707"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT QErr IO PGPool -&gt; IO (Either QErr PGPool)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-33"></span><span>      </span><span id="local-6989586621687768717"><span class="annot"><a href="#local-6989586621687768717"><span class="hs-identifier hs-var">connDetails</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Environment -&gt; UrlConf -&gt; ExceptT QErr IO ConnDetails
forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
Environment -&gt; UrlConf -&gt; m ConnDetails
</span><a href="Hasura.RQL.Types.Common.html#resolveUrlConf"><span class="hs-identifier hs-var">resolveUrlConf</span></a></span><span> </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621687768684"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">UrlConf
</span><a href="#local-6989586621687768707"><span class="hs-identifier hs-var">psciDatabaseUrl</span></a></span><span>
</span><span id="line-34"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687768718"><span class="annot"><a href="#local-6989586621687768718"><span class="hs-identifier hs-var hs-var">connInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ConnDetails -&gt; ConnInfo
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html/Database.PG.Query.Connection.html#ConnInfo"><span class="hs-identifier hs-var">PG.ConnInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ConnDetails
</span><a href="#local-6989586621687768717"><span class="hs-identifier hs-var">connDetails</span></a></span><span>
</span><span id="line-35"></span><span>          </span><span class="hs-comment">-- Create pool with only one connection</span><span>
</span><span id="line-36"></span><span>          </span><span id="local-6989586621687768720"><span class="annot"><a href="#local-6989586621687768720"><span class="hs-identifier hs-var hs-var">connParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConnParams
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Pool.html/Database.PG.Query.Pool.html#defaultConnParams"><span class="hs-identifier hs-var">PG.defaultConnParams</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Pool.html/Database.PG.Query.Pool.html#cpConns"><span class="hs-identifier hs-var">PG.cpConns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">}</span><span>
</span><span id="line-37"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">liftIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Pool.html/Database.PG.Query.Pool.html#initPGPool"><span class="hs-identifier hs-type">PG.initPGPool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687768718"><span class="hs-identifier hs-type">connInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687768705"><span class="hs-identifier hs-type">context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687768720"><span class="hs-identifier hs-type">connParams</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">PGLogEvent
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span></pre></body></html>