<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Postgres Execute Insert</span><span>
</span><span id="line-2"></span><span class="hs-comment">--</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Translates and executes IR to Postgres-specific SQL.</span><span>
</span><span id="line-4"></span><span class="hs-comment">--</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- See 'Hasura.Backends.Postgres.Instances.Execute'.</span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html"><span class="hs-identifier">Hasura.Backends.Postgres.Execute.Insert</span></a></span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#convertToSQLTransaction"><span class="hs-identifier">convertToSQLTransaction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#validateInsertInput"><span class="hs-identifier">validateInsertInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#validateInsertRows"><span class="hs-identifier">validateInsertRows</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">where</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.html/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">J</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Key.html/Data.Aeson.Key.html"><span class="hs-identifier">Data.Aeson.Key</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">J</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Environment.html/Data.Environment.html"><span class="hs-identifier">Data.Environment</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Env</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Strict.html/Data.HashMap.Strict.html"><span class="hs-identifier">Data.HashMap.Strict</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HashMap</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.HashMap.Strict.Extended.html/Data.HashMap.Strict.Extended.html"><span class="hs-identifier">Data.HashMap.Strict.Extended</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HashMap</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/insert-ordered-containers-0.2.5.3-dcb71999c8104475fd299533bb40a6c15ee8a9411f3a03b68aa99a14a4143c19/share/doc/html/src/Data.HashMap.Strict.InsOrd.html/Data.HashMap.Strict.InsOrd.html"><span class="hs-identifier">Data.HashMap.Strict.InsOrd</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">InsOrdHashMap</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html"><span class="hs-identifier">Data.Text.Extended</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.html/Database.PG.Query.html"><span class="hs-identifier">Database.PG.Query</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PG</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Authentication.User.html"><span class="hs-identifier">Hasura.Authentication.User</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfo"><span class="hs-identifier">UserInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.html"><span class="hs-identifier">Hasura.Backends.Postgres.Connection</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html"><span class="hs-identifier">Hasura.Backends.Postgres.Execute.Mutation</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PGE</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.DML</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Postgres</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.Types</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PGTypes</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#TableName"><span class="hs-identifier">TableName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Value.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.Value</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.BoolExp.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.BoolExp</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PGT</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Insert.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Insert</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PGT</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Mutation.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Mutation</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PGT</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Returning.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Returning</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PGT</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html#PostgresTranslateSelect"><span class="hs-identifier">PostgresTranslateSelect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Types.Insert.html"><span class="hs-identifier">Hasura.Backends.Postgres.Types.Insert</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html/Hasura.EncJSON.html"><span class="hs-identifier">Hasura.EncJSON</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Logging.html"><span class="hs-identifier">Hasura.Logging</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html/Hasura.Prelude.html"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.QueryTags.html"><span class="hs-identifier">Hasura.QueryTags</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html"><span class="hs-identifier">Hasura.RQL.IR.BoolExp</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html"><span class="hs-identifier">Hasura.RQL.IR.Insert</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IR</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Returning.html"><span class="hs-identifier">Hasura.RQL.IR.Returning</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IR</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html"><span class="hs-identifier">Hasura.RQL.IR.Value</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IR</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html"><span class="hs-identifier">Hasura.RQL.Types.Backend</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html"><span class="hs-identifier">Hasura.RQL.Types.BackendType</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Column.html"><span class="hs-identifier">Hasura.RQL.Types.Column</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html"><span class="hs-identifier">Hasura.RQL.Types.Common</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Headers.html"><span class="hs-identifier">Hasura.RQL.Types.Headers</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html"><span class="hs-identifier">Hasura.RQL.Types.NamingCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier">NamingCase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html"><span class="hs-identifier">Hasura.RQL.Types.Relationships.Local</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html"><span class="hs-identifier">Hasura.RQL.Types.Schema.Options</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Options</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Tracing.html"><span class="hs-identifier">Hasura.Tracing</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tracing</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Network.HTTP.Client.Transformable.html/Network.HTTP.Client.Transformable.html"><span class="hs-identifier">Network.HTTP.Client.Transformable</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HTTP</span></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#convertToSQLTransaction"><span class="hs-identifier hs-type">convertToSQLTransaction</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687929208"><span class="annot"><a href="#local-6989586621687929208"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687929204"><span class="annot"><a href="#local-6989586621687929204"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929204"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687929204"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.Class.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929204"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929208"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html#PostgresTranslateSelect"><span class="hs-identifier hs-type">PostgresTranslateSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929208"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929204"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#AnnotatedInsert"><span class="hs-identifier hs-type">IR.AnnotatedInsert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929208"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">Postgres.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html/Database.PG.Query.Connection.html#PrepArg"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><a href="#local-6989586621687929204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html/Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span>
</span><span id="line-71"></span><span id="convertToSQLTransaction"><span class="annot"><span class="annottext">convertToSQLTransaction :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, MonadIO m, MonadTrace m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m) =&gt;
AnnotatedInsert ('Postgres pgKind) Void SQLExp
-&gt; UserInfo
-&gt; Seq PrepArg
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#convertToSQLTransaction"><span class="hs-identifier hs-var hs-var">convertToSQLTransaction</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#AnnotatedInsert"><span class="hs-identifier hs-type">IR.AnnotatedInsert</span></a></span><span> </span><span id="local-6989586621687929630"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687929630"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span> </span><span id="local-6989586621687929631"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687929631"><span class="hs-identifier hs-var">isSingle</span></a></span></span><span> </span><span id="local-6989586621687929632"><span class="annot"><span class="annottext">MultiObjectInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929632"><span class="hs-identifier hs-var">annIns</span></a></span></span><span> </span><span id="local-6989586621687929633"><span class="annot"><span class="annottext">MutationOutputG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687929633"><span class="hs-identifier hs-var">mutationOutput</span></a></span></span><span> </span><span id="local-6989586621687929634"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687929634"><span class="hs-identifier hs-var">_tCase</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621687929635"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687929635"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687929636"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687929636"><span class="hs-identifier hs-var">planVars</span></a></span></span><span> </span><span id="local-6989586621687929637"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687929637"><span class="hs-identifier hs-var">stringifyNum</span></a></span></span><span> </span><span id="local-6989586621687929638"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687929638"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[AnnotatedInsertRow ('Postgres pgKind) SQLExp] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([AnnotatedInsertRow ('Postgres pgKind) SQLExp] -&gt; Bool)
-&gt; [AnnotatedInsertRow ('Postgres pgKind) SQLExp] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MultiObjectInsert ('Postgres pgKind) SQLExp
-&gt; [AnnotatedInsertRow ('Postgres pgKind) SQLExp]
forall (b :: BackendType) (f :: * -&gt; *) v.
AnnotatedInsertData b f v -&gt; f (AnnotatedInsertRow b v)
</span><a href="Hasura.RQL.IR.Insert.html#_aiInsertObject"><span class="hs-identifier hs-var">IR._aiInsertObject</span></a></span><span> </span><span class="annot"><span class="annottext">MultiObjectInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929632"><span class="hs-identifier hs-var">annIns</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">EncJSON -&gt; m EncJSON
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(EncJSON -&gt; m EncJSON) -&gt; EncJSON -&gt; m EncJSON
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind) -&gt; EncJSON
forall (backend :: BackendType). MutationOutput backend -&gt; EncJSON
</span><a href="Hasura.RQL.IR.Returning.html#buildEmptyMutResp"><span class="hs-identifier hs-var">IR.buildEmptyMutResp</span></a></span><span> </span><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
MutationOutputG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687929633"><span class="hs-identifier hs-var">mutationOutput</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-75"></span><span>      </span><span class="annot"><span class="annottext">[Text] -&gt; m EncJSON -&gt; m EncJSON
forall {t :: * -&gt; *} {m :: * -&gt; *} {a}.
(Foldable t, QErrM m, Functor t) =&gt;
t Text -&gt; m a -&gt; m a
</span><a href="#local-6989586621687929642"><span class="hs-identifier hs-var">withPaths</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;selectionSet&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687929630"><span class="hs-identifier hs-var">fieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;args&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687929643"><span class="hs-identifier hs-var">suffix</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span>        </span><span class="annot"><span class="annottext">(m EncJSON -&gt; m EncJSON) -&gt; m EncJSON -&gt; m EncJSON
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MultiObjectInsert ('Postgres pgKind) SQLExp
-&gt; HashMap PGCol SQLExp
-&gt; UserInfo
-&gt; MutationOutput ('Postgres pgKind)
-&gt; Seq PrepArg
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; m EncJSON
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, MonadIO m, MonadTrace m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m) =&gt;
MultiObjectInsert ('Postgres pgKind) SQLExp
-&gt; HashMap PGCol SQLExp
-&gt; UserInfo
-&gt; MutationOutput ('Postgres pgKind)
-&gt; Seq PrepArg
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#insertMultipleObjects"><span class="hs-identifier hs-var">insertMultipleObjects</span></a></span><span> </span><span class="annot"><span class="annottext">MultiObjectInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929632"><span class="hs-identifier hs-var">annIns</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687929635"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
MutationOutputG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687929633"><span class="hs-identifier hs-var">mutationOutput</span></a></span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687929636"><span class="hs-identifier hs-var">planVars</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687929637"><span class="hs-identifier hs-var">stringifyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687929638"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>    </span><span id="local-6989586621687929642"><span class="annot"><span class="annottext">withPaths :: t Text -&gt; m a -&gt; m a
</span><a href="#local-6989586621687929642"><span class="hs-identifier hs-var hs-var">withPaths</span></a></span></span><span> </span><span id="local-6989586621687929659"><span class="annot"><span class="annottext">t Text
</span><a href="#local-6989586621687929659"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621687929660"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621687929660"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((m a -&gt; m a) -&gt; m a -&gt; m a) -&gt; m a -&gt; t (m a -&gt; m a) -&gt; m a
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; m a) -&gt; m a -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">($)</span></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621687929660"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(t (m a -&gt; m a) -&gt; m a) -&gt; t (m a -&gt; m a) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m a -&gt; m a) -&gt; t Text -&gt; t (m a -&gt; m a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">t Text
</span><a href="#local-6989586621687929659"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621687929643"><span class="annot"><span class="annottext">suffix :: Text
</span><a href="#local-6989586621687929643"><span class="hs-identifier hs-var hs-var">suffix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool -&gt; Text
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;objects&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;object&quot;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687929631"><span class="hs-identifier hs-var">isSingle</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#insertMultipleObjects"><span class="hs-identifier hs-type">insertMultipleObjects</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687929266"><span class="annot"><a href="#local-6989586621687929266"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687929265"><span class="annot"><a href="#local-6989586621687929265"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929265"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687929265"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.Class.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929265"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929266"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html#PostgresTranslateSelect"><span class="hs-identifier hs-type">PostgresTranslateSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929266"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929265"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#MultiObjectInsert"><span class="hs-identifier hs-type">IR.MultiObjectInsert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929266"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">Postgres.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#HashMap"><span class="hs-identifier hs-type">HashMap.HashMap</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#PGCol"><span class="hs-identifier hs-type">PGCol</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">Postgres.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Returning.html#MutationOutput"><span class="hs-identifier hs-type">IR.MutationOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929266"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html/Database.PG.Query.Connection.html#PrepArg"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><a href="#local-6989586621687929265"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html/Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span>
</span><span id="line-98"></span><span id="insertMultipleObjects"><span class="annot"><span class="annottext">insertMultipleObjects :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, MonadIO m, MonadTrace m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m) =&gt;
MultiObjectInsert ('Postgres pgKind) SQLExp
-&gt; HashMap PGCol SQLExp
-&gt; UserInfo
-&gt; MutationOutput ('Postgres pgKind)
-&gt; Seq PrepArg
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#insertMultipleObjects"><span class="hs-identifier hs-var hs-var">insertMultipleObjects</span></a></span></span><span> </span><span id="local-6989586621687929737"><span class="annot"><span class="annottext">MultiObjectInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929737"><span class="hs-identifier hs-var">multiObjIns</span></a></span></span><span> </span><span id="local-6989586621687929738"><span class="annot"><span class="annottext">HashMap PGCol SQLExp
</span><a href="#local-6989586621687929738"><span class="hs-identifier hs-var">additionalColumns</span></a></span></span><span> </span><span id="local-6989586621687929739"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687929739"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687929740"><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621687929740"><span class="hs-identifier hs-var">mutationOutput</span></a></span></span><span> </span><span id="local-6989586621687929741"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687929741"><span class="hs-identifier hs-var">planVars</span></a></span></span><span> </span><span id="local-6989586621687929742"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687929742"><span class="hs-identifier hs-var">stringifyNum</span></a></span></span><span> </span><span id="local-6989586621687929743"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687929743"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><span class="annottext">m EncJSON -&gt; m EncJSON -&gt; Bool -&gt; m EncJSON
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">m EncJSON
</span><a href="#local-6989586621687929744"><span class="hs-identifier hs-var">withoutRelsInsert</span></a></span><span> </span><span class="annot"><span class="annottext">m EncJSON
</span><a href="#local-6989586621687929745"><span class="hs-identifier hs-var">withRelsInsert</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687929746"><span class="hs-identifier hs-var">anyRelsToInsert</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#AnnotatedInsertData"><span class="hs-identifier hs-type">IR.AnnotatedInsertData</span></a></span><span> </span><span id="local-6989586621687929748"><span class="annot"><span class="annottext">[AnnotatedInsertRow ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687929748"><span class="hs-identifier hs-var">insObjs</span></a></span></span><span> </span><span id="local-6989586621687929749"><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
</span><a href="#local-6989586621687929749"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span id="local-6989586621687929750"><span class="annot"><span class="annottext">(AnnBoolExp ('Postgres pgKind) SQLExp,
 Maybe (AnnBoolExp ('Postgres pgKind) SQLExp))
</span><a href="#local-6989586621687929750"><span class="hs-identifier hs-var">checkCondition</span></a></span></span><span> </span><span id="local-6989586621687929751"><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687929751"><span class="hs-identifier hs-var">columnInfos</span></a></span></span><span> </span><span id="local-6989586621687929752"><span class="annot"><span class="annottext">Maybe (NESeq (Column ('Postgres pgKind)))
</span><a href="#local-6989586621687929752"><span class="hs-identifier hs-var">_pk</span></a></span></span><span> </span><span id="local-6989586621687929753"><span class="annot"><span class="annottext">ExtraTableMetadata ('Postgres pgKind)
</span><a href="#local-6989586621687929753"><span class="hs-identifier hs-var">_extra</span></a></span></span><span> </span><span id="local-6989586621687929754"><span class="annot"><span class="annottext">PreSetColsG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929754"><span class="hs-identifier hs-var">presetRow</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Types.Insert.html#BackendInsert"><span class="hs-identifier hs-type">BackendInsert</span></a></span><span> </span><span id="local-6989586621687929756"><span class="annot"><span class="annottext">Maybe (OnConflictClause ('Postgres pgKind) SQLExp)
</span><a href="#local-6989586621687929756"><span class="hs-identifier hs-var">conflictClause</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621687929757"><span class="annot"><span class="annottext">Maybe (ValidateInput ResolvedWebhook)
</span><a href="#local-6989586621687929757"><span class="hs-identifier hs-var">_validateInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MultiObjectInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929737"><span class="hs-identifier hs-var">multiObjIns</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621687929758"><span class="annot"><span class="annottext">allInsObjRels :: [ObjectRelationInsert ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687929758"><span class="hs-identifier hs-var hs-var">allInsObjRels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AnnotatedInsertRow ('Postgres pgKind) SQLExp
 -&gt; [ObjectRelationInsert ('Postgres pgKind) SQLExp])
-&gt; [AnnotatedInsertRow ('Postgres pgKind) SQLExp]
-&gt; [ObjectRelationInsert ('Postgres pgKind) SQLExp]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertRow ('Postgres pgKind) SQLExp
-&gt; [ObjectRelationInsert ('Postgres pgKind) SQLExp]
forall (b :: BackendType) v.
AnnotatedInsertRow b v -&gt; [ObjectRelationInsert b v]
</span><a href="Hasura.RQL.IR.Insert.html#getInsertObjectRelationships"><span class="hs-identifier hs-var">IR.getInsertObjectRelationships</span></a></span><span> </span><span class="annot"><span class="annottext">[AnnotatedInsertRow ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687929748"><span class="hs-identifier hs-var">insObjs</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621687929761"><span class="annot"><span class="annottext">allInsArrRels :: [ArrayRelationInsert ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687929761"><span class="hs-identifier hs-var hs-var">allInsArrRels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AnnotatedInsertRow ('Postgres pgKind) SQLExp
 -&gt; [ArrayRelationInsert ('Postgres pgKind) SQLExp])
-&gt; [AnnotatedInsertRow ('Postgres pgKind) SQLExp]
-&gt; [ArrayRelationInsert ('Postgres pgKind) SQLExp]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertRow ('Postgres pgKind) SQLExp
-&gt; [ArrayRelationInsert ('Postgres pgKind) SQLExp]
forall (b :: BackendType) v.
AnnotatedInsertRow b v -&gt; [ArrayRelationInsert b v]
</span><a href="Hasura.RQL.IR.Insert.html#getInsertArrayRelationships"><span class="hs-identifier hs-var">IR.getInsertArrayRelationships</span></a></span><span> </span><span class="annot"><span class="annottext">[AnnotatedInsertRow ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687929748"><span class="hs-identifier hs-var">insObjs</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621687929746"><span class="annot"><span class="annottext">anyRelsToInsert :: Bool
</span><a href="#local-6989586621687929746"><span class="hs-identifier hs-var hs-var">anyRelsToInsert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ArrayRelationInsert ('Postgres pgKind) SQLExp] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[ArrayRelationInsert ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687929761"><span class="hs-identifier hs-var">allInsArrRels</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[ObjectRelationInsert ('Postgres pgKind) SQLExp] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[ObjectRelationInsert ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687929758"><span class="hs-identifier hs-var">allInsObjRels</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span>    </span><span id="local-6989586621687929744"><span class="annot"><span class="annottext">withoutRelsInsert :: m EncJSON
</span><a href="#local-6989586621687929744"><span class="hs-identifier hs-var hs-var">withoutRelsInsert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-107"></span><span>      </span><span class="annot"><span class="annottext">[[(PGCol, SQLExp)]] -&gt; ([(PGCol, SQLExp)] -&gt; m ()) -&gt; m ()
forall (m :: * -&gt; *) (t :: * -&gt; *) a b.
(QErrM m, Foldable t) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#indexedForM_"><span class="hs-identifier hs-var">indexedForM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnotatedInsertRow ('Postgres pgKind) SQLExp
-&gt; [(Column ('Postgres pgKind), SQLExp)]
AnnotatedInsertRow ('Postgres pgKind) SQLExp -&gt; [(PGCol, SQLExp)]
forall (b :: BackendType) v.
AnnotatedInsertRow b v -&gt; [(Column b, v)]
</span><a href="Hasura.RQL.IR.Insert.html#getInsertColumns"><span class="hs-identifier hs-var">IR.getInsertColumns</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnotatedInsertRow ('Postgres pgKind) SQLExp -&gt; [(PGCol, SQLExp)])
-&gt; [AnnotatedInsertRow ('Postgres pgKind) SQLExp]
-&gt; [[(PGCol, SQLExp)]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[AnnotatedInsertRow ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687929748"><span class="hs-identifier hs-var">insObjs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687929767"><span class="annot"><span class="annottext">[(PGCol, SQLExp)]
</span><a href="#local-6989586621687929767"><span class="hs-identifier hs-var">column</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><span class="annottext">[PGCol] -&gt; [RelInfo ('Postgres Any)] -&gt; [PGCol] -&gt; m ()
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
MonadError QErr m =&gt;
[PGCol] -&gt; [RelInfo ('Postgres pgKind)] -&gt; [PGCol] -&gt; m ()
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#validateInsert"><span class="hs-identifier hs-var">validateInsert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((PGCol, SQLExp) -&gt; PGCol) -&gt; [(PGCol, SQLExp)] -&gt; [PGCol]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(PGCol, SQLExp) -&gt; PGCol
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(PGCol, SQLExp)]
</span><a href="#local-6989586621687929767"><span class="hs-identifier hs-var">column</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap PGCol SQLExp -&gt; [PGCol]
forall k v. HashMap k v -&gt; [k]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#keys"><span class="hs-identifier hs-var">HashMap.keys</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
</span><a href="#local-6989586621687929738"><span class="hs-identifier hs-var">additionalColumns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687929771"><span class="annot"><span class="annottext">insObjRows :: [HashMap PGCol SQLExp]
</span><a href="#local-6989586621687929771"><span class="hs-identifier hs-var hs-var">insObjRows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(PGCol, SQLExp)] -&gt; HashMap PGCol SQLExp
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.Strict.html/Data.HashMap.Internal.Strict.html#fromList"><span class="hs-identifier hs-var">HashMap.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(PGCol, SQLExp)] -&gt; HashMap PGCol SQLExp)
-&gt; (AnnotatedInsertRow ('Postgres pgKind) SQLExp
    -&gt; [(PGCol, SQLExp)])
-&gt; AnnotatedInsertRow ('Postgres pgKind) SQLExp
-&gt; HashMap PGCol SQLExp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertRow ('Postgres pgKind) SQLExp
-&gt; [(Column ('Postgres pgKind), SQLExp)]
AnnotatedInsertRow ('Postgres pgKind) SQLExp -&gt; [(PGCol, SQLExp)]
forall (b :: BackendType) v.
AnnotatedInsertRow b v -&gt; [(Column b, v)]
</span><a href="Hasura.RQL.IR.Insert.html#getInsertColumns"><span class="hs-identifier hs-var">IR.getInsertColumns</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnotatedInsertRow ('Postgres pgKind) SQLExp
 -&gt; HashMap PGCol SQLExp)
-&gt; [AnnotatedInsertRow ('Postgres pgKind) SQLExp]
-&gt; [HashMap PGCol SQLExp]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[AnnotatedInsertRow ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687929748"><span class="hs-identifier hs-var">insObjs</span></a></span><span>
</span><span id="line-110"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621687929774"><span class="annot"><span class="annottext">HashSet PGCol
</span><a href="#local-6989586621687929774"><span class="hs-identifier hs-var">columnNames</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687929775"><span class="annot"><span class="annottext">[HashMap PGCol SQLExp]
</span><a href="#local-6989586621687929775"><span class="hs-identifier hs-var">insertRows</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SQLExp
-&gt; [HashMap PGCol SQLExp]
-&gt; (HashSet PGCol, [HashMap PGCol SQLExp])
forall a b.
Hashable a =&gt;
b -&gt; [HashMap a b] -&gt; (HashSet a, [HashMap a b])
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.HashMap.Strict.Extended.html/Data.HashMap.Strict.Extended.html#homogenise"><span class="hs-identifier hs-var">HashMap.homogenise</span></a></span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#columnDefaultValue"><span class="hs-identifier hs-var">Postgres.columnDefaultValue</span></a></span><span> </span><span class="annot"><span class="annottext">([HashMap PGCol SQLExp] -&gt; (HashSet PGCol, [HashMap PGCol SQLExp]))
-&gt; [HashMap PGCol SQLExp]
-&gt; (HashSet PGCol, [HashMap PGCol SQLExp])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(HashMap PGCol SQLExp -&gt; HashMap PGCol SQLExp)
-&gt; [HashMap PGCol SQLExp] -&gt; [HashMap PGCol SQLExp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PreSetColsG ('Postgres pgKind) SQLExp
HashMap PGCol SQLExp
</span><a href="#local-6989586621687929754"><span class="hs-identifier hs-var">presetRow</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
-&gt; HashMap PGCol SQLExp -&gt; HashMap PGCol SQLExp
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
</span><a href="#local-6989586621687929738"><span class="hs-identifier hs-var">additionalColumns</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
-&gt; HashMap PGCol SQLExp -&gt; HashMap PGCol SQLExp
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[HashMap PGCol SQLExp]
</span><a href="#local-6989586621687929771"><span class="hs-identifier hs-var">insObjRows</span></a></span><span>
</span><span id="line-111"></span><span>          </span><span id="local-6989586621687929778"><span class="annot"><span class="annottext">insertQuery :: InsertQueryP1 ('Postgres pgKind)
</span><a href="#local-6989586621687929778"><span class="hs-identifier hs-var hs-var">insertQuery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>            </span><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
-&gt; [Column ('Postgres pgKind)]
-&gt; [[SQLExpression ('Postgres pgKind)]]
-&gt; Maybe
     (OnConflictClause
        ('Postgres pgKind) (SQLExpression ('Postgres pgKind)))
-&gt; (AnnBoolExpSQL ('Postgres pgKind),
    Maybe (AnnBoolExpSQL ('Postgres pgKind)))
-&gt; MutationOutput ('Postgres pgKind)
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; InsertQueryP1 ('Postgres pgKind)
forall (b :: BackendType).
TableName b
-&gt; [Column b]
-&gt; [[SQLExpression b]]
-&gt; Maybe (OnConflictClause b (SQLExpression b))
-&gt; (AnnBoolExpSQL b, Maybe (AnnBoolExpSQL b))
-&gt; MutationOutput b
-&gt; [ColumnInfo b]
-&gt; InsertQueryP1 b
</span><a href="Hasura.RQL.IR.Insert.html#InsertQueryP1"><span class="hs-identifier hs-var">IR.InsertQueryP1</span></a></span><span>
</span><span id="line-113"></span><span>              </span><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
</span><a href="#local-6989586621687929749"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-114"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashSet PGCol -&gt; [PGCol]
forall a. HashSet a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">HashSet PGCol
</span><a href="#local-6989586621687929774"><span class="hs-identifier hs-var">columnNames</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(HashMap PGCol SQLExp -&gt; [SQLExp])
-&gt; [HashMap PGCol SQLExp] -&gt; [[SQLExp]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp -&gt; [SQLExp]
forall k v. HashMap k v -&gt; [v]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#elems"><span class="hs-identifier hs-var">HashMap.elems</span></a></span><span> </span><span class="annot"><span class="annottext">[HashMap PGCol SQLExp]
</span><a href="#local-6989586621687929775"><span class="hs-identifier hs-var">insertRows</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>              </span><span class="annot"><span class="annottext">Maybe
  (OnConflictClause
     ('Postgres pgKind) (SQLExpression ('Postgres pgKind)))
Maybe (OnConflictClause ('Postgres pgKind) SQLExp)
</span><a href="#local-6989586621687929756"><span class="hs-identifier hs-var">conflictClause</span></a></span><span>
</span><span id="line-117"></span><span>              </span><span class="annot"><span class="annottext">(AnnBoolExpSQL ('Postgres pgKind),
 Maybe (AnnBoolExpSQL ('Postgres pgKind)))
(AnnBoolExp ('Postgres pgKind) SQLExp,
 Maybe (AnnBoolExp ('Postgres pgKind) SQLExp))
</span><a href="#local-6989586621687929750"><span class="hs-identifier hs-var">checkCondition</span></a></span><span>
</span><span id="line-118"></span><span>              </span><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621687929740"><span class="hs-identifier hs-var">mutationOutput</span></a></span><span>
</span><span id="line-119"></span><span>              </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687929751"><span class="hs-identifier hs-var">columnInfos</span></a></span><span>
</span><span id="line-120"></span><span>          </span><span id="local-6989586621687929782"><span class="annot"><span class="annottext">rowCount :: Text
</span><a href="#local-6989586621687929782"><span class="hs-identifier hs-var hs-var">rowCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html/Hasura.Prelude.html#tshow"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Text)
-&gt; ([AnnotatedInsertRow ('Postgres pgKind) SQLExp] -&gt; Int)
-&gt; [AnnotatedInsertRow ('Postgres pgKind) SQLExp]
-&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[AnnotatedInsertRow ('Postgres pgKind) SQLExp] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">([AnnotatedInsertRow ('Postgres pgKind) SQLExp] -&gt; Text)
-&gt; [AnnotatedInsertRow ('Postgres pgKind) SQLExp] -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MultiObjectInsert ('Postgres pgKind) SQLExp
-&gt; [AnnotatedInsertRow ('Postgres pgKind) SQLExp]
forall (b :: BackendType) (f :: * -&gt; *) v.
AnnotatedInsertData b f v -&gt; f (AnnotatedInsertRow b v)
</span><a href="Hasura.RQL.IR.Insert.html#_aiInsertObject"><span class="hs-identifier hs-var">IR._aiInsertObject</span></a></span><span> </span><span class="annot"><span class="annottext">MultiObjectInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929737"><span class="hs-identifier hs-var">multiObjIns</span></a></span><span>
</span><span id="line-121"></span><span>      </span><span class="annot"><span class="annottext">Text -&gt; m EncJSON -&gt; m EncJSON
forall (m :: * -&gt; *) a.
(MonadIO m, MonadTrace m) =&gt;
Text -&gt; m a -&gt; m a
</span><a href="Hasura.Tracing.Class.html#newSpan"><span class="hs-identifier hs-var">Tracing.newSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Insert (&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687929782"><span class="hs-identifier hs-var">rowCount</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;) &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">QualifiedObject TableName -&gt; Text
forall a. ToTxt a =&gt; QualifiedObject a -&gt; Text
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#qualifiedObjectToText"><span class="hs-identifier hs-var">qualifiedObjectToText</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
QualifiedObject TableName
</span><a href="#local-6989586621687929749"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><span class="annottext">TraceMetadata -&gt; m ()
forall (m :: * -&gt; *). MonadTrace m =&gt; TraceMetadata -&gt; m ()
</span><a href="Hasura.Tracing.Class.html#attachMetadata"><span class="hs-identifier hs-var">Tracing.attachMetadata</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;count&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687929782"><span class="hs-identifier hs-var">rowCount</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><span class="annottext">StringifyNumbers
-&gt; Maybe NamingCase
-&gt; UserInfo
-&gt; (InsertQueryP1 ('Postgres pgKind), Seq PrepArg)
-&gt; m EncJSON
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m,
 MonadIO m) =&gt;
StringifyNumbers
-&gt; Maybe NamingCase
-&gt; UserInfo
-&gt; (InsertQueryP1 ('Postgres pgKind), Seq PrepArg)
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execInsertQuery"><span class="hs-identifier hs-var">PGE.execInsertQuery</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687929742"><span class="hs-identifier hs-var">stringifyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687929743"><span class="hs-identifier hs-var">tCase</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687929739"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InsertQueryP1 ('Postgres pgKind)
</span><a href="#local-6989586621687929778"><span class="hs-identifier hs-var">insertQuery</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687929741"><span class="hs-identifier hs-var">planVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621687929745"><span class="annot"><span class="annottext">withRelsInsert :: m EncJSON
</span><a href="#local-6989586621687929745"><span class="hs-identifier hs-var hs-var">withRelsInsert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-126"></span><span>      </span><span id="local-6989586621687929789"><span class="annot"><a href="#local-6989586621687929789"><span class="hs-identifier hs-var">insertRequests</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[AnnotatedInsertRow ('Postgres pgKind) SQLExp]
-&gt; (AnnotatedInsertRow ('Postgres pgKind) SQLExp
    -&gt; m (Int, Maybe (HashMap PGCol TxtEncodedVal)))
-&gt; m [(Int, Maybe (HashMap PGCol TxtEncodedVal))]
forall (m :: * -&gt; *) a b. QErrM m =&gt; [a] -&gt; (a -&gt; m b) -&gt; m [b]
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#indexedForM"><span class="hs-identifier hs-var">indexedForM</span></a></span><span> </span><span class="annot"><span class="annottext">[AnnotatedInsertRow ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687929748"><span class="hs-identifier hs-var">insObjs</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687929791"><span class="annot"><span class="annottext">AnnotatedInsertRow ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929791"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-127"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687929792"><span class="annot"><span class="annottext">singleObj :: AnnotatedInsertData ('Postgres pgKind) Single SQLExp
</span><a href="#local-6989586621687929792"><span class="hs-identifier hs-var hs-var">singleObj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single (AnnotatedInsertRow ('Postgres pgKind) SQLExp)
-&gt; TableName ('Postgres pgKind)
-&gt; (AnnBoolExp ('Postgres pgKind) SQLExp,
    Maybe (AnnBoolExp ('Postgres pgKind) SQLExp))
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; Maybe (NESeq (Column ('Postgres pgKind)))
-&gt; ExtraTableMetadata ('Postgres pgKind)
-&gt; PreSetColsG ('Postgres pgKind) SQLExp
-&gt; BackendInsert ('Postgres pgKind) SQLExp
-&gt; Maybe (ValidateInput ResolvedWebhook)
-&gt; AnnotatedInsertData ('Postgres pgKind) Single SQLExp
forall (b :: BackendType) (f :: * -&gt; *) v.
f (AnnotatedInsertRow b v)
-&gt; TableName b
-&gt; (AnnBoolExp b v, Maybe (AnnBoolExp b v))
-&gt; [ColumnInfo b]
-&gt; Maybe (NESeq (Column b))
-&gt; ExtraTableMetadata b
-&gt; PreSetColsG b v
-&gt; BackendInsert b v
-&gt; Maybe (ValidateInput ResolvedWebhook)
-&gt; AnnotatedInsertData b f v
</span><a href="Hasura.RQL.IR.Insert.html#AnnotatedInsertData"><span class="hs-identifier hs-var">IR.AnnotatedInsertData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnotatedInsertRow ('Postgres pgKind) SQLExp
-&gt; Single (AnnotatedInsertRow ('Postgres pgKind) SQLExp)
forall a. a -&gt; Single a
</span><a href="Hasura.RQL.IR.Insert.html#Single"><span class="hs-identifier hs-var">IR.Single</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertRow ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929791"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
</span><a href="#local-6989586621687929749"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnBoolExp ('Postgres pgKind) SQLExp,
 Maybe (AnnBoolExp ('Postgres pgKind) SQLExp))
</span><a href="#local-6989586621687929750"><span class="hs-identifier hs-var">checkCondition</span></a></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687929751"><span class="hs-identifier hs-var">columnInfos</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (NESeq (Column ('Postgres pgKind)))
</span><a href="#local-6989586621687929752"><span class="hs-identifier hs-var">_pk</span></a></span><span> </span><span class="annot"><span class="annottext">ExtraTableMetadata ('Postgres pgKind)
</span><a href="#local-6989586621687929753"><span class="hs-identifier hs-var">_extra</span></a></span><span> </span><span class="annot"><span class="annottext">PreSetColsG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929754"><span class="hs-identifier hs-var">presetRow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (OnConflictClause ('Postgres pgKind) SQLExp)
-&gt; BackendInsert pgKind SQLExp
forall (pgKind :: PostgresKind) v.
Maybe (OnConflictClause ('Postgres pgKind) v)
-&gt; BackendInsert pgKind v
</span><a href="Hasura.Backends.Postgres.Types.Insert.html#BackendInsert"><span class="hs-identifier hs-var">BackendInsert</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (OnConflictClause ('Postgres pgKind) SQLExp)
</span><a href="#local-6989586621687929756"><span class="hs-identifier hs-var">conflictClause</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (ValidateInput ResolvedWebhook)
</span><a href="#local-6989586621687929757"><span class="hs-identifier hs-var">_validateInput</span></a></span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><span class="annottext">AnnotatedInsertData ('Postgres pgKind) Single SQLExp
-&gt; HashMap PGCol SQLExp
-&gt; UserInfo
-&gt; Seq PrepArg
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; m (Int, Maybe (ColumnValues ('Postgres pgKind) TxtEncodedVal))
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, MonadIO m, MonadTrace m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m) =&gt;
SingleObjectInsert ('Postgres pgKind) SQLExp
-&gt; HashMap PGCol SQLExp
-&gt; UserInfo
-&gt; Seq PrepArg
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; m (Int, Maybe (ColumnValues ('Postgres pgKind) TxtEncodedVal))
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#insertObject"><span class="hs-identifier hs-var">insertObject</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertData ('Postgres pgKind) Single SQLExp
</span><a href="#local-6989586621687929792"><span class="hs-identifier hs-var">singleObj</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
</span><a href="#local-6989586621687929738"><span class="hs-identifier hs-var">additionalColumns</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687929739"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687929741"><span class="hs-identifier hs-var">planVars</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687929742"><span class="hs-identifier hs-var">stringifyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687929743"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687929795"><span class="annot"><a href="#local-6989586621687929795"><span class="hs-identifier hs-var hs-var">affectedRows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; [Int] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Int, Maybe (HashMap PGCol TxtEncodedVal)) -&gt; Int)
-&gt; [(Int, Maybe (HashMap PGCol TxtEncodedVal))] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Int, Maybe (HashMap PGCol TxtEncodedVal)) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Int, Maybe (HashMap PGCol TxtEncodedVal))]
</span><a href="#local-6989586621687929789"><span class="hs-identifier hs-var">insertRequests</span></a></span><span>
</span><span id="line-130"></span><span>          </span><span id="local-6989586621687929797"><span class="annot"><a href="#local-6989586621687929797"><span class="hs-identifier hs-var hs-var">columnValues</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Maybe (HashMap PGCol TxtEncodedVal))
 -&gt; Maybe (HashMap PGCol TxtEncodedVal))
-&gt; [(Int, Maybe (HashMap PGCol TxtEncodedVal))]
-&gt; [HashMap PGCol TxtEncodedVal]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b.
Filterable f =&gt;
(a -&gt; Maybe b) -&gt; f a -&gt; f b
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/witherable-0.5-ed5d92584b79c1fa03d7efeb1159ae93eef86189605b088dd8806eb40d0b16f5/share/doc/html/src/Witherable.html/Witherable.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Maybe (HashMap PGCol TxtEncodedVal))
-&gt; Maybe (HashMap PGCol TxtEncodedVal)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(Int, Maybe (HashMap PGCol TxtEncodedVal))]
</span><a href="#local-6989586621687929789"><span class="hs-identifier hs-var">insertRequests</span></a></span><span>
</span><span id="line-131"></span><span>      </span><span id="local-6989586621687929800"><span class="annot"><a href="#local-6989586621687929800"><span class="hs-identifier hs-var">selectExpr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Mutation.html#mkSelectExpFromColumnValues"><span class="hs-identifier hs-type">PGT.mkSelectExpFromColumnValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929749"><span class="hs-identifier hs-type">table</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929751"><span class="hs-identifier hs-type">columnInfos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929797"><span class="hs-identifier hs-type">columnValues</span></a></span><span>
</span><span id="line-132"></span><span>      </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#executeMutationOutputQuery"><span class="hs-identifier hs-type">PGE.executeMutationOutputQuery</span></a></span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><a href="#local-6989586621687929739"><span class="hs-identifier hs-type">userInfo</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><a href="#local-6989586621687929749"><span class="hs-identifier hs-type">table</span></a></span><span>
</span><span id="line-135"></span><span>        </span><span class="annot"><a href="#local-6989586621687929751"><span class="hs-identifier hs-type">columnInfos</span></a></span><span>
</span><span id="line-136"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621687929795"><span class="hs-identifier hs-type">affectedRows</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Returning.html#MCSelectValues"><span class="hs-identifier hs-type">PGT.MCSelectValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929800"><span class="hs-identifier hs-type">selectExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><a href="#local-6989586621687929740"><span class="hs-identifier hs-type">mutationOutput</span></a></span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><a href="#local-6989586621687929742"><span class="hs-identifier hs-type">stringifyNum</span></a></span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><a href="#local-6989586621687929743"><span class="hs-identifier hs-type">tCase</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#insertObject"><span class="hs-identifier hs-type">insertObject</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687929359"><span class="annot"><a href="#local-6989586621687929359"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687929358"><span class="annot"><a href="#local-6989586621687929358"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929358"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687929358"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.Class.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929358"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929359"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html#PostgresTranslateSelect"><span class="hs-identifier hs-type">PostgresTranslateSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929359"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929358"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-152"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#SingleObjectInsert"><span class="hs-identifier hs-type">IR.SingleObjectInsert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929359"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">Postgres.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#HashMap"><span class="hs-identifier hs-type">HashMap</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#PGCol"><span class="hs-identifier hs-type">PGCol</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">Postgres.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html/Database.PG.Query.Connection.html#PrepArg"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-156"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-157"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><a href="#local-6989586621687929358"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnValues"><span class="hs-identifier hs-type">ColumnValues</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929359"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.SQL.Value.html#TxtEncodedVal"><span class="hs-identifier hs-type">TxtEncodedVal</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span id="insertObject"><span class="annot"><span class="annottext">insertObject :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, MonadIO m, MonadTrace m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m) =&gt;
SingleObjectInsert ('Postgres pgKind) SQLExp
-&gt; HashMap PGCol SQLExp
-&gt; UserInfo
-&gt; Seq PrepArg
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; m (Int, Maybe (ColumnValues ('Postgres pgKind) TxtEncodedVal))
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#insertObject"><span class="hs-identifier hs-var hs-var">insertObject</span></a></span></span><span> </span><span id="local-6989586621687929895"><span class="annot"><span class="annottext">SingleObjectInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929895"><span class="hs-identifier hs-var">singleObjIns</span></a></span></span><span> </span><span id="local-6989586621687929896"><span class="annot"><span class="annottext">HashMap PGCol SQLExp
</span><a href="#local-6989586621687929896"><span class="hs-identifier hs-var">additionalColumns</span></a></span></span><span> </span><span id="local-6989586621687929897"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687929897"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687929898"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687929898"><span class="hs-identifier hs-var">planVars</span></a></span></span><span> </span><span id="local-6989586621687929899"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687929899"><span class="hs-identifier hs-var">stringifyNum</span></a></span></span><span> </span><span id="local-6989586621687929900"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687929900"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><span class="annottext">Text
-&gt; m (Int, Maybe (HashMap PGCol TxtEncodedVal))
-&gt; m (Int, Maybe (HashMap PGCol TxtEncodedVal))
forall (m :: * -&gt; *) a.
(MonadIO m, MonadTrace m) =&gt;
Text -&gt; m a -&gt; m a
</span><a href="Hasura.Tracing.Class.html#newSpan"><span class="hs-identifier hs-var">Tracing.newSpan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Insert &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">QualifiedObject TableName -&gt; Text
forall a. ToTxt a =&gt; QualifiedObject a -&gt; Text
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#qualifiedObjectToText"><span class="hs-identifier hs-var">qualifiedObjectToText</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
QualifiedObject TableName
</span><a href="#local-6989586621687929901"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><span class="annottext">[PGCol] -&gt; [RelInfo ('Postgres pgKind)] -&gt; [PGCol] -&gt; m ()
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
MonadError QErr m =&gt;
[PGCol] -&gt; [RelInfo ('Postgres pgKind)] -&gt; [PGCol] -&gt; m ()
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#validateInsert"><span class="hs-identifier hs-var">validateInsert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap PGCol SQLExp -&gt; [PGCol]
forall k v. HashMap k v -&gt; [k]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#keys"><span class="hs-identifier hs-var">HashMap.keys</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
</span><a href="#local-6989586621687929902"><span class="hs-identifier hs-var">columns</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RelationInsert
   ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)
 -&gt; RelInfo ('Postgres pgKind))
-&gt; [RelationInsert
      ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)]
-&gt; [RelInfo ('Postgres pgKind)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">RelationInsert
  ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)
-&gt; RelInfo ('Postgres pgKind)
forall (b :: BackendType) a. RelationInsert b a -&gt; RelInfo b
</span><a href="Hasura.RQL.IR.Insert.html#_riRelationInfo"><span class="hs-identifier hs-var">IR._riRelationInfo</span></a></span><span> </span><span class="annot"><span class="annottext">[RelationInsert
   ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)]
</span><a href="#local-6989586621687929904"><span class="hs-identifier hs-var">objectRels</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap PGCol SQLExp -&gt; [PGCol]
forall k v. HashMap k v -&gt; [k]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#keys"><span class="hs-identifier hs-var">HashMap.keys</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
</span><a href="#local-6989586621687929896"><span class="hs-identifier hs-var">additionalColumns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-comment">-- insert all object relations and fetch this insert dependent column values</span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621687929905"><span class="annot"><a href="#local-6989586621687929905"><span class="hs-identifier hs-var">objInsRes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[RelationInsert
   ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)]
-&gt; (RelationInsert
      ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)
    -&gt; m (Int, [(PGCol, SQLExp)]))
-&gt; m [(Int, [(PGCol, SQLExp)])]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">[RelationInsert
   ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)]
</span><a href="#local-6989586621687929907"><span class="hs-identifier hs-var">beforeInsert</span></a></span><span> </span><span class="annot"><span class="annottext">((RelationInsert
    ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)
  -&gt; m (Int, [(PGCol, SQLExp)]))
 -&gt; m [(Int, [(PGCol, SQLExp)])])
-&gt; (RelationInsert
      ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)
    -&gt; m (Int, [(PGCol, SQLExp)]))
-&gt; m [(Int, [(PGCol, SQLExp)])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
-&gt; UserInfo
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; RelationInsert
     ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)
-&gt; m (Int, [(PGCol, SQLExp)])
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, MonadIO m, MonadTrace m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m) =&gt;
Seq PrepArg
-&gt; UserInfo
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; ObjectRelationInsert ('Postgres pgKind) SQLExp
-&gt; m (Int, [(PGCol, SQLExp)])
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#insertObjRel"><span class="hs-identifier hs-var">insertObjRel</span></a></span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687929898"><span class="hs-identifier hs-var">planVars</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687929897"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687929899"><span class="hs-identifier hs-var">stringifyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687929900"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-comment">-- prepare final insert columns</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687929909"><span class="annot"><a href="#local-6989586621687929909"><span class="hs-identifier hs-var hs-var">objRelAffRows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; [Int] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Int, [(PGCol, SQLExp)]) -&gt; Int)
-&gt; [(Int, [(PGCol, SQLExp)])] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Int, [(PGCol, SQLExp)]) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Int, [(PGCol, SQLExp)])]
</span><a href="#local-6989586621687929905"><span class="hs-identifier hs-var">objInsRes</span></a></span><span>
</span><span id="line-168"></span><span>        </span><span id="local-6989586621687929910"><span class="annot"><a href="#local-6989586621687929910"><span class="hs-identifier hs-var hs-var">objRelDeterminedCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(PGCol, SQLExp)] -&gt; HashMap PGCol SQLExp
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.Strict.html/Data.HashMap.Internal.Strict.html#fromList"><span class="hs-identifier hs-var">HashMap.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(PGCol, SQLExp)] -&gt; HashMap PGCol SQLExp)
-&gt; [(PGCol, SQLExp)] -&gt; HashMap PGCol SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Int, [(PGCol, SQLExp)]) -&gt; [(PGCol, SQLExp)])
-&gt; [(Int, [(PGCol, SQLExp)])] -&gt; [(PGCol, SQLExp)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">(Int, [(PGCol, SQLExp)]) -&gt; [(PGCol, SQLExp)]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(Int, [(PGCol, SQLExp)])]
</span><a href="#local-6989586621687929905"><span class="hs-identifier hs-var">objInsRes</span></a></span><span>
</span><span id="line-169"></span><span>        </span><span id="local-6989586621687929911"><span class="annot"><a href="#local-6989586621687929911"><span class="hs-identifier hs-var hs-var">finalInsCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreSetColsG ('Postgres pgKind) SQLExp
HashMap PGCol SQLExp
</span><a href="#local-6989586621687929912"><span class="hs-identifier hs-var">presetValues</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
-&gt; HashMap PGCol SQLExp -&gt; HashMap PGCol SQLExp
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
</span><a href="#local-6989586621687929902"><span class="hs-identifier hs-var">columns</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
-&gt; HashMap PGCol SQLExp -&gt; HashMap PGCol SQLExp
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
</span><a href="#local-6989586621687929910"><span class="hs-identifier hs-var">objRelDeterminedCols</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
-&gt; HashMap PGCol SQLExp -&gt; HashMap PGCol SQLExp
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
</span><a href="#local-6989586621687929896"><span class="hs-identifier hs-var">additionalColumns</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621687929913"><span class="annot"><a href="#local-6989586621687929913"><span class="hs-identifier hs-var">cte</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#mkInsertQ"><span class="hs-identifier hs-type">mkInsertQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929897"><span class="hs-identifier hs-type">userInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929901"><span class="hs-identifier hs-type">table</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929915"><span class="hs-identifier hs-type">onConflict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929911"><span class="hs-identifier hs-type">finalInsCols</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929916"><span class="hs-identifier hs-type">checkCond</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-type">PGE.MutateResp</span></a></span><span> </span><span id="local-6989586621687929918"><span class="annot"><a href="#local-6989586621687929918"><span class="hs-identifier hs-var">affRows</span></a></span></span><span> </span><span id="local-6989586621687929919"><span class="annot"><a href="#local-6989586621687929919"><span class="hs-identifier hs-var">colVals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-type">liftTx</span></a></span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndFetchCols"><span class="hs-identifier hs-type">PGE.mutateAndFetchCols</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621687929359"><span class="hs-identifier hs-type">pgKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929897"><span class="hs-identifier hs-type">userInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929901"><span class="hs-identifier hs-type">table</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929922"><span class="hs-identifier hs-type">allColumns</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Returning.html#MCCheckConstraint"><span class="hs-identifier hs-type">PGT.MCCheckConstraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929913"><span class="hs-identifier hs-type">cte</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621687929898"><span class="hs-identifier hs-type">planVars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687929899"><span class="hs-identifier hs-type">stringifyNum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929900"><span class="hs-identifier hs-type">tCase</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621687929924"><span class="annot"><a href="#local-6989586621687929924"><span class="hs-identifier hs-var">colValM</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621687929925"><span class="hs-identifier hs-type">asSingleObject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929919"><span class="hs-identifier hs-type">colVals</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621687929926"><span class="annot"><a href="#local-6989586621687929926"><span class="hs-identifier hs-var">arrRelAffRows</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">bool</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621687929927"><span class="hs-identifier hs-type">withArrRels</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929924"><span class="hs-identifier hs-type">colValM</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621687929928"><span class="hs-identifier hs-type">allAfterInsertRels</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687929929"><span class="annot"><a href="#local-6989586621687929929"><span class="hs-identifier hs-var hs-var">totAffRows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621687929909"><span class="hs-identifier hs-var">objRelAffRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621687929918"><span class="hs-identifier hs-var">affRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621687929926"><span class="hs-identifier hs-var">arrRelAffRows</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621687929929"><span class="hs-identifier hs-type">totAffRows</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621687929924"><span class="hs-identifier hs-type">colValM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#AnnotatedInsertData"><span class="hs-identifier hs-type">IR.AnnotatedInsertData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#Single"><span class="hs-identifier hs-type">IR.Single</span></a></span><span> </span><span id="local-6989586621687929931"><span class="annot"><span class="annottext">AnnotatedInsertRow ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929931"><span class="hs-identifier hs-var">annObj</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621687929901"><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
</span><a href="#local-6989586621687929901"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span id="local-6989586621687929916"><span class="annot"><span class="annottext">(AnnBoolExp ('Postgres pgKind) SQLExp,
 Maybe (AnnBoolExp ('Postgres pgKind) SQLExp))
</span><a href="#local-6989586621687929916"><span class="hs-identifier hs-var">checkCond</span></a></span></span><span> </span><span id="local-6989586621687929922"><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687929922"><span class="hs-identifier hs-var">allColumns</span></a></span></span><span> </span><span id="local-6989586621687929932"><span class="annot"><span class="annottext">Maybe (NESeq (Column ('Postgres pgKind)))
</span><a href="#local-6989586621687929932"><span class="hs-identifier hs-var">_pk</span></a></span></span><span> </span><span id="local-6989586621687929933"><span class="annot"><span class="annottext">ExtraTableMetadata ('Postgres pgKind)
</span><a href="#local-6989586621687929933"><span class="hs-identifier hs-var">_extra</span></a></span></span><span> </span><span id="local-6989586621687929912"><span class="annot"><span class="annottext">PreSetColsG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929912"><span class="hs-identifier hs-var">presetValues</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Types.Insert.html#BackendInsert"><span class="hs-identifier hs-type">BackendInsert</span></a></span><span> </span><span id="local-6989586621687929915"><span class="annot"><span class="annottext">Maybe (OnConflictClause ('Postgres pgKind) SQLExp)
</span><a href="#local-6989586621687929915"><span class="hs-identifier hs-var">onConflict</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621687929934"><span class="annot"><span class="annottext">Maybe (ValidateInput ResolvedWebhook)
</span><a href="#local-6989586621687929934"><span class="hs-identifier hs-var">_validateInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingleObjectInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929895"><span class="hs-identifier hs-var">singleObjIns</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621687929902"><span class="annot"><span class="annottext">columns :: HashMap PGCol SQLExp
</span><a href="#local-6989586621687929902"><span class="hs-identifier hs-var hs-var">columns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(PGCol, SQLExp)] -&gt; HashMap PGCol SQLExp
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.Strict.html/Data.HashMap.Internal.Strict.html#fromList"><span class="hs-identifier hs-var">HashMap.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(PGCol, SQLExp)] -&gt; HashMap PGCol SQLExp)
-&gt; [(PGCol, SQLExp)] -&gt; HashMap PGCol SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertRow ('Postgres pgKind) SQLExp
-&gt; [(Column ('Postgres pgKind), SQLExp)]
forall (b :: BackendType) v.
AnnotatedInsertRow b v -&gt; [(Column b, v)]
</span><a href="Hasura.RQL.IR.Insert.html#getInsertColumns"><span class="hs-identifier hs-var">IR.getInsertColumns</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertRow ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929931"><span class="hs-identifier hs-var">annObj</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621687929904"><span class="annot"><span class="annottext">objectRels :: [RelationInsert
   ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)]
</span><a href="#local-6989586621687929904"><span class="hs-identifier hs-var hs-var">objectRels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertRow ('Postgres pgKind) SQLExp
-&gt; [RelationInsert
      ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)]
forall (b :: BackendType) v.
AnnotatedInsertRow b v -&gt; [ObjectRelationInsert b v]
</span><a href="Hasura.RQL.IR.Insert.html#getInsertObjectRelationships"><span class="hs-identifier hs-var">IR.getInsertObjectRelationships</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertRow ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929931"><span class="hs-identifier hs-var">annObj</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621687929935"><span class="annot"><span class="annottext">arrayRels :: [ArrayRelationInsert ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687929935"><span class="hs-identifier hs-var hs-var">arrayRels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertRow ('Postgres pgKind) SQLExp
-&gt; [ArrayRelationInsert ('Postgres pgKind) SQLExp]
forall (b :: BackendType) v.
AnnotatedInsertRow b v -&gt; [ArrayRelationInsert b v]
</span><a href="Hasura.RQL.IR.Insert.html#getInsertArrayRelationships"><span class="hs-identifier hs-var">IR.getInsertArrayRelationships</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertRow ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687929931"><span class="hs-identifier hs-var">annObj</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><a href="#local-6989586621687929936"><span class="hs-identifier hs-type">afterInsert</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621687929907"><span class="hs-identifier hs-type">beforeInsert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#ObjectRelationInsert"><span class="hs-identifier hs-type">IR.ObjectRelationInsert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929359"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">Postgres.SQLExp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621687929936"><span class="annot"><span class="annottext">[RelationInsert
   ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)]
</span><a href="#local-6989586621687929936"><span class="hs-identifier hs-var">afterInsert</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687929907"><span class="annot"><span class="annottext">[RelationInsert
   ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)]
</span><a href="#local-6989586621687929907"><span class="hs-identifier hs-var">beforeInsert</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-190"></span><span>      </span><span class="annot"><span class="annottext">(RelationInsert
   ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)
 -&gt; Bool)
-&gt; [RelationInsert
      ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)]
-&gt; ([RelationInsert
       ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)],
    [RelationInsert
       ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">L.partition</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">InsertOrder -&gt; InsertOrder -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">InsertOrder
</span><a href="Hasura.RQL.Types.Common.html#AfterParent"><span class="hs-identifier hs-var">AfterParent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(InsertOrder -&gt; Bool)
-&gt; (RelationInsert
      ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)
    -&gt; InsertOrder)
-&gt; RelationInsert
     ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind) -&gt; InsertOrder
forall (b :: BackendType). RelInfo b -&gt; InsertOrder
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riInsertOrder"><span class="hs-identifier hs-var">riInsertOrder</span></a></span><span> </span><span class="annot"><span class="annottext">(RelInfo ('Postgres pgKind) -&gt; InsertOrder)
-&gt; (RelationInsert
      ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)
    -&gt; RelInfo ('Postgres pgKind))
-&gt; RelationInsert
     ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)
-&gt; InsertOrder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RelationInsert
  ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)
-&gt; RelInfo ('Postgres pgKind)
forall (b :: BackendType) a. RelationInsert b a -&gt; RelInfo b
</span><a href="Hasura.RQL.IR.Insert.html#_riRelationInfo"><span class="hs-identifier hs-var">IR._riRelationInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RelationInsert
   ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)]
</span><a href="#local-6989586621687929904"><span class="hs-identifier hs-var">objectRels</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><a href="#local-6989586621687929928"><span class="hs-identifier hs-type">allAfterInsertRels</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#ArrayRelationInsert"><span class="hs-identifier hs-type">IR.ArrayRelationInsert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929359"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">Postgres.SQLExp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621687929928"><span class="annot"><span class="annottext">allAfterInsertRels :: [ArrayRelationInsert ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687929928"><span class="hs-identifier hs-var hs-var">allAfterInsertRels</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ArrayRelationInsert ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687929935"><span class="hs-identifier hs-var">arrayRels</span></a></span><span> </span><span class="annot"><span class="annottext">[ArrayRelationInsert ('Postgres pgKind) SQLExp]
-&gt; [ArrayRelationInsert ('Postgres pgKind) SQLExp]
-&gt; [ArrayRelationInsert ('Postgres pgKind) SQLExp]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RelationInsert
   ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)
 -&gt; ArrayRelationInsert ('Postgres pgKind) SQLExp)
-&gt; [RelationInsert
      ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)]
-&gt; [ArrayRelationInsert ('Postgres pgKind) SQLExp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">RelationInsert
  ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)
-&gt; ArrayRelationInsert ('Postgres pgKind) SQLExp
forall a (b :: BackendType).
ObjectRelationInsert b a -&gt; ArrayRelationInsert b a
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#objToArr"><span class="hs-identifier hs-var">objToArr</span></a></span><span> </span><span class="annot"><span class="annottext">[RelationInsert
   ('Postgres pgKind) (SingleObjectInsert ('Postgres pgKind) SQLExp)]
</span><a href="#local-6989586621687929936"><span class="hs-identifier hs-var">afterInsert</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><a href="#local-6989586621687929941"><span class="hs-identifier hs-type">afterInsertDepCols</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929359"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-196"></span><span>    </span><span id="local-6989586621687929941"><span class="annot"><span class="annottext">afterInsertDepCols :: [ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687929941"><span class="hs-identifier hs-var hs-var">afterInsertDepCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-197"></span><span>      </span><span class="annot"><span class="annottext">([PGCol]
 -&gt; [ColumnInfo ('Postgres pgKind)]
 -&gt; [ColumnInfo ('Postgres pgKind)])
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; [PGCol]
-&gt; [ColumnInfo ('Postgres pgKind)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType).
Backend b =&gt;
[Column b] -&gt; [ColumnInfo b] -&gt; [ColumnInfo b]
</span><a href="Hasura.RQL.Types.Column.html#getColInfos"><span class="hs-identifier hs-var">getColInfos</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929359"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687929922"><span class="hs-identifier hs-var">allColumns</span></a></span><span>
</span><span id="line-198"></span><span>        </span><span class="annot"><span class="annottext">([PGCol] -&gt; [ColumnInfo ('Postgres pgKind)])
-&gt; [PGCol] -&gt; [ColumnInfo ('Postgres pgKind)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ArrayRelationInsert ('Postgres pgKind) SQLExp -&gt; [PGCol])
-&gt; [ArrayRelationInsert ('Postgres pgKind) SQLExp] -&gt; [PGCol]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap PGCol PGCol -&gt; [PGCol]
forall k v. HashMap k v -&gt; [k]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#keys"><span class="hs-identifier hs-var">HashMap.keys</span></a></span><span> </span><span class="annot"><span class="annottext">(HashMap PGCol PGCol -&gt; [PGCol])
-&gt; (ArrayRelationInsert ('Postgres pgKind) SQLExp
    -&gt; HashMap PGCol PGCol)
-&gt; ArrayRelationInsert ('Postgres pgKind) SQLExp
-&gt; [PGCol]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RelMapping ('Postgres pgKind)
-&gt; HashMap
     (ColumnPath ('Postgres pgKind)) (ColumnPath ('Postgres pgKind))
RelMapping ('Postgres pgKind) -&gt; HashMap PGCol PGCol
forall (b :: BackendType).
RelMapping b -&gt; HashMap (ColumnPath b) (ColumnPath b)
</span><a href="Hasura.RQL.Types.Relationships.Local.html#unRelMapping"><span class="hs-identifier hs-var">unRelMapping</span></a></span><span> </span><span class="annot"><span class="annottext">(RelMapping ('Postgres pgKind) -&gt; HashMap PGCol PGCol)
-&gt; (ArrayRelationInsert ('Postgres pgKind) SQLExp
    -&gt; RelMapping ('Postgres pgKind))
-&gt; ArrayRelationInsert ('Postgres pgKind) SQLExp
-&gt; HashMap PGCol PGCol
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind) -&gt; RelMapping ('Postgres pgKind)
forall (b :: BackendType). RelInfo b -&gt; RelMapping b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riMapping"><span class="hs-identifier hs-var">riMapping</span></a></span><span> </span><span class="annot"><span class="annottext">(RelInfo ('Postgres pgKind) -&gt; RelMapping ('Postgres pgKind))
-&gt; (ArrayRelationInsert ('Postgres pgKind) SQLExp
    -&gt; RelInfo ('Postgres pgKind))
-&gt; ArrayRelationInsert ('Postgres pgKind) SQLExp
-&gt; RelMapping ('Postgres pgKind)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ArrayRelationInsert ('Postgres pgKind) SQLExp
-&gt; RelInfo ('Postgres pgKind)
forall (b :: BackendType) a. RelationInsert b a -&gt; RelInfo b
</span><a href="Hasura.RQL.IR.Insert.html#_riRelationInfo"><span class="hs-identifier hs-var">IR._riRelationInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ArrayRelationInsert ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687929928"><span class="hs-identifier hs-var">allAfterInsertRels</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><a href="#local-6989586621687929927"><span class="hs-identifier hs-type">withArrRels</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-201"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnValues"><span class="hs-identifier hs-type">ColumnValues</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929359"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.SQL.Value.html#TxtEncodedVal"><span class="hs-identifier hs-type">TxtEncodedVal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-202"></span><span>      </span><span class="annot"><a href="#local-6989586621687929358"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621687929927"><span class="annot"><span class="annottext">withArrRels :: Maybe (HashMap (Column ('Postgres pgKind)) TxtEncodedVal) -&gt; m Int
</span><a href="#local-6989586621687929927"><span class="hs-identifier hs-var hs-var">withArrRels</span></a></span></span><span> </span><span id="local-6989586621687929946"><span class="annot"><span class="annottext">Maybe (HashMap (Column ('Postgres pgKind)) TxtEncodedVal)
</span><a href="#local-6989586621687929946"><span class="hs-identifier hs-var">colValM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-204"></span><span>      </span><span id="local-6989586621687929947"><span class="annot"><a href="#local-6989586621687929947"><span class="hs-identifier hs-var">colVal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (HashMap PGCol TxtEncodedVal)
-&gt; m (HashMap PGCol TxtEncodedVal)
-&gt; m (HashMap PGCol TxtEncodedVal)
forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; m a -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html/Hasura.Prelude.html#onNothing"><span class="hs-identifier hs-var">onNothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HashMap (Column ('Postgres pgKind)) TxtEncodedVal)
Maybe (HashMap PGCol TxtEncodedVal)
</span><a href="#local-6989586621687929946"><span class="hs-identifier hs-var">colValM</span></a></span><span> </span><span class="annot"><span class="annottext">(m (HashMap PGCol TxtEncodedVal)
 -&gt; m (HashMap PGCol TxtEncodedVal))
-&gt; m (HashMap PGCol TxtEncodedVal)
-&gt; m (HashMap PGCol TxtEncodedVal)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m (HashMap PGCol TxtEncodedVal)
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687929951"><span class="hs-identifier hs-var">cannotInsArrRelErr</span></a></span><span>
</span><span id="line-205"></span><span>      </span><span id="local-6989586621687929952"><span class="annot"><a href="#local-6989586621687929952"><span class="hs-identifier hs-var">afterInsertDepColsWithVal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#fetchFromColVals"><span class="hs-identifier hs-type">fetchFromColVals</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929947"><span class="hs-identifier hs-type">colVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929941"><span class="hs-identifier hs-type">afterInsertDepCols</span></a></span><span>
</span><span id="line-206"></span><span>      </span><span id="local-6989586621687929954"><span class="annot"><a href="#local-6989586621687929954"><span class="hs-identifier hs-var">arrInsARows</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">forM</span></span><span> </span><span class="annot"><a href="#local-6989586621687929928"><span class="hs-identifier hs-type">allAfterInsertRels</span></a></span><span>
</span><span id="line-208"></span><span>          </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#insertArrRel"><span class="hs-identifier hs-type">insertArrRel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929952"><span class="hs-identifier hs-type">afterInsertDepColsWithVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929897"><span class="hs-identifier hs-type">userInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929898"><span class="hs-identifier hs-type">planVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929899"><span class="hs-identifier hs-type">stringifyNum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929900"><span class="hs-identifier hs-type">tCase</span></a></span><span>
</span><span id="line-209"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">sum</span></span><span> </span><span class="annot"><a href="#local-6989586621687929954"><span class="hs-identifier hs-type">arrInsARows</span></a></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><a href="#local-6989586621687929925"><span class="hs-identifier hs-type">asSingleObject</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-212"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnValues"><span class="hs-identifier hs-type">ColumnValues</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929359"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.SQL.Value.html#TxtEncodedVal"><span class="hs-identifier hs-type">TxtEncodedVal</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-213"></span><span>      </span><span class="annot"><a href="#local-6989586621687929358"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnValues"><span class="hs-identifier hs-type">ColumnValues</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929359"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.SQL.Value.html#TxtEncodedVal"><span class="hs-identifier hs-type">TxtEncodedVal</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621687929925"><span class="annot"><span class="annottext">asSingleObject :: [HashMap (Column ('Postgres pgKind)) TxtEncodedVal]
-&gt; m (Maybe (HashMap (Column ('Postgres pgKind)) TxtEncodedVal))
</span><a href="#local-6989586621687929925"><span class="hs-identifier hs-var hs-var">asSingleObject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-215"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (HashMap PGCol TxtEncodedVal)
-&gt; m (Maybe (HashMap PGCol TxtEncodedVal))
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (HashMap PGCol TxtEncodedVal)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-216"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621687929956"><span class="annot"><span class="annottext">HashMap (Column ('Postgres pgKind)) TxtEncodedVal
</span><a href="#local-6989586621687929956"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (HashMap (Column ('Postgres pgKind)) TxtEncodedVal)
-&gt; m (Maybe (HashMap (Column ('Postgres pgKind)) TxtEncodedVal))
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (HashMap (Column ('Postgres pgKind)) TxtEncodedVal)
 -&gt; m (Maybe (HashMap (Column ('Postgres pgKind)) TxtEncodedVal)))
-&gt; Maybe (HashMap (Column ('Postgres pgKind)) TxtEncodedVal)
-&gt; m (Maybe (HashMap (Column ('Postgres pgKind)) TxtEncodedVal))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol TxtEncodedVal -&gt; Maybe (HashMap PGCol TxtEncodedVal)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">HashMap (Column ('Postgres pgKind)) TxtEncodedVal
HashMap PGCol TxtEncodedVal
</span><a href="#local-6989586621687929956"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><span class="annottext">[HashMap (Column ('Postgres pgKind)) TxtEncodedVal]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; m (Maybe (HashMap PGCol TxtEncodedVal))
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw500"><span class="hs-identifier hs-var">throw500</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;more than one row returned&quot;</span></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><a href="#local-6989586621687929951"><span class="hs-identifier hs-type">cannotInsArrRelErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621687929951"><span class="annot"><span class="annottext">cannotInsArrRelErr :: Text
</span><a href="#local-6989586621687929951"><span class="hs-identifier hs-var hs-var">cannotInsArrRelErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cannot proceed to insert array relations since insert to table &quot;</span></span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
QualifiedObject TableName
</span><a href="#local-6989586621687929901"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><span class="annottext">QualifiedObject TableName -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; affects zero rows&quot;</span></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#objToArr"><span class="hs-identifier hs-type">objToArr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687929399"><span class="annot"><a href="#local-6989586621687929399"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621687929398"><span class="annot"><a href="#local-6989586621687929398"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#ObjectRelationInsert"><span class="hs-identifier hs-type">IR.ObjectRelationInsert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929398"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929399"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#ArrayRelationInsert"><span class="hs-identifier hs-type">IR.ArrayRelationInsert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929398"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929399"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-226"></span><span id="objToArr"><span class="annot"><span class="annottext">objToArr :: forall a (b :: BackendType).
ObjectRelationInsert b a -&gt; ArrayRelationInsert b a
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#objToArr"><span class="hs-identifier hs-var hs-var">objToArr</span></a></span></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#RelationInsert"><span class="hs-identifier hs-type">IR.RelationInsert</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687929960"><span id="local-6989586621687929961"><span class="annot"><span class="annottext">RelInfo b
SingleObjectInsert b a
_riRelationInfo :: forall (b :: BackendType) a. RelationInsert b a -&gt; RelInfo b
_riInsertData :: SingleObjectInsert b a
_riRelationInfo :: RelInfo b
_riInsertData :: forall (b :: BackendType) a. RelationInsert b a -&gt; a
</span><a href="Hasura.RQL.IR.Insert.html#_riRelationInfo"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MultiObjectInsert b a
-&gt; RelInfo b -&gt; RelationInsert b (MultiObjectInsert b a)
forall (b :: BackendType) a. a -&gt; RelInfo b -&gt; RelationInsert b a
</span><a href="Hasura.RQL.IR.Insert.html#RelationInsert"><span class="hs-identifier hs-var">IR.RelationInsert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingleObjectInsert b a -&gt; MultiObjectInsert b a
</span><a href="#local-6989586621687929963"><span class="hs-identifier hs-var">singleToMulti</span></a></span><span> </span><span class="annot"><span class="annottext">SingleObjectInsert b a
</span><a href="#local-6989586621687929960"><span class="hs-identifier hs-var">_riInsertData</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RelInfo b
</span><a href="#local-6989586621687929961"><span class="hs-identifier hs-var">_riRelationInfo</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><a href="#local-6989586621687929963"><span class="hs-identifier hs-type">singleToMulti</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#SingleObjectInsert"><span class="hs-identifier hs-type">IR.SingleObjectInsert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929398"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929399"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#MultiObjectInsert"><span class="hs-identifier hs-type">IR.MultiObjectInsert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929398"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929399"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621687929963"><span class="annot"><span class="annottext">singleToMulti :: SingleObjectInsert b a -&gt; MultiObjectInsert b a
</span><a href="#local-6989586621687929963"><span class="hs-identifier hs-var hs-var">singleToMulti</span></a></span></span><span> </span><span id="local-6989586621687929964"><span class="annot"><span class="annottext">SingleObjectInsert b a
</span><a href="#local-6989586621687929964"><span class="hs-identifier hs-var">annIns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingleObjectInsert b a
</span><a href="#local-6989586621687929964"><span class="hs-identifier hs-var">annIns</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#_aiInsertObject"><span class="hs-identifier hs-var">IR._aiInsertObject</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#unSingle"><span class="hs-identifier hs-var">IR.unSingle</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#_aiInsertObject"><span class="hs-identifier hs-var">IR._aiInsertObject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929964"><span class="hs-identifier hs-type">annIns</span></a></span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#insertObjRel"><span class="hs-identifier hs-type">insertObjRel</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687929385"><span class="annot"><a href="#local-6989586621687929385"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687929384"><span class="annot"><a href="#local-6989586621687929384"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929384"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687929384"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-235"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.Class.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929384"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929385"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html#PostgresTranslateSelect"><span class="hs-identifier hs-type">PostgresTranslateSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929385"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-238"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929384"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html/Database.PG.Query.Connection.html#PrepArg"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#ObjectRelationInsert"><span class="hs-identifier hs-type">IR.ObjectRelationInsert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929385"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">Postgres.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><a href="#local-6989586621687929384"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#PGCol"><span class="hs-identifier hs-type">PGCol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">Postgres.SQLExp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span id="insertObjRel"><span class="annot"><span class="annottext">insertObjRel :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, MonadIO m, MonadTrace m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m) =&gt;
Seq PrepArg
-&gt; UserInfo
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; ObjectRelationInsert ('Postgres pgKind) SQLExp
-&gt; m (Int, [(PGCol, SQLExp)])
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#insertObjRel"><span class="hs-identifier hs-var hs-var">insertObjRel</span></a></span></span><span> </span><span id="local-6989586621687930014"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687930014"><span class="hs-identifier hs-var">planVars</span></a></span></span><span> </span><span id="local-6989586621687930015"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687930015"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687930016"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687930016"><span class="hs-identifier hs-var">stringifyNum</span></a></span></span><span> </span><span id="local-6989586621687930017"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687930017"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span id="local-6989586621687930018"><span class="annot"><span class="annottext">ObjectRelationInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687930018"><span class="hs-identifier hs-var">objRelIns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-247"></span><span>  </span><span class="annot"><span class="annottext">Text -&gt; m (Int, [(PGCol, SQLExp)]) -&gt; m (Int, [(PGCol, SQLExp)])
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RelName -&gt; Text
</span><a href="Hasura.RQL.Types.Common.html#relNameToTxt"><span class="hs-identifier hs-var">relNameToTxt</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687930020"><span class="hs-identifier hs-var">relName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (Int, [(PGCol, SQLExp)]) -&gt; m (Int, [(PGCol, SQLExp)]))
-&gt; m (Int, [(PGCol, SQLExp)]) -&gt; m (Int, [(PGCol, SQLExp)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621687930021"><span class="annot"><a href="#local-6989586621687930021"><span class="hs-identifier hs-var">affRows</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687930022"><span class="annot"><a href="#local-6989586621687930022"><span class="hs-identifier hs-var">colValM</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; m (Int, Maybe (HashMap PGCol TxtEncodedVal))
-&gt; m (Int, Maybe (HashMap PGCol TxtEncodedVal))
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;data&quot;</span></span><span> </span><span class="annot"><span class="annottext">(m (Int, Maybe (HashMap PGCol TxtEncodedVal))
 -&gt; m (Int, Maybe (HashMap PGCol TxtEncodedVal)))
-&gt; m (Int, Maybe (HashMap PGCol TxtEncodedVal))
-&gt; m (Int, Maybe (HashMap PGCol TxtEncodedVal))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SingleObjectInsert ('Postgres pgKind) SQLExp
-&gt; HashMap PGCol SQLExp
-&gt; UserInfo
-&gt; Seq PrepArg
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; m (Int, Maybe (ColumnValues ('Postgres pgKind) TxtEncodedVal))
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, MonadIO m, MonadTrace m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m) =&gt;
SingleObjectInsert ('Postgres pgKind) SQLExp
-&gt; HashMap PGCol SQLExp
-&gt; UserInfo
-&gt; Seq PrepArg
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; m (Int, Maybe (ColumnValues ('Postgres pgKind) TxtEncodedVal))
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#insertObject"><span class="hs-identifier hs-var">insertObject</span></a></span><span> </span><span class="annot"><span class="annottext">SingleObjectInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687930023"><span class="hs-identifier hs-var">singleObjIns</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687930015"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687930014"><span class="hs-identifier hs-var">planVars</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687930016"><span class="hs-identifier hs-var">stringifyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687930017"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span id="local-6989586621687930024"><span class="annot"><a href="#local-6989586621687930024"><span class="hs-identifier hs-var">colVal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html/Hasura.Prelude.html#onNothing"><span class="hs-identifier hs-type">onNothing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687930022"><span class="hs-identifier hs-type">colValM</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-type">throw400</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-type">NotSupported</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687930025"><span class="hs-identifier hs-type">errMsg</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span id="local-6989586621687930026"><span class="annot"><a href="#local-6989586621687930026"><span class="hs-identifier hs-var">retColsWithVals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#fetchFromColVals"><span class="hs-identifier hs-type">fetchFromColVals</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687930024"><span class="hs-identifier hs-type">colVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687930027"><span class="hs-identifier hs-type">rColInfos</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687930028"><span class="annot"><a href="#local-6989586621687930028"><span class="hs-identifier hs-var hs-var">columns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((PGCol, PGCol) -&gt; Maybe (PGCol, SQLExp))
 -&gt; [(PGCol, PGCol)] -&gt; [(PGCol, SQLExp)])
-&gt; [(PGCol, PGCol)]
-&gt; ((PGCol, PGCol) -&gt; Maybe (PGCol, SQLExp))
-&gt; [(PGCol, SQLExp)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((PGCol, PGCol) -&gt; Maybe (PGCol, SQLExp))
-&gt; [(PGCol, PGCol)] -&gt; [(PGCol, SQLExp)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b.
Filterable f =&gt;
(a -&gt; Maybe b) -&gt; f a -&gt; f b
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/witherable-0.5-ed5d92584b79c1fa03d7efeb1159ae93eef86189605b088dd8806eb40d0b16f5/share/doc/html/src/Witherable.html/Witherable.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap PGCol PGCol -&gt; [(PGCol, PGCol)]
forall k v. HashMap k v -&gt; [(k, v)]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#toList"><span class="hs-identifier hs-var">HashMap.toList</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap
  (ColumnPath ('Postgres pgKind)) (ColumnPath ('Postgres pgKind))
HashMap PGCol PGCol
</span><a href="#local-6989586621687930030"><span class="hs-identifier hs-var">mapCols</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621687930031"><span class="annot"><span class="annottext">PGCol
</span><a href="#local-6989586621687930031"><span class="hs-identifier hs-var">column</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687930032"><span class="annot"><span class="annottext">PGCol
</span><a href="#local-6989586621687930032"><span class="hs-identifier hs-var">target</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-252"></span><span>          </span><span id="local-6989586621687930033"><span class="annot"><a href="#local-6989586621687930033"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PGCol -&gt; [(PGCol, SQLExp)] -&gt; Maybe SQLExp
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">PGCol
</span><a href="#local-6989586621687930032"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">[(PGCol, SQLExp)]
</span><a href="#local-6989586621687930026"><span class="hs-identifier hs-var">retColsWithVals</span></a></span><span>
</span><span id="line-253"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621687930031"><span class="hs-identifier hs-type">column</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621687930033"><span class="hs-identifier hs-type">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621687930021"><span class="hs-identifier hs-type">affRows</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621687930028"><span class="hs-identifier hs-type">columns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#RelationInsert"><span class="hs-identifier hs-type">IR.RelationInsert</span></a></span><span> </span><span id="local-6989586621687930023"><span class="annot"><span class="annottext">SingleObjectInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687930023"><span class="hs-identifier hs-var">singleObjIns</span></a></span></span><span> </span><span id="local-6989586621687930035"><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind)
</span><a href="#local-6989586621687930035"><span class="hs-identifier hs-var">relInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ObjectRelationInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687930018"><span class="hs-identifier hs-var">objRelIns</span></a></span><span>
</span><span id="line-257"></span><span>    </span><span id="local-6989586621687930020"><span class="annot"><span class="annottext">relName :: RelName
</span><a href="#local-6989586621687930020"><span class="hs-identifier hs-var hs-var">relName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind) -&gt; RelName
forall (b :: BackendType). RelInfo b -&gt; RelName
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riName"><span class="hs-identifier hs-var">riName</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind)
</span><a href="#local-6989586621687930035"><span class="hs-identifier hs-var">relInfo</span></a></span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621687930037"><span class="annot"><span class="annottext">table :: QualifiedObject TableName
</span><a href="#local-6989586621687930037"><span class="hs-identifier hs-var hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind) -&gt; RelTarget ('Postgres pgKind)
forall (b :: BackendType). RelInfo b -&gt; RelTarget b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riTarget"><span class="hs-identifier hs-var">riTarget</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind)
</span><a href="#local-6989586621687930035"><span class="hs-identifier hs-var">relInfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-259"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelTargetNativeQuery"><span class="hs-identifier hs-type">RelTargetNativeQuery</span></a></span><span> </span><span class="annot"><span class="annottext">NativeQueryName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; QualifiedObject TableName
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;insertObjRel RelTargetNativeQuery&quot;</span></span><span>
</span><span id="line-260"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelTargetTable"><span class="hs-identifier hs-type">RelTargetTable</span></a></span><span> </span><span id="local-6989586621687930042"><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
</span><a href="#local-6989586621687930042"><span class="hs-identifier hs-var">tn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
QualifiedObject TableName
</span><a href="#local-6989586621687930042"><span class="hs-identifier hs-var">tn</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621687930030"><span class="annot"><span class="annottext">mapCols :: HashMap
  (ColumnPath ('Postgres pgKind)) (ColumnPath ('Postgres pgKind))
</span><a href="#local-6989586621687930030"><span class="hs-identifier hs-var hs-var">mapCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelMapping ('Postgres pgKind)
-&gt; HashMap
     (ColumnPath ('Postgres pgKind)) (ColumnPath ('Postgres pgKind))
forall (b :: BackendType).
RelMapping b -&gt; HashMap (ColumnPath b) (ColumnPath b)
</span><a href="Hasura.RQL.Types.Relationships.Local.html#unRelMapping"><span class="hs-identifier hs-var">unRelMapping</span></a></span><span> </span><span class="annot"><span class="annottext">(RelMapping ('Postgres pgKind)
 -&gt; HashMap
      (ColumnPath ('Postgres pgKind)) (ColumnPath ('Postgres pgKind)))
-&gt; RelMapping ('Postgres pgKind)
-&gt; HashMap
     (ColumnPath ('Postgres pgKind)) (ColumnPath ('Postgres pgKind))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind) -&gt; RelMapping ('Postgres pgKind)
forall (b :: BackendType). RelInfo b -&gt; RelMapping b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riMapping"><span class="hs-identifier hs-var">riMapping</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind)
</span><a href="#local-6989586621687930035"><span class="hs-identifier hs-var">relInfo</span></a></span><span>
</span><span id="line-262"></span><span>    </span><span id="local-6989586621687930043"><span class="annot"><span class="annottext">allCols :: [ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687930043"><span class="hs-identifier hs-var hs-var">allCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingleObjectInsert ('Postgres pgKind) SQLExp
-&gt; [ColumnInfo ('Postgres pgKind)]
forall (b :: BackendType) (f :: * -&gt; *) v.
AnnotatedInsertData b f v -&gt; [ColumnInfo b]
</span><a href="Hasura.RQL.IR.Insert.html#_aiTableColumns"><span class="hs-identifier hs-var">IR._aiTableColumns</span></a></span><span> </span><span class="annot"><span class="annottext">SingleObjectInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687930023"><span class="hs-identifier hs-var">singleObjIns</span></a></span><span>
</span><span id="line-263"></span><span>    </span><span id="local-6989586621687930045"><span class="annot"><span class="annottext">rCols :: [PGCol]
</span><a href="#local-6989586621687930045"><span class="hs-identifier hs-var hs-var">rCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashMap PGCol PGCol -&gt; [PGCol]
forall k v. HashMap k v -&gt; [v]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#elems"><span class="hs-identifier hs-var">HashMap.elems</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap
  (ColumnPath ('Postgres pgKind)) (ColumnPath ('Postgres pgKind))
HashMap PGCol PGCol
</span><a href="#local-6989586621687930030"><span class="hs-identifier hs-var">mapCols</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span id="local-6989586621687930027"><span class="annot"><span class="annottext">rColInfos :: [ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687930027"><span class="hs-identifier hs-var hs-var">rColInfos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Column ('Postgres pgKind)]
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; [ColumnInfo ('Postgres pgKind)]
forall (b :: BackendType).
Backend b =&gt;
[Column b] -&gt; [ColumnInfo b] -&gt; [ColumnInfo b]
</span><a href="Hasura.RQL.Types.Column.html#getColInfos"><span class="hs-identifier hs-var">getColInfos</span></a></span><span> </span><span class="annot"><span class="annottext">[Column ('Postgres pgKind)]
[PGCol]
</span><a href="#local-6989586621687930045"><span class="hs-identifier hs-var">rCols</span></a></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687930043"><span class="hs-identifier hs-var">allCols</span></a></span><span>
</span><span id="line-265"></span><span>    </span><span id="local-6989586621687930025"><span class="annot"><span class="annottext">errMsg :: Text
</span><a href="#local-6989586621687930025"><span class="hs-identifier hs-var hs-var">errMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-266"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cannot proceed to insert object relation &quot;</span></span><span>
</span><span id="line-267"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687930020"><span class="hs-identifier hs-var">relName</span></a></span><span>
</span><span id="line-268"></span><span>        </span><span class="annot"><span class="annottext">RelName -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; since insert to table &quot;</span></span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">QualifiedObject TableName
</span><a href="#local-6989586621687930037"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><span class="annottext">QualifiedObject TableName -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; affects zero rows&quot;</span></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span id="local-6989586621687929415"><span id="local-6989586621687929416"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#insertArrRel"><span class="hs-identifier hs-type">insertArrRel</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929415"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687929415"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.Class.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929415"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929416"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html#PostgresTranslateSelect"><span class="hs-identifier hs-type">PostgresTranslateSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929416"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929415"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#PGCol"><span class="hs-identifier hs-type">PGCol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">Postgres.SQLExp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-282"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html/Database.PG.Query.Connection.html#PrepArg"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-285"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#ArrayRelationInsert"><span class="hs-identifier hs-type">IR.ArrayRelationInsert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929416"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">Postgres.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-286"></span><span>  </span><span class="annot"><a href="#local-6989586621687929415"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span><span>
</span><span id="line-287"></span><span id="insertArrRel"><span class="annot"><span class="annottext">insertArrRel :: forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, MonadIO m, MonadTrace m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m) =&gt;
[(PGCol, SQLExp)]
-&gt; UserInfo
-&gt; Seq PrepArg
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; ArrayRelationInsert ('Postgres pgKind) SQLExp
-&gt; m Int
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#insertArrRel"><span class="hs-identifier hs-var hs-var">insertArrRel</span></a></span></span><span> </span><span id="local-6989586621687930094"><span class="annot"><span class="annottext">[(PGCol, SQLExp)]
</span><a href="#local-6989586621687930094"><span class="hs-identifier hs-var">resCols</span></a></span></span><span> </span><span id="local-6989586621687930095"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687930095"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687930096"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687930096"><span class="hs-identifier hs-var">planVars</span></a></span></span><span> </span><span id="local-6989586621687930097"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687930097"><span class="hs-identifier hs-var">stringifyNum</span></a></span></span><span> </span><span id="local-6989586621687930098"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687930098"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span id="local-6989586621687930099"><span class="annot"><span class="annottext">ArrayRelationInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687930099"><span class="hs-identifier hs-var">arrRelIns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-288"></span><span>  </span><span class="annot"><span class="annottext">Text -&gt; m Int -&gt; m Int
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RelName -&gt; Text
</span><a href="Hasura.RQL.Types.Common.html#relNameToTxt"><span class="hs-identifier hs-var">relNameToTxt</span></a></span><span> </span><span class="annot"><span class="annottext">(RelName -&gt; Text) -&gt; RelName -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind) -&gt; RelName
forall (b :: BackendType). RelInfo b -&gt; RelName
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riName"><span class="hs-identifier hs-var">riName</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind)
</span><a href="#local-6989586621687930100"><span class="hs-identifier hs-var">relInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m Int -&gt; m Int) -&gt; m Int -&gt; m Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687930101"><span class="annot"><span class="annottext">additionalColumns :: HashMap PGCol SQLExp
</span><a href="#local-6989586621687930101"><span class="hs-identifier hs-var hs-var hs-var">additionalColumns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(PGCol, SQLExp)] -&gt; HashMap PGCol SQLExp
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.Strict.html/Data.HashMap.Internal.Strict.html#fromList"><span class="hs-identifier hs-var">HashMap.fromList</span></a></span><span>
</span><span id="line-290"></span><span>          </span><span class="annot"><span class="annottext">([(PGCol, SQLExp)] -&gt; HashMap PGCol SQLExp)
-&gt; [(PGCol, SQLExp)] -&gt; HashMap PGCol SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(((PGCol, SQLExp) -&gt; Maybe (PGCol, SQLExp))
 -&gt; [(PGCol, SQLExp)] -&gt; [(PGCol, SQLExp)])
-&gt; [(PGCol, SQLExp)]
-&gt; ((PGCol, SQLExp) -&gt; Maybe (PGCol, SQLExp))
-&gt; [(PGCol, SQLExp)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((PGCol, SQLExp) -&gt; Maybe (PGCol, SQLExp))
-&gt; [(PGCol, SQLExp)] -&gt; [(PGCol, SQLExp)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b.
Filterable f =&gt;
(a -&gt; Maybe b) -&gt; f a -&gt; f b
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/witherable-0.5-ed5d92584b79c1fa03d7efeb1159ae93eef86189605b088dd8806eb40d0b16f5/share/doc/html/src/Witherable.html/Witherable.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">[(PGCol, SQLExp)]
</span><a href="#local-6989586621687930094"><span class="hs-identifier hs-var">resCols</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621687930102"><span class="annot"><span class="annottext">PGCol
</span><a href="#local-6989586621687930102"><span class="hs-identifier hs-var">column</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687930103"><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687930103"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-291"></span><span>            </span><span id="local-6989586621687930104"><span class="annot"><a href="#local-6989586621687930104"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PGCol -&gt; HashMap PGCol PGCol -&gt; Maybe PGCol
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#lookup"><span class="hs-identifier hs-var">HashMap.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">PGCol
</span><a href="#local-6989586621687930102"><span class="hs-identifier hs-var">column</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap
  (ColumnPath ('Postgres pgKind)) (ColumnPath ('Postgres pgKind))
HashMap PGCol PGCol
</span><a href="#local-6989586621687930106"><span class="hs-identifier hs-var">mapping</span></a></span><span>
</span><span id="line-292"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621687930104"><span class="hs-identifier hs-type">target</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621687930103"><span class="hs-identifier hs-type">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621687930107"><span class="annot"><a href="#local-6989586621687930107"><span class="hs-identifier hs-var">resBS</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-294"></span><span>      </span><span class="annot"><span class="annottext">Text -&gt; m EncJSON -&gt; m EncJSON
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;data&quot;</span></span><span>
</span><span id="line-295"></span><span>        </span><span class="annot"><span class="annottext">(m EncJSON -&gt; m EncJSON) -&gt; m EncJSON -&gt; m EncJSON
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MultiObjectInsert ('Postgres pgKind) SQLExp
-&gt; HashMap PGCol SQLExp
-&gt; UserInfo
-&gt; MutationOutput ('Postgres pgKind)
-&gt; Seq PrepArg
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; m EncJSON
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, MonadIO m, MonadTrace m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m) =&gt;
MultiObjectInsert ('Postgres pgKind) SQLExp
-&gt; HashMap PGCol SQLExp
-&gt; UserInfo
-&gt; MutationOutput ('Postgres pgKind)
-&gt; Seq PrepArg
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#insertMultipleObjects"><span class="hs-identifier hs-var">insertMultipleObjects</span></a></span><span> </span><span class="annot"><span class="annottext">MultiObjectInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687930108"><span class="hs-identifier hs-var">multiObjIns</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
</span><a href="#local-6989586621687930101"><span class="hs-identifier hs-var">additionalColumns</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687930095"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
MutationOutputG ('Postgres pgKind) Void SQLExp
forall {b :: BackendType} {r} {v}. MutationOutputG b r v
</span><a href="#local-6989586621687930109"><span class="hs-identifier hs-var">mutOutput</span></a></span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687930096"><span class="hs-identifier hs-var">planVars</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687930097"><span class="hs-identifier hs-var">stringifyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687930098"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span id="local-6989586621687930110"><span class="annot"><a href="#local-6989586621687930110"><span class="hs-identifier hs-var">resObj</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#decodeEncJSON"><span class="hs-identifier hs-type">decodeEncJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687930107"><span class="hs-identifier hs-type">resBS</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html/Hasura.Prelude.html#onNothing"><span class="hs-identifier hs-type">onNothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#lookup"><span class="hs-identifier hs-type">HashMap.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;affected_rows&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687930110"><span class="hs-identifier hs-type">resObj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw500"><span class="hs-identifier hs-type">throw500</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;affected_rows not returned in array rel insert&quot;</span></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#RelationInsert"><span class="hs-identifier hs-type">IR.RelationInsert</span></a></span><span> </span><span id="local-6989586621687930108"><span class="annot"><span class="annottext">MultiObjectInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687930108"><span class="hs-identifier hs-var">multiObjIns</span></a></span></span><span> </span><span id="local-6989586621687930100"><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind)
</span><a href="#local-6989586621687930100"><span class="hs-identifier hs-var">relInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrayRelationInsert ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687930099"><span class="hs-identifier hs-var">arrRelIns</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span id="local-6989586621687930106"><span class="annot"><span class="annottext">mapping :: HashMap
  (ColumnPath ('Postgres pgKind)) (ColumnPath ('Postgres pgKind))
</span><a href="#local-6989586621687930106"><span class="hs-identifier hs-var hs-var">mapping</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelMapping ('Postgres pgKind)
-&gt; HashMap
     (ColumnPath ('Postgres pgKind)) (ColumnPath ('Postgres pgKind))
forall (b :: BackendType).
RelMapping b -&gt; HashMap (ColumnPath b) (ColumnPath b)
</span><a href="Hasura.RQL.Types.Relationships.Local.html#unRelMapping"><span class="hs-identifier hs-var">unRelMapping</span></a></span><span> </span><span class="annot"><span class="annottext">(RelMapping ('Postgres pgKind)
 -&gt; HashMap
      (ColumnPath ('Postgres pgKind)) (ColumnPath ('Postgres pgKind)))
-&gt; RelMapping ('Postgres pgKind)
-&gt; HashMap
     (ColumnPath ('Postgres pgKind)) (ColumnPath ('Postgres pgKind))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind) -&gt; RelMapping ('Postgres pgKind)
forall (b :: BackendType). RelInfo b -&gt; RelMapping b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riMapping"><span class="hs-identifier hs-var">riMapping</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind)
</span><a href="#local-6989586621687930100"><span class="hs-identifier hs-var">relInfo</span></a></span><span>
</span><span id="line-302"></span><span>    </span><span id="local-6989586621687930109"><span class="annot"><span class="annottext">mutOutput :: MutationOutputG b r v
</span><a href="#local-6989586621687930109"><span class="hs-identifier hs-var hs-var">mutOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MutFldsG b r v -&gt; MutationOutputG b r v
forall (b :: BackendType) r v.
MutFldsG b r v -&gt; MutationOutputG b r v
</span><a href="Hasura.RQL.IR.Returning.html#MOutMultirowFields"><span class="hs-identifier hs-var">IR.MOutMultirowFields</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName
</span><span class="hs-string">&quot;affected_rows&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MutFldG b r v
forall (b :: BackendType) r v. MutFldG b r v
</span><a href="Hasura.RQL.IR.Returning.html#MCount"><span class="hs-identifier hs-var">IR.MCount</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- | Validate an insert object based on insert columns,</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- insert object relations and additional columns from parent:</span><span>
</span><span id="line-306"></span><span class="hs-comment">--</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- * There should be no overlap between 'insCols' and 'addCols'.</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- * There should be no overlap between any object relationship columns and</span><span>
</span><span id="line-309"></span><span class="hs-comment">--   'insCols' and 'addCols'.</span><span>
</span><span id="line-310"></span><span id="local-6989586621687929313"><span id="local-6989586621687929314"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#validateInsert"><span class="hs-identifier hs-type">validateInsert</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929313"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-312"></span><span>  </span><span class="annot"><span class="hs-comment">-- | inserting columns</span></span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#PGCol"><span class="hs-identifier hs-type">PGCol</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-314"></span><span>  </span><span class="annot"><span class="hs-comment">-- | object relation inserts</span></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelInfo"><span class="hs-identifier hs-type">RelInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929314"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-316"></span><span>  </span><span class="annot"><span class="hs-comment">-- | additional fields from parent</span></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#PGCol"><span class="hs-identifier hs-type">PGCol</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><a href="#local-6989586621687929313"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-319"></span><span id="validateInsert"><span class="annot"><span class="annottext">validateInsert :: forall (m :: * -&gt; *) (pgKind :: PostgresKind).
MonadError QErr m =&gt;
[PGCol] -&gt; [RelInfo ('Postgres pgKind)] -&gt; [PGCol] -&gt; m ()
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#validateInsert"><span class="hs-identifier hs-var hs-var">validateInsert</span></a></span></span><span> </span><span id="local-6989586621687930148"><span class="annot"><span class="annottext">[PGCol]
</span><a href="#local-6989586621687930148"><span class="hs-identifier hs-var">insCols</span></a></span></span><span> </span><span id="local-6989586621687930149"><span class="annot"><span class="annottext">[RelInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687930149"><span class="hs-identifier hs-var">objRels</span></a></span></span><span> </span><span id="local-6989586621687930150"><span class="annot"><span class="annottext">[PGCol]
</span><a href="#local-6989586621687930150"><span class="hs-identifier hs-var">addCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-comment">-- validate insertCols</span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PGCol] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[PGCol]
</span><a href="#local-6989586621687930152"><span class="hs-identifier hs-var">insConflictCols</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#ValidationFailed"><span class="hs-identifier hs-var">ValidationFailed</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cannot insert &quot;</span></span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[PGCol] -&gt; Text
forall (t :: * -&gt; *). (Foldable t, Functor t) =&gt; t PGCol -&gt; Text
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#showPGCols"><span class="hs-identifier hs-var">showPGCols</span></a></span><span> </span><span class="annot"><span class="annottext">[PGCol]
</span><a href="#local-6989586621687930152"><span class="hs-identifier hs-var">insConflictCols</span></a></span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; columns as their values are already being determined by parent insert&quot;</span></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><span class="annottext">[RelInfo ('Postgres pgKind)]
-&gt; (RelInfo ('Postgres pgKind) -&gt; m ()) -&gt; m ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[RelInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687930149"><span class="hs-identifier hs-var">objRels</span></a></span><span> </span><span class="annot"><span class="annottext">((RelInfo ('Postgres pgKind) -&gt; m ()) -&gt; m ())
-&gt; (RelInfo ('Postgres pgKind) -&gt; m ()) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687930156"><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind)
</span><a href="#local-6989586621687930156"><span class="hs-identifier hs-var">relInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687930157"><span class="annot"><span class="annottext">lCols :: [PGCol]
</span><a href="#local-6989586621687930157"><span class="hs-identifier hs-var hs-var">lCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashMap PGCol PGCol -&gt; [PGCol]
forall k v. HashMap k v -&gt; [k]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#keys"><span class="hs-identifier hs-var">HashMap.keys</span></a></span><span> </span><span class="annot"><span class="annottext">(HashMap PGCol PGCol -&gt; [PGCol]) -&gt; HashMap PGCol PGCol -&gt; [PGCol]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RelMapping ('Postgres pgKind)
-&gt; HashMap
     (ColumnPath ('Postgres pgKind)) (ColumnPath ('Postgres pgKind))
forall (b :: BackendType).
RelMapping b -&gt; HashMap (ColumnPath b) (ColumnPath b)
</span><a href="Hasura.RQL.Types.Relationships.Local.html#unRelMapping"><span class="hs-identifier hs-var">unRelMapping</span></a></span><span> </span><span class="annot"><span class="annottext">(RelMapping ('Postgres pgKind)
 -&gt; HashMap
      (ColumnPath ('Postgres pgKind)) (ColumnPath ('Postgres pgKind)))
-&gt; RelMapping ('Postgres pgKind)
-&gt; HashMap
     (ColumnPath ('Postgres pgKind)) (ColumnPath ('Postgres pgKind))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind) -&gt; RelMapping ('Postgres pgKind)
forall (b :: BackendType). RelInfo b -&gt; RelMapping b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riMapping"><span class="hs-identifier hs-var">riMapping</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind)
</span><a href="#local-6989586621687930156"><span class="hs-identifier hs-var">relInfo</span></a></span><span>
</span><span id="line-329"></span><span>        </span><span id="local-6989586621687930158"><span class="annot"><span class="annottext">relName :: RelName
</span><a href="#local-6989586621687930158"><span class="hs-identifier hs-var hs-var">relName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind) -&gt; RelName
forall (b :: BackendType). RelInfo b -&gt; RelName
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riName"><span class="hs-identifier hs-var">riName</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind)
</span><a href="#local-6989586621687930156"><span class="hs-identifier hs-var">relInfo</span></a></span><span>
</span><span id="line-330"></span><span>        </span><span id="local-6989586621687930159"><span class="annot"><span class="annottext">relNameTxt :: Text
</span><a href="#local-6989586621687930159"><span class="hs-identifier hs-var hs-var">relNameTxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelName -&gt; Text
</span><a href="Hasura.RQL.Types.Common.html#relNameToTxt"><span class="hs-identifier hs-var">relNameToTxt</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687930158"><span class="hs-identifier hs-var">relName</span></a></span><span>
</span><span id="line-331"></span><span>        </span><span id="local-6989586621687930160"><span class="annot"><span class="annottext">lColConflicts :: [PGCol]
</span><a href="#local-6989586621687930160"><span class="hs-identifier hs-var hs-var">lColConflicts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PGCol]
</span><a href="#local-6989586621687930157"><span class="hs-identifier hs-var">lCols</span></a></span><span> </span><span class="annot"><span class="annottext">[PGCol] -&gt; [PGCol] -&gt; [PGCol]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PGCol]
</span><a href="#local-6989586621687930150"><span class="hs-identifier hs-var">addCols</span></a></span><span> </span><span class="annot"><span class="annottext">[PGCol] -&gt; [PGCol] -&gt; [PGCol]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[PGCol]
</span><a href="#local-6989586621687930148"><span class="hs-identifier hs-var">insCols</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>        </span><span id="local-6989586621687930162"><span class="annot"><span class="annottext">is_after_parent :: Bool
</span><a href="#local-6989586621687930162"><span class="hs-identifier hs-var hs-var">is_after_parent</span></a></span></span><span>
</span><span id="line-333"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">InsertOrder
</span><a href="Hasura.RQL.Types.Common.html#AfterParent"><span class="hs-identifier hs-var">AfterParent</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind) -&gt; InsertOrder
forall (b :: BackendType). RelInfo b -&gt; InsertOrder
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riInsertOrder"><span class="hs-identifier hs-var">riInsertOrder</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind)
</span><a href="#local-6989586621687930156"><span class="hs-identifier hs-var">relInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-334"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; m () -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687930159"><span class="hs-identifier hs-var">relNameTxt</span></a></span><span>
</span><span id="line-337"></span><span>      </span><span class="hs-comment">-- When inserting through relationships, we only care that inserted</span><span>
</span><span id="line-338"></span><span>      </span><span class="hs-comment">-- columns don't overlap with those defining the relationship when the</span><span>
</span><span id="line-339"></span><span>      </span><span class="hs-comment">-- remote table is inserted _before_ the parent table.</span><span>
</span><span id="line-340"></span><span>      </span><span class="hs-comment">-- When the remote table is inserted _after_ the parent table it's the</span><span>
</span><span id="line-341"></span><span>      </span><span class="hs-comment">-- parent table that (through some means) decide what the value of the</span><span>
</span><span id="line-342"></span><span>      </span><span class="hs-comment">-- key is.</span><span>
</span><span id="line-343"></span><span>      </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PGCol] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[PGCol]
</span><a href="#local-6989586621687930160"><span class="hs-identifier hs-var">lColConflicts</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687930162"><span class="hs-identifier hs-var">is_after_parent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>      </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#ValidationFailed"><span class="hs-identifier hs-var">ValidationFailed</span></a></span><span>
</span><span id="line-345"></span><span>      </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cannot insert object relationship &quot;</span></span><span>
</span><span id="line-346"></span><span>      </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687930158"><span class="hs-identifier hs-var">relName</span></a></span><span>
</span><span id="line-347"></span><span>      </span><span class="annot"><span class="annottext">RelName -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; as &quot;</span></span><span>
</span><span id="line-348"></span><span>      </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[PGCol] -&gt; Text
forall (t :: * -&gt; *). (Foldable t, Functor t) =&gt; t PGCol -&gt; Text
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#showPGCols"><span class="hs-identifier hs-var">showPGCols</span></a></span><span> </span><span class="annot"><span class="annottext">[PGCol]
</span><a href="#local-6989586621687930160"><span class="hs-identifier hs-var">lColConflicts</span></a></span><span>
</span><span id="line-349"></span><span>      </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; column values are already determined&quot;</span></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-351"></span><span>    </span><span id="local-6989586621687930152"><span class="annot"><span class="annottext">insConflictCols :: [PGCol]
</span><a href="#local-6989586621687930152"><span class="hs-identifier hs-var hs-var">insConflictCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PGCol]
</span><a href="#local-6989586621687930148"><span class="hs-identifier hs-var">insCols</span></a></span><span> </span><span class="annot"><span class="annottext">[PGCol] -&gt; [PGCol] -&gt; [PGCol]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">[PGCol]
</span><a href="#local-6989586621687930150"><span class="hs-identifier hs-var">addCols</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span id="local-6989586621687929387"><span id="local-6989586621687929388"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#mkInsertQ"><span class="hs-identifier hs-type">mkInsertQ</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929387"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687929388"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929388"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-355"></span><span>  </span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedTable"><span class="hs-identifier hs-type">QualifiedTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-357"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Conflict.html#OnConflictClause"><span class="hs-identifier hs-type">IR.OnConflictClause</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929387"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">Postgres.SQLExp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-358"></span><span>  </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#HashMap"><span class="hs-identifier hs-type">HashMap.HashMap</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#PGCol"><span class="hs-identifier hs-type">PGCol</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">Postgres.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html#AnnBoolExpSQL"><span class="hs-identifier hs-type">AnnBoolExpSQL</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929387"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html#AnnBoolExpSQL"><span class="hs-identifier hs-type">AnnBoolExpSQL</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929387"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-360"></span><span>  </span><span class="annot"><a href="#local-6989586621687929388"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#TopLevelCTE"><span class="hs-identifier hs-type">Postgres.TopLevelCTE</span></a></span></span></span><span>
</span><span id="line-361"></span><span id="mkInsertQ"><span class="annot"><span class="annottext">mkInsertQ :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; QualifiedObject TableName
-&gt; Maybe (OnConflictClause ('Postgres pgKind) SQLExp)
-&gt; HashMap PGCol SQLExp
-&gt; (AnnBoolExpSQL ('Postgres pgKind),
    Maybe (AnnBoolExpSQL ('Postgres pgKind)))
-&gt; m TopLevelCTE
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#mkInsertQ"><span class="hs-identifier hs-var hs-var">mkInsertQ</span></a></span></span><span> </span><span id="local-6989586621687930188"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687930188"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687930189"><span class="annot"><span class="annottext">QualifiedObject TableName
</span><a href="#local-6989586621687930189"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span id="local-6989586621687930190"><span class="annot"><span class="annottext">Maybe (OnConflictClause ('Postgres pgKind) SQLExp)
</span><a href="#local-6989586621687930190"><span class="hs-identifier hs-var">onConflictM</span></a></span></span><span> </span><span id="local-6989586621687930191"><span class="annot"><span class="annottext">HashMap PGCol SQLExp
</span><a href="#local-6989586621687930191"><span class="hs-identifier hs-var">insertRow</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687930192"><span class="annot"><span class="annottext">AnnBoolExpSQL ('Postgres pgKind)
</span><a href="#local-6989586621687930192"><span class="hs-identifier hs-var">insCheck</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687930193"><span class="annot"><span class="annottext">Maybe (AnnBoolExpSQL ('Postgres pgKind))
</span><a href="#local-6989586621687930193"><span class="hs-identifier hs-var">updCheck</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-362"></span><span>  </span><span id="local-6989586621687930194"><span class="annot"><a href="#local-6989586621687930194"><span class="hs-identifier hs-var">insCheckBoolExp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserInfo -&gt; Qual -&gt; AnnBoolExpSQL ('Postgres pgKind) -&gt; m BoolExp
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), MonadIO m, MonadError QErr m) =&gt;
UserInfo -&gt; Qual -&gt; AnnBoolExpSQL ('Postgres pgKind) -&gt; m BoolExp
</span><a href="Hasura.Backends.Postgres.Translate.BoolExp.html#toSQLBoolExp"><span class="hs-identifier hs-var">PGT.toSQLBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687930188"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedObject TableName -&gt; Qual
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#QualTable"><span class="hs-identifier hs-var">Postgres.QualTable</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedObject TableName
</span><a href="#local-6989586621687930189"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AnnBoolExpSQL ('Postgres pgKind)
</span><a href="#local-6989586621687930192"><span class="hs-identifier hs-var">insCheck</span></a></span><span>
</span><span id="line-363"></span><span>  </span><span id="local-6989586621687930197"><span class="annot"><a href="#local-6989586621687930197"><span class="hs-identifier hs-var">updateCheckBoolExp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.BoolExp.html#toSQLBoolExp"><span class="hs-identifier hs-type">PGT.toSQLBoolExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687930188"><span class="hs-identifier hs-type">userInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#QualTable"><span class="hs-identifier hs-type">Postgres.QualTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687930189"><span class="hs-identifier hs-type">table</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687930193"><span class="hs-identifier hs-type">updCheck</span></a></span><span>
</span><span id="line-364"></span><span>  </span><span id="local-6989586621687930199"><span class="annot"><a href="#local-6989586621687930199"><span class="hs-identifier hs-var">sqlConflict</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Insert.html#toSQLConflict"><span class="hs-identifier hs-type">PGT.toSQLConflict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687930188"><span class="hs-identifier hs-type">userInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687930189"><span class="hs-identifier hs-type">table</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687930190"><span class="hs-identifier hs-type">onConflictM</span></a></span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687930201"><span class="annot"><a href="#local-6989586621687930201"><span class="hs-identifier hs-var hs-var">sqlExps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp -&gt; [SQLExp]
forall k v. HashMap k v -&gt; [v]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#elems"><span class="hs-identifier hs-var">HashMap.elems</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
</span><a href="#local-6989586621687930191"><span class="hs-identifier hs-var">insertRow</span></a></span><span>
</span><span id="line-366"></span><span>      </span><span id="local-6989586621687930202"><span class="annot"><a href="#local-6989586621687930202"><span class="hs-identifier hs-var hs-var">valueExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TupleExp] -&gt; ValuesExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#ValuesExp"><span class="hs-identifier hs-var">Postgres.ValuesExp</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[SQLExp] -&gt; TupleExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#TupleExp"><span class="hs-identifier hs-var">Postgres.TupleExp</span></a></span><span> </span><span class="annot"><span class="annottext">[SQLExp]
</span><a href="#local-6989586621687930201"><span class="hs-identifier hs-var">sqlExps</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-367"></span><span>      </span><span id="local-6989586621687930205"><span class="annot"><a href="#local-6989586621687930205"><span class="hs-identifier hs-var hs-var">tableCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp -&gt; [PGCol]
forall k v. HashMap k v -&gt; [k]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#keys"><span class="hs-identifier hs-var">HashMap.keys</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap PGCol SQLExp
</span><a href="#local-6989586621687930191"><span class="hs-identifier hs-var">insertRow</span></a></span><span>
</span><span id="line-368"></span><span>      </span><span id="local-6989586621687930206"><span class="annot"><a href="#local-6989586621687930206"><span class="hs-identifier hs-var hs-var">sqlInsert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-369"></span><span>        </span><span class="annot"><span class="annottext">QualifiedObject TableName
-&gt; [PGCol]
-&gt; ValuesExp
-&gt; Maybe SQLConflict
-&gt; Maybe RetExp
-&gt; SQLInsert
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLInsert"><span class="hs-identifier hs-var">Postgres.SQLInsert</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedObject TableName
</span><a href="#local-6989586621687930189"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">[PGCol]
</span><a href="#local-6989586621687930205"><span class="hs-identifier hs-var">tableCols</span></a></span><span> </span><span class="annot"><span class="annottext">ValuesExp
</span><a href="#local-6989586621687930202"><span class="hs-identifier hs-var">valueExp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SQLConflict
</span><a href="#local-6989586621687930199"><span class="hs-identifier hs-var">sqlConflict</span></a></span><span>
</span><span id="line-370"></span><span>          </span><span class="annot"><span class="annottext">(Maybe RetExp -&gt; SQLInsert)
-&gt; (RetExp -&gt; Maybe RetExp) -&gt; RetExp -&gt; SQLInsert
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RetExp -&gt; Maybe RetExp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-371"></span><span>          </span><span class="annot"><span class="annottext">(RetExp -&gt; SQLInsert) -&gt; RetExp -&gt; SQLInsert
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Extractor] -&gt; RetExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#RetExp"><span class="hs-identifier hs-var">Postgres.RetExp</span></a></span><span>
</span><span id="line-372"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Extractor
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#selectStar"><span class="hs-identifier hs-var">Postgres.selectStar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-373"></span><span>              </span><span class="annot"><span class="annottext">QualifiedObject TableName
-&gt; Maybe (OnConflictClause ('Postgres pgKind) SQLExp)
-&gt; BoolExp
-&gt; Maybe BoolExp
-&gt; Extractor
forall (pgKind :: PostgresKind).
QualifiedObject TableName
-&gt; Maybe (OnConflictClause ('Postgres pgKind) SQLExp)
-&gt; BoolExp
-&gt; Maybe BoolExp
-&gt; Extractor
</span><a href="Hasura.Backends.Postgres.Translate.Insert.html#insertOrUpdateCheckExpr"><span class="hs-identifier hs-var">PGT.insertOrUpdateCheckExpr</span></a></span><span>
</span><span id="line-374"></span><span>                </span><span class="annot"><span class="annottext">QualifiedObject TableName
</span><a href="#local-6989586621687930189"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-375"></span><span>                </span><span class="annot"><span class="annottext">Maybe (OnConflictClause ('Postgres pgKind) SQLExp)
</span><a href="#local-6989586621687930190"><span class="hs-identifier hs-var">onConflictM</span></a></span><span>
</span><span id="line-376"></span><span>                </span><span class="annot"><span class="annottext">BoolExp
</span><a href="#local-6989586621687930194"><span class="hs-identifier hs-var">insCheckBoolExp</span></a></span><span>
</span><span id="line-377"></span><span>                </span><span class="annot"><span class="annottext">Maybe BoolExp
</span><a href="#local-6989586621687930197"><span class="hs-identifier hs-var">updateCheckBoolExp</span></a></span><span>
</span><span id="line-378"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-379"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#CTEInsert"><span class="hs-identifier hs-type">Postgres.CTEInsert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687930206"><span class="hs-identifier hs-type">sqlInsert</span></a></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span id="local-6989586621687929413"><span id="local-6989586621687929414"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#fetchFromColVals"><span class="hs-identifier hs-type">fetchFromColVals</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929413"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-383"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnValues"><span class="hs-identifier hs-type">ColumnValues</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929414"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.SQL.Value.html#TxtEncodedVal"><span class="hs-identifier hs-type">TxtEncodedVal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929414"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-385"></span><span>  </span><span class="annot"><a href="#local-6989586621687929413"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#PGCol"><span class="hs-identifier hs-type">PGCol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">Postgres.SQLExp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-386"></span><span id="fetchFromColVals"><span class="annot"><span class="annottext">fetchFromColVals :: forall (m :: * -&gt; *) (pgKind :: PostgresKind).
MonadError QErr m =&gt;
ColumnValues ('Postgres pgKind) TxtEncodedVal
-&gt; [ColumnInfo ('Postgres pgKind)] -&gt; m [(PGCol, SQLExp)]
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#fetchFromColVals"><span class="hs-identifier hs-var hs-var">fetchFromColVals</span></a></span></span><span> </span><span id="local-6989586621687930229"><span class="annot"><span class="annottext">ColumnValues ('Postgres pgKind) TxtEncodedVal
</span><a href="#local-6989586621687930229"><span class="hs-identifier hs-var">colVal</span></a></span></span><span> </span><span id="local-6989586621687930230"><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687930230"><span class="hs-identifier hs-var">reqCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-387"></span><span>  </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
-&gt; (ColumnInfo ('Postgres pgKind) -&gt; m (PGCol, SQLExp))
-&gt; m [(PGCol, SQLExp)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687930230"><span class="hs-identifier hs-var">reqCols</span></a></span><span> </span><span class="annot"><span class="annottext">((ColumnInfo ('Postgres pgKind) -&gt; m (PGCol, SQLExp))
 -&gt; m [(PGCol, SQLExp)])
-&gt; (ColumnInfo ('Postgres pgKind) -&gt; m (PGCol, SQLExp))
-&gt; m [(PGCol, SQLExp)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687930231"><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621687930231"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-388"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687930232"><span class="annot"><span class="annottext">valM :: Maybe TxtEncodedVal
</span><a href="#local-6989586621687930232"><span class="hs-identifier hs-var hs-var hs-var">valM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PGCol -&gt; HashMap PGCol TxtEncodedVal -&gt; Maybe TxtEncodedVal
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/unordered-containers-0.2.20-6d56f9b3abc6011ddb6e237c415126423ab5ceb5c078221bba2ff80dbe921009/share/doc/html/src/Data.HashMap.Internal.html/Data.HashMap.Internal.html#lookup"><span class="hs-identifier hs-var">HashMap.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind) -&gt; Column ('Postgres pgKind)
forall (b :: BackendType). ColumnInfo b -&gt; Column b
</span><a href="Hasura.RQL.Types.Column.html#ciColumn"><span class="hs-identifier hs-var">ciColumn</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621687930231"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ColumnValues ('Postgres pgKind) TxtEncodedVal
HashMap PGCol TxtEncodedVal
</span><a href="#local-6989586621687930229"><span class="hs-identifier hs-var">colVal</span></a></span><span>
</span><span id="line-389"></span><span>    </span><span id="local-6989586621687930234"><span class="annot"><a href="#local-6989586621687930234"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-390"></span><span>      </span><span class="annot"><span class="annottext">Maybe TxtEncodedVal -&gt; m TxtEncodedVal -&gt; m TxtEncodedVal
forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; m a -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html/Hasura.Prelude.html#onNothing"><span class="hs-identifier hs-var">onNothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TxtEncodedVal
</span><a href="#local-6989586621687930232"><span class="hs-identifier hs-var">valM</span></a></span><span>
</span><span id="line-391"></span><span>        </span><span class="annot"><span class="annottext">(m TxtEncodedVal -&gt; m TxtEncodedVal)
-&gt; m TxtEncodedVal -&gt; m TxtEncodedVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; m TxtEncodedVal
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw500"><span class="hs-identifier hs-var">throw500</span></a></span><span>
</span><span id="line-392"></span><span>        </span><span class="annot"><span class="annottext">(Text -&gt; m TxtEncodedVal) -&gt; Text -&gt; m TxtEncodedVal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;column &quot;</span></span><span>
</span><span id="line-393"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind) -&gt; Column ('Postgres pgKind)
forall (b :: BackendType). ColumnInfo b -&gt; Column b
</span><a href="Hasura.RQL.Types.Column.html#ciColumn"><span class="hs-identifier hs-var">ciColumn</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621687930231"><span class="hs-identifier hs-var">ci</span></a></span><span>
</span><span id="line-394"></span><span>        </span><span class="annot"><span class="annottext">PGCol -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; not found in given colVal&quot;</span></span><span>
</span><span id="line-395"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687930235"><span class="annot"><a href="#local-6989586621687930235"><span class="hs-identifier hs-var hs-var">pgColVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxtEncodedVal
</span><a href="#local-6989586621687930234"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-396"></span><span>          </span><span class="annot"><span class="annottext">TxtEncodedVal
</span><a href="Hasura.SQL.Value.html#TENull"><span class="hs-identifier hs-var">TENull</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SENull"><span class="hs-identifier hs-var">Postgres.SENull</span></a></span><span>
</span><span id="line-397"></span><span>          </span><span class="annot"><a href="Hasura.SQL.Value.html#TELit"><span class="hs-identifier hs-type">TELit</span></a></span><span> </span><span id="local-6989586621687930239"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687930239"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">Postgres.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687930239"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-398"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ciColumn"><span class="hs-identifier hs-var">ciColumn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687930231"><span class="hs-identifier hs-type">ci</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621687930235"><span class="hs-identifier hs-type">pgColVal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span id="local-6989586621687929455"><span id="local-6989586621687929456"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#decodeEncJSON"><span class="hs-identifier hs-type">decodeEncJSON</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.FromJSON.html/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">J.FromJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929455"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929456"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html/Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621687929456"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929455"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-401"></span><span id="decodeEncJSON"><span class="annot"><span class="annottext">decodeEncJSON :: forall a (m :: * -&gt; *). (FromJSON a, QErrM m) =&gt; EncJSON -&gt; m a
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#decodeEncJSON"><span class="hs-identifier hs-var hs-var">decodeEncJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-402"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; m a) -&gt; (Value -&gt; m a) -&gt; Either String Value -&gt; m a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; m a
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#throw500"><span class="hs-identifier hs-var">throw500</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m a) -&gt; (String -&gt; Text) -&gt; String -&gt; m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value -&gt; m a
forall a (m :: * -&gt; *). (FromJSON a, QErrM m) =&gt; Value -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#decodeValue"><span class="hs-identifier hs-var">decodeValue</span></a></span><span>
</span><span id="line-403"></span><span>    </span><span class="annot"><span class="annottext">(Either String Value -&gt; m a)
-&gt; (EncJSON -&gt; Either String Value) -&gt; EncJSON -&gt; m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String Value
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Decoding.html/Data.Aeson.Decoding.html#eitherDecode"><span class="hs-identifier hs-var">J.eitherDecode</span></a></span><span>
</span><span id="line-404"></span><span>    </span><span class="annot"><span class="annottext">(ByteString -&gt; Either String Value)
-&gt; (EncJSON -&gt; ByteString) -&gt; EncJSON -&gt; Either String Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">EncJSON -&gt; ByteString
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html/Hasura.EncJSON.html#encJToLBS"><span class="hs-identifier hs-var">encJToLBS</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#validateInsertInput"><span class="hs-identifier hs-type">validateInsertInput</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687929507"><span class="annot"><a href="#local-6989586621687929507"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621687929508"><span class="annot"><a href="#local-6989586621687929508"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929507"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-409"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687929507"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-410"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.Class.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929507"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-411"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#InsertValidationPayloadMap"><span class="hs-identifier hs-type">PGE.InsertValidationPayloadMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929508"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687929507"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-413"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Environment.html/Data.Environment.html#Environment"><span class="hs-identifier hs-type">Env.Environment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-414"></span><span>  </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/http-client-0.7.17-1b2133de2c2ce095aea721bc3d56fba68148ba6d3c4af69a01586f3a88b4e771/share/doc/html/src/Network.HTTP.Client.Types.html/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">HTTP.Manager</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-415"></span><span>  </span><span class="annot"><a href="Hasura.Logging.html#Logger"><span class="hs-identifier hs-type">L.Logger</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">L.Hasura</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-416"></span><span>  </span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-417"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#MultiObjectInsert"><span class="hs-identifier hs-type">IR.MultiObjectInsert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929508"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929508"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/http-types-0.12.3-48808bff700213a8ec5159613d94db74ab5738412a48ffcd3e274142637b29eb/share/doc/html/src/Network.HTTP.Types.Header.html/Network.HTTP.Types.Header.html#Header"><span class="hs-identifier hs-type">HTTP.Header</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-419"></span><span>  </span><span class="annot"><a href="#local-6989586621687929507"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span id="validateInsertInput"><span class="annot"><span class="annottext">validateInsertInput :: forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadError QErr m, MonadIO m, MonadTrace m,
 MonadState (InsertValidationPayloadMap pgKind) m) =&gt;
Environment
-&gt; Manager
-&gt; Logger Hasura
-&gt; UserInfo
-&gt; MultiObjectInsert
     ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
-&gt; [Header]
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#validateInsertInput"><span class="hs-identifier hs-var hs-var">validateInsertInput</span></a></span></span><span> </span><span id="local-6989586621687930294"><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621687930294"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621687930295"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621687930295"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621687930296"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621687930296"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621687930297"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687930297"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#AnnotatedInsertData"><span class="hs-identifier hs-type">IR.AnnotatedInsertData</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687930298"><span id="local-6989586621687930299"><span id="local-6989586621687930300"><span id="local-6989586621687930301"><span id="local-6989586621687930302"><span id="local-6989586621687930303"><span id="local-6989586621687930304"><span id="local-6989586621687930305"><span id="local-6989586621687930306"><span class="annot"><span class="annottext">[AnnotatedInsertRow
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
[ColumnInfo ('Postgres pgKind)]
Maybe (NESeq (Column ('Postgres pgKind)))
Maybe (ValidateInput ResolvedWebhook)
(AnnBoolExp
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind)),
 Maybe
   (AnnBoolExp
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))))
PreSetColsG ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
TableName ('Postgres pgKind)
ExtraTableMetadata ('Postgres pgKind)
BackendInsert
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
_aiInsertObject :: forall (b :: BackendType) (f :: * -&gt; *) v.
AnnotatedInsertData b f v -&gt; f (AnnotatedInsertRow b v)
_aiTableColumns :: forall (b :: BackendType) (f :: * -&gt; *) v.
AnnotatedInsertData b f v -&gt; [ColumnInfo b]
_aiInsertObject :: [AnnotatedInsertRow
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
_aiTableName :: TableName ('Postgres pgKind)
_aiCheckCondition :: (AnnBoolExp
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind)),
 Maybe
   (AnnBoolExp
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))))
_aiTableColumns :: [ColumnInfo ('Postgres pgKind)]
_aiPrimaryKey :: Maybe (NESeq (Column ('Postgres pgKind)))
_aiExtraTableMetadata :: ExtraTableMetadata ('Postgres pgKind)
_aiPresetValues :: PreSetColsG ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
_aiBackendInsert :: BackendInsert
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
_aiValidateInput :: Maybe (ValidateInput ResolvedWebhook)
_aiValidateInput :: forall (b :: BackendType) (f :: * -&gt; *) v.
AnnotatedInsertData b f v -&gt; Maybe (ValidateInput ResolvedWebhook)
_aiBackendInsert :: forall (b :: BackendType) (f :: * -&gt; *) v.
AnnotatedInsertData b f v -&gt; BackendInsert b v
_aiPresetValues :: forall (b :: BackendType) (f :: * -&gt; *) v.
AnnotatedInsertData b f v -&gt; PreSetColsG b v
_aiExtraTableMetadata :: forall (b :: BackendType) (f :: * -&gt; *) v.
AnnotatedInsertData b f v -&gt; ExtraTableMetadata b
_aiPrimaryKey :: forall (b :: BackendType) (f :: * -&gt; *) v.
AnnotatedInsertData b f v -&gt; Maybe (NESeq (Column b))
_aiCheckCondition :: forall (b :: BackendType) (f :: * -&gt; *) v.
AnnotatedInsertData b f v
-&gt; (AnnBoolExp b v, Maybe (AnnBoolExp b v))
_aiTableName :: forall (b :: BackendType) (f :: * -&gt; *) v.
AnnotatedInsertData b f v -&gt; TableName b
</span><a href="Hasura.RQL.IR.Insert.html#_aiInsertObject"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621687930314"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621687930314"><span class="hs-identifier hs-var">reqHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-421"></span><span>  </span><span class="annot"><span class="annottext">Maybe (ValidateInput ResolvedWebhook)
-&gt; (ValidateInput ResolvedWebhook -&gt; m ()) -&gt; m ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (ValidateInput ResolvedWebhook)
</span><a href="#local-6989586621687930306"><span class="hs-identifier hs-var">_aiValidateInput</span></a></span><span> </span><span class="annot"><span class="annottext">((ValidateInput ResolvedWebhook -&gt; m ()) -&gt; m ())
-&gt; (ValidateInput ResolvedWebhook -&gt; m ()) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687930316"><span class="annot"><span class="annottext">ValidateInput ResolvedWebhook
</span><a href="#local-6989586621687930316"><span class="hs-identifier hs-var">validateInput</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-422"></span><span>    </span><span id="local-6989586621687930317"><span class="annot"><a href="#local-6989586621687930317"><span class="hs-identifier hs-var">validatePaylodMap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (InsOrdHashMap
     (QualifiedObject TableName)
     ([AnnotatedInsertRow
         ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
      ValidateInput ResolvedWebhook))
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-423"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/insert-ordered-containers-0.2.5.3-dcb71999c8104475fd299533bb40a6c15ee8a9411f3a03b68aa99a14a4143c19/share/doc/html/src/Data.HashMap.Strict.InsOrd.html/Data.HashMap.Strict.InsOrd.html#lookup"><span class="hs-identifier hs-type">InsOrdHashMap.lookup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687930299"><span class="hs-identifier hs-type">_aiTableName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687930317"><span class="hs-identifier hs-type">validatePaylodMap</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-424"></span><span>      </span><span class="annot"><span class="annottext">Maybe
  ([AnnotatedInsertRow
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
   ValidateInput ResolvedWebhook)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(InsOrdHashMap
   (QualifiedObject TableName)
   ([AnnotatedInsertRow
       ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
    ValidateInput ResolvedWebhook)
 -&gt; InsOrdHashMap
      (QualifiedObject TableName)
      ([AnnotatedInsertRow
          ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
       ValidateInput ResolvedWebhook))
-&gt; m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((InsOrdHashMap
    (QualifiedObject TableName)
    ([AnnotatedInsertRow
        ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
     ValidateInput ResolvedWebhook)
  -&gt; InsOrdHashMap
       (QualifiedObject TableName)
       ([AnnotatedInsertRow
           ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
        ValidateInput ResolvedWebhook))
 -&gt; m ())
-&gt; (InsOrdHashMap
      (QualifiedObject TableName)
      ([AnnotatedInsertRow
          ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
       ValidateInput ResolvedWebhook)
    -&gt; InsOrdHashMap
         (QualifiedObject TableName)
         ([AnnotatedInsertRow
             ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
          ValidateInput ResolvedWebhook))
-&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QualifiedObject TableName
-&gt; ([AnnotatedInsertRow
       ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
    ValidateInput ResolvedWebhook)
-&gt; InsOrdHashMap
     (QualifiedObject TableName)
     ([AnnotatedInsertRow
         ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
      ValidateInput ResolvedWebhook)
-&gt; InsOrdHashMap
     (QualifiedObject TableName)
     ([AnnotatedInsertRow
         ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
      ValidateInput ResolvedWebhook)
forall k v.
(Eq k, Hashable k) =&gt;
k -&gt; v -&gt; InsOrdHashMap k v -&gt; InsOrdHashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/insert-ordered-containers-0.2.5.3-dcb71999c8104475fd299533bb40a6c15ee8a9411f3a03b68aa99a14a4143c19/share/doc/html/src/Data.HashMap.Strict.InsOrd.html/Data.HashMap.Strict.InsOrd.html#insert"><span class="hs-identifier hs-var">InsOrdHashMap.insert</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
QualifiedObject TableName
</span><a href="#local-6989586621687930299"><span class="hs-identifier hs-var">_aiTableName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[AnnotatedInsertRow
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
</span><a href="#local-6989586621687930298"><span class="hs-identifier hs-var">_aiInsertObject</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ValidateInput ResolvedWebhook
</span><a href="#local-6989586621687930316"><span class="hs-identifier hs-var">validateInput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">([AnnotatedInsertRow
    ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
 ValidateInput ResolvedWebhook)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(InsOrdHashMap
   (QualifiedObject TableName)
   ([AnnotatedInsertRow
       ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
    ValidateInput ResolvedWebhook)
 -&gt; InsOrdHashMap
      (QualifiedObject TableName)
      ([AnnotatedInsertRow
          ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
       ValidateInput ResolvedWebhook))
-&gt; m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((InsOrdHashMap
    (QualifiedObject TableName)
    ([AnnotatedInsertRow
        ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
     ValidateInput ResolvedWebhook)
  -&gt; InsOrdHashMap
       (QualifiedObject TableName)
       ([AnnotatedInsertRow
           ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
        ValidateInput ResolvedWebhook))
 -&gt; m ())
-&gt; (InsOrdHashMap
      (QualifiedObject TableName)
      ([AnnotatedInsertRow
          ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
       ValidateInput ResolvedWebhook)
    -&gt; InsOrdHashMap
         (QualifiedObject TableName)
         ([AnnotatedInsertRow
             ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
          ValidateInput ResolvedWebhook))
-&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(([AnnotatedInsertRow
     ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
  ValidateInput ResolvedWebhook)
 -&gt; ([AnnotatedInsertRow
        ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
     ValidateInput ResolvedWebhook))
-&gt; QualifiedObject TableName
-&gt; InsOrdHashMap
     (QualifiedObject TableName)
     ([AnnotatedInsertRow
         ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
      ValidateInput ResolvedWebhook)
-&gt; InsOrdHashMap
     (QualifiedObject TableName)
     ([AnnotatedInsertRow
         ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))],
      ValidateInput ResolvedWebhook)
forall k v.
(Eq k, Hashable k) =&gt;
(v -&gt; v) -&gt; k -&gt; InsOrdHashMap k v -&gt; InsOrdHashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/insert-ordered-containers-0.2.5.3-dcb71999c8104475fd299533bb40a6c15ee8a9411f3a03b68aa99a14a4143c19/share/doc/html/src/Data.HashMap.Strict.InsOrd.html/Data.HashMap.Strict.InsOrd.html#adjust"><span class="hs-identifier hs-var">InsOrdHashMap.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621687930323"><span class="annot"><span class="annottext">[AnnotatedInsertRow
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
</span><a href="#local-6989586621687930323"><span class="hs-identifier hs-var">insertedRows</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687930324"><span class="annot"><span class="annottext">ValidateInput ResolvedWebhook
</span><a href="#local-6989586621687930324"><span class="hs-identifier hs-var">validateInputDef</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[AnnotatedInsertRow
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
</span><a href="#local-6989586621687930323"><span class="hs-identifier hs-var">insertedRows</span></a></span><span> </span><span class="annot"><span class="annottext">[AnnotatedInsertRow
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
-&gt; [AnnotatedInsertRow
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
-&gt; [AnnotatedInsertRow
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[AnnotatedInsertRow
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
</span><a href="#local-6989586621687930298"><span class="hs-identifier hs-var">_aiInsertObject</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ValidateInput ResolvedWebhook
</span><a href="#local-6989586621687930324"><span class="hs-identifier hs-var">validateInputDef</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
QualifiedObject TableName
</span><a href="#local-6989586621687930299"><span class="hs-identifier hs-var">_aiTableName</span></a></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-comment">-- Validate the nested insert data</span><span>
</span><span id="line-428"></span><span>  </span><span class="hs-comment">-- for each row</span><span>
</span><span id="line-429"></span><span>  </span><span class="annot"><span class="annottext">[AnnotatedInsertRow
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
-&gt; (AnnotatedInsertRow
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
    -&gt; m ())
-&gt; m ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="annot"><span class="annottext">[AnnotatedInsertRow
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
</span><a href="#local-6989586621687930298"><span class="hs-identifier hs-var">_aiInsertObject</span></a></span><span> </span><span class="annot"><span class="annottext">((AnnotatedInsertRow
    ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
  -&gt; m ())
 -&gt; m ())
-&gt; (AnnotatedInsertRow
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
    -&gt; m ())
-&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687930325"><span class="annot"><span class="annottext">AnnotatedInsertRow
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930325"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-430"></span><span>    </span><span class="hs-comment">-- for each field</span><span>
</span><span id="line-431"></span><span>    </span><span class="annot"><span class="annottext">AnnotatedInsertRow
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
-&gt; (AnnotatedInsertField
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
    -&gt; m ())
-&gt; m ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertRow
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930325"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">((AnnotatedInsertField
    ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
  -&gt; m ())
 -&gt; m ())
-&gt; (AnnotatedInsertField
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
    -&gt; m ())
-&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-432"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#AIColumn"><span class="hs-identifier hs-type">IR.AIColumn</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ignore columns</span><span>
</span><span id="line-433"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#AIObjectRelationship"><span class="hs-identifier hs-type">IR.AIObjectRelationship</span></a></span><span> </span><span class="annot"><span class="annottext">XNestedInserts ('Postgres pgKind)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687930328"><span class="annot"><span class="annottext">ObjectRelationInsert
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930328"><span class="hs-identifier hs-var">objectRelationInsert</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-434"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687930329"><span class="annot"><span class="annottext">multiObjectInsert :: AnnotatedInsertData
  ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930329"><span class="hs-identifier hs-var hs-var">multiObjectInsert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelationInsert
  ('Postgres pgKind)
  (AnnotatedInsertData
     ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind)))
-&gt; AnnotatedInsertData
     ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind))
forall (b :: BackendType) a. RelationInsert b a -&gt; a
</span><a href="Hasura.RQL.IR.Insert.html#_riInsertData"><span class="hs-identifier hs-var">IR._riInsertData</span></a></span><span> </span><span class="annot"><span class="annottext">(RelationInsert
   ('Postgres pgKind)
   (AnnotatedInsertData
      ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind)))
 -&gt; AnnotatedInsertData
      ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind)))
-&gt; RelationInsert
     ('Postgres pgKind)
     (AnnotatedInsertData
        ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind)))
-&gt; AnnotatedInsertData
     ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ObjectRelationInsert
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
-&gt; RelationInsert
     ('Postgres pgKind)
     (AnnotatedInsertData
        ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind)))
forall a (b :: BackendType).
ObjectRelationInsert b a -&gt; ArrayRelationInsert b a
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#objToArr"><span class="hs-identifier hs-var">objToArr</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectRelationInsert
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930328"><span class="hs-identifier hs-var">objectRelationInsert</span></a></span><span>
</span><span id="line-435"></span><span>        </span><span class="annot"><span class="annottext">Environment
-&gt; Manager
-&gt; Logger Hasura
-&gt; UserInfo
-&gt; AnnotatedInsertData
     ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind))
-&gt; [Header]
-&gt; m ()
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadError QErr m, MonadIO m, MonadTrace m,
 MonadState (InsertValidationPayloadMap pgKind) m) =&gt;
Environment
-&gt; Manager
-&gt; Logger Hasura
-&gt; UserInfo
-&gt; MultiObjectInsert
     ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
-&gt; [Header]
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#validateInsertInput"><span class="hs-identifier hs-var">validateInsertInput</span></a></span><span> </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621687930294"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621687930295"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621687930296"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687930297"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertData
  ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930329"><span class="hs-identifier hs-var">multiObjectInsert</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621687930314"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span>
</span><span id="line-436"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#AIArrayRelationship"><span class="hs-identifier hs-type">IR.AIArrayRelationship</span></a></span><span> </span><span class="annot"><span class="annottext">XNestedInserts ('Postgres pgKind)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687930331"><span class="annot"><span class="annottext">RelationInsert
  ('Postgres pgKind)
  (AnnotatedInsertData
     ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind)))
</span><a href="#local-6989586621687930331"><span class="hs-identifier hs-var">arrayRelationInsert</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-437"></span><span>        </span><span class="annot"><span class="annottext">Environment
-&gt; Manager
-&gt; Logger Hasura
-&gt; UserInfo
-&gt; AnnotatedInsertData
     ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind))
-&gt; [Header]
-&gt; m ()
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadError QErr m, MonadIO m, MonadTrace m,
 MonadState (InsertValidationPayloadMap pgKind) m) =&gt;
Environment
-&gt; Manager
-&gt; Logger Hasura
-&gt; UserInfo
-&gt; MultiObjectInsert
     ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
-&gt; [Header]
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#validateInsertInput"><span class="hs-identifier hs-var">validateInsertInput</span></a></span><span> </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621687930294"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621687930295"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621687930296"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687930297"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RelationInsert
  ('Postgres pgKind)
  (AnnotatedInsertData
     ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind)))
-&gt; AnnotatedInsertData
     ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind))
forall (b :: BackendType) a. RelationInsert b a -&gt; a
</span><a href="Hasura.RQL.IR.Insert.html#_riInsertData"><span class="hs-identifier hs-var">IR._riInsertData</span></a></span><span> </span><span class="annot"><span class="annottext">RelationInsert
  ('Postgres pgKind)
  (AnnotatedInsertData
     ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind)))
</span><a href="#local-6989586621687930331"><span class="hs-identifier hs-var">arrayRelationInsert</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621687930314"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Insert.html#validateInsertRows"><span class="hs-identifier hs-type">validateInsertRows</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-440"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687929559"><span class="annot"><a href="#local-6989586621687929559"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621687929562"><span class="annot"><a href="#local-6989586621687929562"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-441"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929559"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-442"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687929559"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-443"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.Class.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929559"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-444"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-445"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Environment.html/Data.Environment.html#Environment"><span class="hs-identifier hs-type">Env.Environment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-446"></span><span>  </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/http-client-0.7.17-1b2133de2c2ce095aea721bc3d56fba68148ba6d3c4af69a01586f3a88b4e771/share/doc/html/src/Network.HTTP.Client.Types.html/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">HTTP.Manager</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><a href="Hasura.Logging.html#Logger"><span class="hs-identifier hs-type">L.Logger</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">L.Hasura</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-448"></span><span>  </span><span class="annot"><a href="Hasura.Authentication.User.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-449"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#ResolvedWebhook"><span class="hs-identifier hs-type">ResolvedWebhook</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Headers.html#HeaderConf"><span class="hs-identifier hs-type">HeaderConf</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-451"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#Timeout"><span class="hs-identifier hs-type">Timeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-452"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/http-types-0.12.3-48808bff700213a8ec5159613d94db74ab5738412a48ffcd3e274142637b29eb/share/doc/html/src/Network.HTTP.Types.Header.html/Network.HTTP.Types.Header.html#Header"><span class="hs-identifier hs-type">HTTP.Header</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-454"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#AnnotatedInsertRow"><span class="hs-identifier hs-type">IR.AnnotatedInsertRow</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929562"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929562"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-455"></span><span>  </span><span class="annot"><a href="#local-6989586621687929559"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span id="validateInsertRows"><span class="annot"><span class="annottext">validateInsertRows :: forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadError QErr m, MonadIO m, MonadTrace m) =&gt;
Environment
-&gt; Manager
-&gt; Logger Hasura
-&gt; UserInfo
-&gt; ResolvedWebhook
-&gt; [HeaderConf]
-&gt; Timeout
-&gt; Bool
-&gt; [Header]
-&gt; [AnnotatedInsertRow
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.Execute.Insert.html#validateInsertRows"><span class="hs-identifier hs-var hs-var">validateInsertRows</span></a></span></span><span> </span><span id="local-6989586621687930363"><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621687930363"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621687930364"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621687930364"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621687930365"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621687930365"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621687930366"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687930366"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687930367"><span class="annot"><span class="annottext">ResolvedWebhook
</span><a href="#local-6989586621687930367"><span class="hs-identifier hs-var">resolvedWebHook</span></a></span></span><span> </span><span id="local-6989586621687930368"><span class="annot"><span class="annottext">[HeaderConf]
</span><a href="#local-6989586621687930368"><span class="hs-identifier hs-var">confHeaders</span></a></span></span><span> </span><span id="local-6989586621687930369"><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621687930369"><span class="hs-identifier hs-var">timeout</span></a></span></span><span> </span><span id="local-6989586621687930370"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687930370"><span class="hs-identifier hs-var">forwardClientHeaders</span></a></span></span><span> </span><span id="local-6989586621687930371"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621687930371"><span class="hs-identifier hs-var">reqHeaders</span></a></span></span><span> </span><span id="local-6989586621687930372"><span class="annot"><span class="annottext">[AnnotatedInsertRow
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
</span><a href="#local-6989586621687930372"><span class="hs-identifier hs-var">rows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687930373"><span class="annot"><span class="annottext">inputData :: Value
</span><a href="#local-6989586621687930373"><span class="hs-identifier hs-var hs-var">inputData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">J.object</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;input&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; [Value] -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnotatedInsertRow
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
 -&gt; Value)
-&gt; [AnnotatedInsertRow
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
-&gt; [Value]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertRow
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
-&gt; Value
</span><a href="#local-6989586621687930376"><span class="hs-identifier hs-var">convertInsertRow</span></a></span><span> </span><span class="annot"><span class="annottext">[AnnotatedInsertRow
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
</span><a href="#local-6989586621687930372"><span class="hs-identifier hs-var">rows</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-458"></span><span>  </span><span class="annot"><span class="annottext">Environment
-&gt; Manager
-&gt; Logger Hasura
-&gt; UserInfo
-&gt; ResolvedWebhook
-&gt; [HeaderConf]
-&gt; Timeout
-&gt; Bool
-&gt; [Header]
-&gt; Value
-&gt; m ()
forall (m :: * -&gt; *).
(MonadError QErr m, MonadIO m, MonadTrace m) =&gt;
Environment
-&gt; Manager
-&gt; Logger Hasura
-&gt; UserInfo
-&gt; ResolvedWebhook
-&gt; [HeaderConf]
-&gt; Timeout
-&gt; Bool
-&gt; [Header]
-&gt; Value
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#validateMutation"><span class="hs-identifier hs-var">PGE.validateMutation</span></a></span><span> </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621687930363"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621687930364"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621687930365"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687930366"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedWebhook
</span><a href="#local-6989586621687930367"><span class="hs-identifier hs-var">resolvedWebHook</span></a></span><span> </span><span class="annot"><span class="annottext">[HeaderConf]
</span><a href="#local-6989586621687930368"><span class="hs-identifier hs-var">confHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621687930369"><span class="hs-identifier hs-var">timeout</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687930370"><span class="hs-identifier hs-var">forwardClientHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621687930371"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687930373"><span class="hs-identifier hs-var">inputData</span></a></span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-460"></span><span>    </span><span class="annot"><a href="#local-6989586621687930376"><span class="hs-identifier hs-type">convertInsertRow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#AnnotatedInsertRow"><span class="hs-identifier hs-type">IR.AnnotatedInsertRow</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929562"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929562"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">J.Value</span></a></span><span>
</span><span id="line-461"></span><span>    </span><span id="local-6989586621687930376"><span class="annot"><span class="annottext">convertInsertRow :: AnnotatedInsertRow
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
-&gt; Value
</span><a href="#local-6989586621687930376"><span class="hs-identifier hs-var hs-var">convertInsertRow</span></a></span></span><span> </span><span id="local-6989586621687930378"><span class="annot"><span class="annottext">AnnotatedInsertRow
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930378"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">J.object</span></a></span><span> </span><span class="annot"><span class="annottext">([Pair] -&gt; Value) -&gt; [Pair] -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((AnnotatedInsertField
    ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
  -&gt; Maybe Pair)
 -&gt; AnnotatedInsertRow
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
 -&gt; [Pair])
-&gt; AnnotatedInsertRow
     ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
-&gt; (AnnotatedInsertField
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
    -&gt; Maybe Pair)
-&gt; [Pair]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(AnnotatedInsertField
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
 -&gt; Maybe Pair)
-&gt; AnnotatedInsertRow
     ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
-&gt; [Pair]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b.
Filterable f =&gt;
(a -&gt; Maybe b) -&gt; f a -&gt; f b
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/witherable-0.5-ed5d92584b79c1fa03d7efeb1159ae93eef86189605b088dd8806eb40d0b16f5/share/doc/html/src/Witherable.html/Witherable.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertRow
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930378"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">((AnnotatedInsertField
    ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
  -&gt; Maybe Pair)
 -&gt; [Pair])
-&gt; (AnnotatedInsertField
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
    -&gt; Maybe Pair)
-&gt; [Pair]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687930379"><span class="annot"><span class="annottext">AnnotatedInsertField
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930379"><span class="hs-identifier hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-462"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621687930380"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687930380"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687930381"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621687930381"><span class="hs-identifier hs-var">maybeFieldValue</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertField
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930379"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-463"></span><span>            </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#AIColumn"><span class="hs-identifier hs-type">IR.AIColumn</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687930382"><span class="annot"><span class="annottext">Column ('Postgres pgKind)
</span><a href="#local-6989586621687930382"><span class="hs-identifier hs-var">column</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687930383"><span class="annot"><span class="annottext">UnpreparedValue ('Postgres pgKind)
</span><a href="#local-6989586621687930383"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGCol -&gt; Text
forall a. ToTxt a =&gt; a -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html#toTxt"><span class="hs-identifier hs-var">toTxt</span></a></span><span> </span><span class="annot"><span class="annottext">Column ('Postgres pgKind)
PGCol
</span><a href="#local-6989586621687930382"><span class="hs-identifier hs-var">column</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UnpreparedValue ('Postgres pgKind) -&gt; Maybe Value
</span><a href="#local-6989586621687930385"><span class="hs-identifier hs-var">convertValue</span></a></span><span> </span><span class="annot"><span class="annottext">UnpreparedValue ('Postgres pgKind)
</span><a href="#local-6989586621687930383"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>            </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#AIObjectRelationship"><span class="hs-identifier hs-type">IR.AIObjectRelationship</span></a></span><span> </span><span class="annot"><span class="annottext">XNestedInserts ('Postgres pgKind)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687930386"><span class="annot"><span class="annottext">ObjectRelationInsert
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930386"><span class="hs-identifier hs-var">objectRelationInsert</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-465"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687930387"><span class="annot"><span class="annottext">relationshipName :: RelName
</span><a href="#local-6989586621687930387"><span class="hs-identifier hs-var hs-var">relationshipName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind) -&gt; RelName
forall (b :: BackendType). RelInfo b -&gt; RelName
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riName"><span class="hs-identifier hs-var">riName</span></a></span><span> </span><span class="annot"><span class="annottext">(RelInfo ('Postgres pgKind) -&gt; RelName)
-&gt; RelInfo ('Postgres pgKind) -&gt; RelName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ObjectRelationInsert
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
-&gt; RelInfo ('Postgres pgKind)
forall (b :: BackendType) a. RelationInsert b a -&gt; RelInfo b
</span><a href="Hasura.RQL.IR.Insert.html#_riRelationInfo"><span class="hs-identifier hs-var">IR._riRelationInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectRelationInsert
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930386"><span class="hs-identifier hs-var">objectRelationInsert</span></a></span><span>
</span><span id="line-466"></span><span>                  </span><span id="local-6989586621687930388"><span class="annot"><span class="annottext">insertRow :: AnnotatedInsertRow
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930388"><span class="hs-identifier hs-var hs-var">insertRow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single
  (AnnotatedInsertRow
     ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind)))
-&gt; AnnotatedInsertRow
     ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
forall a. Single a -&gt; a
</span><a href="Hasura.RQL.IR.Insert.html#unSingle"><span class="hs-identifier hs-var">IR.unSingle</span></a></span><span> </span><span class="annot"><span class="annottext">(Single
   (AnnotatedInsertRow
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind)))
 -&gt; AnnotatedInsertRow
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind)))
-&gt; Single
     (AnnotatedInsertRow
        ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind)))
-&gt; AnnotatedInsertRow
     ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertData
  ('Postgres pgKind) Single (UnpreparedValue ('Postgres pgKind))
-&gt; Single
     (AnnotatedInsertRow
        ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind)))
forall (b :: BackendType) (f :: * -&gt; *) v.
AnnotatedInsertData b f v -&gt; f (AnnotatedInsertRow b v)
</span><a href="Hasura.RQL.IR.Insert.html#_aiInsertObject"><span class="hs-identifier hs-var">IR._aiInsertObject</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnotatedInsertData
   ('Postgres pgKind) Single (UnpreparedValue ('Postgres pgKind))
 -&gt; Single
      (AnnotatedInsertRow
         ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))))
-&gt; AnnotatedInsertData
     ('Postgres pgKind) Single (UnpreparedValue ('Postgres pgKind))
-&gt; Single
     (AnnotatedInsertRow
        ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ObjectRelationInsert
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
-&gt; AnnotatedInsertData
     ('Postgres pgKind) Single (UnpreparedValue ('Postgres pgKind))
forall (b :: BackendType) a. RelationInsert b a -&gt; a
</span><a href="Hasura.RQL.IR.Insert.html#_riInsertData"><span class="hs-identifier hs-var">IR._riInsertData</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectRelationInsert
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930386"><span class="hs-identifier hs-var">objectRelationInsert</span></a></span><span>
</span><span id="line-467"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">-- We want to follow the GQL types. And since nested objects (object and array relationships)</span><span>
</span><span id="line-468"></span><span>                  </span><span class="hs-comment">-- are always included inside 'data', we add the &quot;data&quot; key here.</span><span>
</span><span id="line-469"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RelName -&gt; Text
forall a. ToTxt a =&gt; a -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html#toTxt"><span class="hs-identifier hs-var">toTxt</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687930387"><span class="hs-identifier hs-var">relationshipName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe Value
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Maybe Value) -&gt; Value -&gt; Maybe Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">J.object</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;data&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertRow
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
-&gt; Value
</span><a href="#local-6989586621687930376"><span class="hs-identifier hs-var">convertInsertRow</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertRow
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930388"><span class="hs-identifier hs-var">insertRow</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>            </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#AIArrayRelationship"><span class="hs-identifier hs-type">IR.AIArrayRelationship</span></a></span><span> </span><span class="annot"><span class="annottext">XNestedInserts ('Postgres pgKind)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687930389"><span class="annot"><span class="annottext">ArrayRelationInsert
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930389"><span class="hs-identifier hs-var">arrayRelationInsert</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-471"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687930390"><span class="annot"><span class="annottext">relationshipName :: RelName
</span><a href="#local-6989586621687930390"><span class="hs-identifier hs-var hs-var">relationshipName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres pgKind) -&gt; RelName
forall (b :: BackendType). RelInfo b -&gt; RelName
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riName"><span class="hs-identifier hs-var">riName</span></a></span><span> </span><span class="annot"><span class="annottext">(RelInfo ('Postgres pgKind) -&gt; RelName)
-&gt; RelInfo ('Postgres pgKind) -&gt; RelName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArrayRelationInsert
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
-&gt; RelInfo ('Postgres pgKind)
forall (b :: BackendType) a. RelationInsert b a -&gt; RelInfo b
</span><a href="Hasura.RQL.IR.Insert.html#_riRelationInfo"><span class="hs-identifier hs-var">IR._riRelationInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ArrayRelationInsert
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930389"><span class="hs-identifier hs-var">arrayRelationInsert</span></a></span><span>
</span><span id="line-472"></span><span>                  </span><span id="local-6989586621687930391"><span class="annot"><span class="annottext">insertRows :: [AnnotatedInsertRow
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
</span><a href="#local-6989586621687930391"><span class="hs-identifier hs-var hs-var">insertRows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertData
  ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind))
-&gt; [AnnotatedInsertRow
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
forall (b :: BackendType) (f :: * -&gt; *) v.
AnnotatedInsertData b f v -&gt; f (AnnotatedInsertRow b v)
</span><a href="Hasura.RQL.IR.Insert.html#_aiInsertObject"><span class="hs-identifier hs-var">IR._aiInsertObject</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnotatedInsertData
   ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind))
 -&gt; [AnnotatedInsertRow
       ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))])
-&gt; AnnotatedInsertData
     ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind))
-&gt; [AnnotatedInsertRow
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArrayRelationInsert
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
-&gt; AnnotatedInsertData
     ('Postgres pgKind) [] (UnpreparedValue ('Postgres pgKind))
forall (b :: BackendType) a. RelationInsert b a -&gt; a
</span><a href="Hasura.RQL.IR.Insert.html#_riInsertData"><span class="hs-identifier hs-var">IR._riInsertData</span></a></span><span> </span><span class="annot"><span class="annottext">ArrayRelationInsert
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687930389"><span class="hs-identifier hs-var">arrayRelationInsert</span></a></span><span>
</span><span id="line-473"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RelName -&gt; Text
forall a. ToTxt a =&gt; a -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html/Data.Text.Extended.html#toTxt"><span class="hs-identifier hs-var">toTxt</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687930390"><span class="hs-identifier hs-var">relationshipName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe Value
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Maybe Value) -&gt; Value -&gt; Maybe Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">J.object</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;data&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; [Value] -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnotatedInsertRow
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
 -&gt; Value)
-&gt; [AnnotatedInsertRow
      ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
-&gt; [Value]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsertRow
  ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
-&gt; Value
</span><a href="#local-6989586621687930376"><span class="hs-identifier hs-var">convertInsertRow</span></a></span><span> </span><span class="annot"><span class="annottext">[AnnotatedInsertRow
   ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))]
</span><a href="#local-6989586621687930391"><span class="hs-identifier hs-var">insertRows</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621687930381"><span class="hs-identifier hs-var">maybeFieldValue</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Value -&gt; (Value -&gt; Pair) -&gt; Maybe Pair
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687930393"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687930393"><span class="hs-identifier hs-var">fieldValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Key
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Key.html/Data.Aeson.Key.html#fromText"><span class="hs-identifier hs-var">J.fromText</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687930380"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687930393"><span class="hs-identifier hs-var">fieldValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span>    </span><span class="annot"><a href="#local-6989586621687930385"><span class="hs-identifier hs-type">convertValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687929562"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.Internal.html/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">J.Value</span></a></span><span>
</span><span id="line-477"></span><span>    </span><span id="local-6989586621687930385"><span class="annot"><span class="annottext">convertValue :: UnpreparedValue ('Postgres pgKind) -&gt; Maybe Value
</span><a href="#local-6989586621687930385"><span class="hs-identifier hs-var hs-var">convertValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-478"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UVParameter"><span class="hs-identifier hs-type">IR.UVParameter</span></a></span><span> </span><span class="annot"><span class="annottext">Provenance
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687930396"><span class="annot"><span class="annottext">ColumnValue ('Postgres pgKind)
</span><a href="#local-6989586621687930396"><span class="hs-identifier hs-var">columnValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe Value
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Maybe Value) -&gt; Value -&gt; Maybe Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PGScalarValue -&gt; Value
</span><a href="Hasura.Backends.Postgres.SQL.Value.html#pgScalarValueToJson"><span class="hs-identifier hs-var">pgScalarValueToJson</span></a></span><span> </span><span class="annot"><span class="annottext">(PGScalarValue -&gt; Value) -&gt; PGScalarValue -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ColumnValue ('Postgres pgKind) -&gt; ScalarValue ('Postgres pgKind)
forall (b :: BackendType). ColumnValue b -&gt; ScalarValue b
</span><a href="Hasura.RQL.Types.Column.html#cvValue"><span class="hs-identifier hs-var">cvValue</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnValue ('Postgres pgKind)
</span><a href="#local-6989586621687930396"><span class="hs-identifier hs-var">columnValue</span></a></span><span>
</span><span id="line-479"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UVLiteral"><span class="hs-identifier hs-type">IR.UVLiteral</span></a></span><span> </span><span id="local-6989586621687930400"><span class="annot"><span class="annottext">SQLExpression ('Postgres pgKind)
</span><a href="#local-6989586621687930400"><span class="hs-identifier hs-var">sqlExp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe Value
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Maybe Value) -&gt; Value -&gt; Maybe Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.10.1-inplace/aeson-2.2.3.0-5d7ee246cfa338f30d154e06f34dc50b9af0797ae9abbdeb4efa1326ac8786e5/share/doc/html/src/Data.Aeson.Types.ToJSON.html/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var">J.toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">SQLExpression ('Postgres pgKind)
SQLExp
</span><a href="#local-6989586621687930400"><span class="hs-identifier hs-var">sqlExp</span></a></span><span>
</span><span id="line-480"></span><span>      </span><span class="annot"><span class="annottext">UnpreparedValue ('Postgres pgKind)
</span><a href="Hasura.RQL.IR.Value.html#UVSession"><span class="hs-identifier hs-var">IR.UVSession</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Value
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-481"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UVSessionVar"><span class="hs-identifier hs-type">IR.UVSessionVar</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Value
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-482"></span></pre></body></html>